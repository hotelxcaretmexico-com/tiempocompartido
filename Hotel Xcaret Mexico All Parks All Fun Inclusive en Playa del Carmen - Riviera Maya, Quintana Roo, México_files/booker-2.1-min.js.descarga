var requirejs,require,define;!function(ba){function J(e){return"[object Function]"===N.call(e)}function K(e){return"[object Array]"===N.call(e)}function z(e,t){var o;if(e)for(o=0;o<e.length&&(!e[o]||!t(e[o],o,e));o+=1);}function O(e,t){var o;if(e)for(o=e.length-1;-1<o&&(!e[o]||!t(e[o],o,e));o-=1);}function t(e,t){return ha.call(e,t)}function m(e,o){return t(e,o)&&e[o]}function H(e,o){for(var i in e)if(t(e,i)&&o(e[i],i))break}function S(i,e,a,n){return e&&H(e,function(e,o){!a&&t(i,o)||(n&&"string"!=typeof e?(i[o]||(i[o]={}),S(i[o],e,a,n)):i[o]=e)}),i}function v(e,t){return function(){return t.apply(e,arguments)}}function ca(e){throw e}function da(e){if(!e)return e;var t=ba;return z(e.split("."),function(e){t=t[e]}),t}function B(e,t,o,i){return(t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e)).requireType=e,t.requireModules=i,o&&(t.originalError=o),t}function ia(c){function p(e,t,o){var i,a,n,r,s,l,c,u=t&&t.split("/");i=u;var p=I.map,d=p&&p["*"];if(e&&"."===e.charAt(0))if(t){for(t=e=(i=m(I.pkgs,t)?u=[t]:u.slice(0,u.length-1)).concat(e.split("/")),i=0;t[i];i+=1)if("."===(a=t[i]))t.splice(i,1),i-=1;else if(".."===a){if(1===i&&(".."===t[2]||".."===t[0]))break;0<i&&(t.splice(i-1,2),i-=2)}i=m(I.pkgs,t=e[0]),e=e.join("/"),i&&e===t+"/"+i.main&&(e=t)}else 0===e.indexOf("./")&&(e=e.substring(2));if(o&&p&&(u||d)){for(i=(t=e.split("/")).length;0<i;i-=1){if(n=t.slice(0,i).join("/"),u)for(a=u.length;0<a;a-=1)if((o=m(p,u.slice(0,a).join("/")))&&(o=m(o,n))){r=o,s=i;break}if(r)break;!l&&d&&m(d,n)&&(l=m(d,n),c=i)}!r&&l&&(r=l,s=c),r&&(t.splice(0,s,r),e=t.join("/"))}return e}function u(t){A&&z(document.getElementsByTagName("script"),function(e){if(e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===D.contextName)return e.parentNode.removeChild(e),!0})}function d(e){var t=m(I.paths,e);if(t&&K(t)&&1<t.length)return u(e),t.shift(),D.require.undef(e),D.require([e]),!0}function f(e){var t,o=e?e.indexOf("!"):-1;return-1<o&&(t=e.substring(0,o),e=e.substring(o+1,e.length)),[t,e]}function g(e,t,o,i){var a,n,r=null,s=t?t.name:null,l=e,c=!0,u="";return e||(c=!1,e="_@r"+(N+=1)),r=(e=f(e))[0],e=e[1],r&&(r=p(r,s,i),n=m(F,r)),e&&(r?u=n&&n.normalize?n.normalize(e,function(e){return p(e,s,i)}):p(e,s,i):(r=(e=f(u=p(e,s,i)))[0],u=e[1],o=!0,a=D.nameToUrl(u))),{prefix:r,name:u,parentMap:t,unnormalized:!!(o=!r||n||o?"":"_unnormalized"+(O+=1)),url:a,originalName:l,isDefine:c,id:(r?r+"!"+u:u)+o}}function _(e){var t=e.id,o=m(P,t);return o||(o=P[t]=new D.Module(e)),o}function n(e,o,i){var a=e.id,n=m(P,a);!t(F,a)||n&&!n.defineEmitComplete?(n=_(e)).error&&"error"===o?i(n.error):n.on(o,i):"defined"===o&&i(F[a])}function y(t,e){var o=t.requireModules,i=!1;e?e(t):(z(o,function(e){(e=m(P,e))&&(e.error=t,e.events.error&&(i=!0,e.emit("error",t)))}),i||h.onError(t))}function k(){U.length&&(ja.apply(s,[s.length-1,0].concat(U)),U=[])}function b(e){delete P[e],delete E[e]}function C(){var t,o,e,i,a=(e=1e3*I.waitSeconds)&&D.startTime+e<(new Date).getTime(),n=[],r=[],s=!1,l=!0;if(!w){if(w=!0,H(E,function(e){if(t=e.map,o=t.id,e.enabled&&(t.isDefine||r.push(e),!e.error))if(!e.inited&&a)d(o)?s=i=!0:(n.push(o),u(o));else if(!e.inited&&e.fetched&&t.isDefine&&(s=!0,!t.prefix))return l=!1}),a&&n.length)return(e=B("timeout","Load timeout for modules: "+n,null,n)).contextName=D.contextName,y(e);l&&z(r,function(e){!function a(n,r,s){var e=n.map.id;n.error?n.emit("error",n.error):(r[e]=!0,z(n.depMaps,function(e,t){var o=e.id,i=m(P,o);i&&!n.depMatched[t]&&!s[o]&&(m(r,o)?(n.defineDep(t,F[o]),n.check()):a(i,r,s))}),s[e]=!0)}(e,{},{})}),a&&!i||!s||!A&&!ea||M||(M=setTimeout(function(){M=0,C()},50)),w=!1}}function r(e){t(F,e[0])||_(g(e[0],null,!0)).init(e[1],e[2])}function o(e){e=e.currentTarget||e.srcElement;var t=D.onScriptLoad;return e.detachEvent&&!Z?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=D.onScriptError,(!e.detachEvent||Z)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function x(){var e;for(k();s.length;){if(null===(e=s.shift())[0])return y(B("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));r(e)}}var w,e,D,T,M,I={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},P={},E={},i={},s=[],F={},a={},N=1,O=1;return T={require:function(e){return e.require?e.require:e.require=D.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?e.exports:e.exports=F[e.map.id]={}},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){var e=m(I.pkgs,t.map.id);return m(I.config,e?t.map.id+"/"+e.main:t.map.id)||{}},exports:F[t.map.id]}}},(e=function(e){this.events=m(i,e.id)||{},this.map=e,this.shim=m(I.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,o,i){i=i||{},this.inited||(this.factory=t,o?this.on("error",o):this.events.error&&(o=v(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=o,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,D.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();D.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],v(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;a[e]||(a[e]=!0,D.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var t,e,o=this.map.id;e=this.depExports;var i=this.exports,a=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(J(a)){if(this.events.error&&this.map.isDefine||h.onError!==ca)try{i=D.execCb(o,a,e,i)}catch(e){t=e}else i=D.execCb(o,a,e,i);if(this.map.isDefine&&((e=this.module)&&void 0!==e.exports&&e.exports!==this.exports?i=e.exports:void 0===i&&this.usingExports&&(i=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",y(this.error=t)}else i=a;this.exports=i,this.map.isDefine&&!this.ignore&&(F[o]=i,h.onResourceLoad)&&h.onResourceLoad(D,this.map,this.depMaps),b(o),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var l=this.map,c=l.id,e=g(l.prefix);this.depMaps.push(e),n(e,"defined",v(this,function(e){var r,o;o=this.map.name;var i=this.map.parentMap?this.map.parentMap.name:null,s=D.makeRequire(l.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(e.normalize&&(o=e.normalize(o,function(e){return p(e,i,!0)})||""),n(e=g(l.prefix+"!"+o,this.map.parentMap),"defined",v(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),(o=m(P,e.id))&&(this.depMaps.push(e),this.events.error&&o.on("error",v(this,function(e){this.emit("error",e)})),o.enable())):((r=v(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=v(this,function(e){this.inited=!0,(this.error=e).requireModules=[c],H(P,function(e){0===e.map.id.indexOf(c+"_unnormalized")&&b(e.map.id)}),y(e)}),r.fromText=v(this,function(e,o){var i=l.name,a=g(i),n=Q;o&&(e=o),n&&(Q=!1),_(a),t(I.config,c)&&(I.config[i]=I.config[c]);try{h.exec(e)}catch(e){return y(B("fromtexteval","fromText eval for "+c+" failed: "+e,e,[c]))}n&&(Q=!0),this.depMaps.push(a),D.completeLoad(i),s([i],r)}),e.load(l.name,s,r,I))})),D.enable(e,this),this.pluginMaps[e.id]=e},enable:function(){(E[this.map.id]=this).enabling=this.enabled=!0,z(this.depMaps,v(this,function(e,o){var i,a;if("string"==typeof e){if(e=g(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[o]=e,i=m(T,e.id))return void(this.depExports[o]=i(this));this.depCount+=1,n(e,"defined",v(this,function(e){this.defineDep(o,e),this.check()})),this.errback&&n(e,"error",v(this,this.errback))}i=e.id,a=P[i],!t(T,i)&&a&&!a.enabled&&D.enable(e,this)})),H(this.pluginMaps,v(this,function(e){var t=m(P,e.id);t&&!t.enabled&&D.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var o=this.events[e];o||(o=this.events[e]=[]),o.push(t)},emit:function(e,t){z(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(D={config:I,contextName:c,registry:P,defined:F,urlFetched:a,defQueue:s,Module:e,makeModuleMap:g,nextTick:h.nextTick,onError:y,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=I.pkgs,o=I.shim,i={paths:!0,config:!0,map:!0};H(e,function(e,t){i[t]?"map"===t?(I.map||(I.map={}),S(I[t],e,!0,!0)):S(I[t],e,!0):I[t]=e}),e.shim&&(H(e.shim,function(e,t){K(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=D.makeShimExports(e)),o[t]=e}),I.shim=o),e.packages&&(z(e.packages,function(e){t[(e="string"==typeof e?{name:e}:e).name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ka,"").replace(fa,"")}}),I.pkgs=t),H(P,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=g(t))}),(e.deps||e.callback)&&D.require(e.deps||[],e.callback)},makeShimExports:function(t){return function(){var e;return t.init&&(e=t.init.apply(ba,arguments)),e||t.exports&&da(t.exports)}},makeRequire:function(r,s){function l(e,o,i){var a,n;return s.enableBuildCallback&&o&&J(o)&&(o.__requireJsBuild=!0),"string"==typeof e?J(o)?y(B("requireargs","Invalid require call"),i):r&&t(T,e)?T[e](P[r.id]):h.get?h.get(D,e,r,l):(a=(a=g(e,r,!1,!0)).id,t(F,a)?F[a]:y(B("notloaded",'Module name "'+a+'" has not been loaded yet for context: '+c+(r?"":". Use require([])")))):(x(),D.nextTick(function(){x(),(n=_(g(null,r))).skipMap=s.skipMap,n.init(e,o,i,{enabled:!0}),C()}),l)}return s=s||{},S(l,{isBrowser:A,toUrl:function(e){var t,o=e.lastIndexOf("."),i=e.split("/")[0];return-1!==o&&("."!==i&&".."!==i||1<o)&&(t=e.substring(o,e.length),e=e.substring(0,o)),D.nameToUrl(p(e,r&&r.id,!0),t,!0)},defined:function(e){return t(F,g(e,r,!1,!0).id)},specified:function(e){return e=g(e,r,!1,!0).id,t(F,e)||t(P,e)}}),r||(l.undef=function(e){k();var t=g(e,r,!0),o=m(P,e);delete F[e],delete a[t.url],delete i[e],o&&(o.events.defined&&(i[e]=o.events),b(e))}),l},enable:function(e){m(P,e.id)&&_(e).enable()},completeLoad:function(e){var o,i,a=m(I.shim,e)||{},n=a.exports;for(k();s.length;){if(null===(i=s.shift())[0]){if(i[0]=e,o)break;o=!0}else i[0]===e&&(o=!0);r(i)}if(i=m(P,e),!o&&!t(F,e)&&i&&!i.inited){if(I.enforceDefine&&(!n||!da(n)))return d(e)?void 0:y(B("nodefine","No define call for "+e,null,[e]));r([e,a.deps||[],a.exportsFn])}C()},nameToUrl:function(e,t,o){var i,a,n,r,s,l;if(h.jsExtRegExp.test(e))r=e+(t||"");else{for(i=I.paths,a=I.pkgs,s=(r=e.split("/")).length;0<s;s-=1){if(n=m(a,l=r.slice(0,s).join("/")),l=m(i,l)){K(l)&&(l=l[0]),r.splice(0,s,l);break}if(n){e=e===n.name?n.location+"/"+n.main:n.location,r.splice(0,s,e);break}}r=r.join("/"),r=("/"===(r+=t||(/\?/.test(r)||o?"":".js")).charAt(0)||r.match(/^[\w\+\.\-]+:/)?"":I.baseUrl)+r}return I.urlArgs?r+(-1===r.indexOf("?")?"?":"&")+I.urlArgs:r},load:function(e,t){h.load(D,e,t)},execCb:function(e,t,o,i){return t.apply(i,o)},onScriptLoad:function(e){("load"===e.type||la.test((e.currentTarget||e.srcElement).readyState))&&(R=null,e=o(e),D.completeLoad(e.id))},onScriptError:function(e){var t=o(e);if(!d(t.id))return y(B("scripterror","Script error for: "+t.id,e,[t.id]))}}).require=D.makeRequire(),D}var h,x,y,E,L,F,R,M,s,ga,ma=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,na=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,fa=/\.js$/,ka=/^\.\//;x=Object.prototype;var N=x.toString,ha=x.hasOwnProperty,ja=Array.prototype.splice,A=!("undefined"==typeof window||!navigator||!window.document),ea=!A&&"undefined"!=typeof importScripts,la=A&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Z="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),G={},u={},U=[],Q=!1;if(void 0===define){if(void 0!==requirejs){if(J(requirejs))return;u=requirejs,requirejs=void 0}void 0!==require&&!J(require)&&(u=require,require=void 0),h=requirejs=function(e,t,o,i){var a,n="_";return!K(e)&&"string"!=typeof e&&(a=e,K(t)?(e=t,t=o,o=i):e=[]),a&&a.context&&(n=a.context),(i=m(G,n))||(i=G[n]=h.s.newContext(n)),a&&i.configure(a),i.require(e,t,o)},h.config=function(e){return h(e)},h.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=h),h.version="2.1.6",h.jsExtRegExp=/^\/|:|\?|\.js$/,h.isBrowser=A,x=h.s={contexts:G,newContext:ia},h({}),z(["toUrl","undef","defined","specified"],function(t){h[t]=function(){var e=G._;return e.require[t].apply(e,arguments)}}),A&&(y=x.head=document.getElementsByTagName("head")[0],E=document.getElementsByTagName("base")[0])&&(y=x.head=E.parentNode),h.onError=ca,h.load=function(t,o,i){var e,a=t&&t.config||{};if(A)return(e=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script")).type=a.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e.setAttribute("data-requirecontext",t.contextName),e.setAttribute("data-requiremodule",o),!e.attachEvent||e.attachEvent.toString&&e.attachEvent.toString().indexOf("[native code")<0||Z?(e.addEventListener("load",t.onScriptLoad,!1),e.addEventListener("error",t.onScriptError,!1)):(Q=!0,e.attachEvent("onreadystatechange",t.onScriptLoad)),e.src=i,M=e,E?y.insertBefore(e,E):y.appendChild(e),M=null,e;if(ea)try{importScripts(i),t.completeLoad(o)}catch(e){t.onError(B("importscripts","importScripts failed for "+o+" at "+i,e,[o]))}},A&&O(document.getElementsByTagName("script"),function(e){if(y||(y=e.parentNode),L=e.getAttribute("data-main"))return s=L,u.baseUrl||(s=(F=s.split("/")).pop(),ga=F.length?F.join("/")+"/":"./",u.baseUrl=ga),s=s.replace(fa,""),h.jsExtRegExp.test(s)&&(s=L),u.deps=u.deps?u.deps.concat(s):[s],!0}),define=function(e,o,t){var i,a;"string"!=typeof e&&(t=o,o=e,e=null),K(o)||(t=o,o=null),!o&&J(t)&&(o=[],t.length&&(t.toString().replace(ma,"").replace(na,function(e,t){o.push(t)}),o=(1===t.length?["require"]:["require","exports","module"]).concat(o))),Q&&((i=M)||(R&&"interactive"===R.readyState||O(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return R=e}),i=R),i&&(e||(e=i.getAttribute("data-requiremodule")),a=G[i.getAttribute("data-requirecontext")])),(a?a.defQueue:U).push([e,o,t])},define.amd={jQuery:!0},h.exec=function(b){return eval(b)},h(u)}}(this),define("requireLib",function(){}),define("../JQueryUI/core",["jquery"],function(e){!function(s,e){var i,t,o=0,a=/^ui-id-\d+$/;function n(e,t){var o,i,a,n=e.nodeName.toLowerCase();return"area"===n?(i=(o=e.parentNode).name,!(!e.href||!i||"map"!==o.nodeName.toLowerCase())&&(!!(a=s("img[usemap=#"+i+"]")[0])&&r(a))):(/input|select|textarea|button|object/.test(n)?!e.disabled:"a"===n&&e.href||t)&&r(e)}function r(e){return s.expr.filters.visible(e)&&!s(e).parents().addBack().filter(function(){return"hidden"===s.css(this,"visibility")}).length}s.ui=s.ui||{},s.extend(s.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),s.fn.extend({focus:(i=s.fn.focus,function(t,o){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){s(e).focus(),o&&o.call(e)},t)}):i.apply(this,arguments)}),scrollParent:function(){var e;return e=s.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(s.css(this,"position"))&&/(auto|scroll)/.test(s.css(this,"overflow")+s.css(this,"overflow-y")+s.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(s.css(this,"overflow")+s.css(this,"overflow-y")+s.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?s(document):e},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,o,i=s(this[0]);i.length&&i[0]!==document;){if(("absolute"===(t=i.css("position"))||"relative"===t||"fixed"===t)&&(o=parseInt(i.css("zIndex"),10),!isNaN(o)&&0!==o))return o;i=i.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&s(this).removeAttr("id")})}}),s.extend(s.expr[":"],{data:s.expr.createPseudo?s.expr.createPseudo(function(t){return function(e){return!!s.data(e,t)}}):function(e,t,o){return!!s.data(e,o[3])},focusable:function(e){return n(e,!isNaN(s.attr(e,"tabindex")))},tabbable:function(e){var t=s.attr(e,"tabindex"),o=isNaN(t);return(o||0<=t)&&n(e,!o)}}),s("<a>").outerWidth(1).jquery||s.each(["Width","Height"],function(e,o){var a="Width"===o?["Left","Right"]:["Top","Bottom"],i=o.toLowerCase(),n={innerWidth:s.fn.innerWidth,innerHeight:s.fn.innerHeight,outerWidth:s.fn.outerWidth,outerHeight:s.fn.outerHeight};function r(e,t,o,i){return s.each(a,function(){t-=parseFloat(s.css(e,"padding"+this))||0,o&&(t-=parseFloat(s.css(e,"border"+this+"Width"))||0),i&&(t-=parseFloat(s.css(e,"margin"+this))||0)}),t}s.fn["inner"+o]=function(e){return void 0===e?n["inner"+o].call(this):this.each(function(){s(this).css(i,r(this,e)+"px")})},s.fn["outer"+o]=function(e,t){return"number"!=typeof e?n["outer"+o].call(this,e):this.each(function(){s(this).css(i,r(this,e,!0,t)+"px")})}}),s.fn.addBack||(s.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),s("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(s.fn.removeData=(t=s.fn.removeData,function(e){return arguments.length?t.call(this,s.camelCase(e)):t.call(this)})),s.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),s.support.selectstart="onselectstart"in document.createElement("div"),s.fn.extend({disableSelection:function(){return this.bind((s.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),s.extend(s.ui,{plugin:{add:function(e,t,o){var i,a=s.ui[e].prototype;for(i in o)a.plugins[i]=a.plugins[i]||[],a.plugins[i].push([t,o[i]])},call:function(e,t,o){var i,a=e.plugins[t];if(a&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<a.length;i++)e.options[a[i][0]]&&a[i][1].apply(e.element,o)}},hasScroll:function(e,t){if("hidden"===s(e).css("overflow"))return!1;var o,i=t&&"left"===t?"scrollLeft":"scrollTop";return 0<e[i]||(e[i]=1,o=0<e[i],e[i]=0,o)}})}(e)}),define("../JQueryUI/widget",["jquery"],function(e){var u,s,o,l,i;u=e,o=0,l=Array.prototype.slice,i=u.cleanData,u.cleanData=function(e){for(var t,o=0;null!=(t=e[o]);o++)try{u(t).triggerHandler("remove")}catch(e){}i(e)},u.widget=function(e,o,t){var i,a,n,r,s={},l=e.split(".")[0];e=e.split(".")[1],i=l+"-"+e,t||(t=o,o=u.Widget),u.expr[":"][i.toLowerCase()]=function(e){return!!u.data(e,i)},u[l]=u[l]||{},a=u[l][e],n=u[l][e]=function(e,t){if(!this._createWidget)return new n(e,t);arguments.length&&this._createWidget(e,t)},u.extend(n,a,{version:t.version,_proto:u.extend({},t),_childConstructors:[]}),(r=new o).options=u.widget.extend({},r.options),u.each(t,function(t,i){var a,n;u.isFunction(i)?s[t]=(a=function(){return o.prototype[t].apply(this,arguments)},n=function(e){return o.prototype[t].apply(this,e)},function(){var e,t=this._super,o=this._superApply;return this._super=a,this._superApply=n,e=i.apply(this,arguments),this._super=t,this._superApply=o,e}):s[t]=i}),n.prototype=u.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix:e},s,{constructor:n,namespace:l,widgetName:e,widgetFullName:i}),a?(u.each(a._childConstructors,function(e,t){var o=t.prototype;u.widget(o.namespace+"."+o.widgetName,n,t._proto)}),delete a._childConstructors):o._childConstructors.push(n),u.widget.bridge(e,n)},u.widget.extend=function(e){for(var t,o,i=l.call(arguments,1),a=0,n=i.length;a<n;a++)for(t in i[a])o=i[a][t],i[a].hasOwnProperty(t)&&o!==s&&(u.isPlainObject(o)?e[t]=u.isPlainObject(e[t])?u.widget.extend({},e[t],o):u.widget.extend({},o):e[t]=o);return e},u.widget.bridge=function(n,t){var r=t.prototype.widgetFullName||n;u.fn[n]=function(o){var e="string"==typeof o,i=l.call(arguments,1),a=this;return o=!e&&i.length?u.widget.extend.apply(null,[o].concat(i)):o,e?this.each(function(){var e,t=u.data(this,r);return t?u.isFunction(t[o])&&"_"!==o.charAt(0)?(e=t[o].apply(t,i))!==t&&e!==s?(a=e&&e.jquery?a.pushStack(e.get()):e,!1):void 0:u.error("no such method '"+o+"' for "+n+" widget instance"):u.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var e=u.data(this,r);e?e.option(o||{})._init():u.data(this,r,new t(o,this))}),a}},u.Widget=function(){},u.Widget._childConstructors=[],u.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=u(t||this.defaultElement||this)[0],this.element=u(t),this.uuid=o++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=u.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=u(),this.hoverable=u(),this.focusable=u(),t!==this&&(u.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=u(t.style?t.ownerDocument:t.document||t),this.window=u(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:u.noop,_getCreateEventData:u.noop,_create:u.noop,_init:u.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(u.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:u.noop,widget:function(){return this.element},option:function(e,t){var o,i,a,n=e;if(0===arguments.length)return u.widget.extend({},this.options);if("string"==typeof e)if(n={},e=(o=e.split(".")).shift(),o.length){for(i=n[e]=u.widget.extend({},this.options[e]),a=0;a<o.length-1;a++)i[o[a]]=i[o[a]]||{},i=i[o[a]];if(e=o.pop(),t===s)return i[e]===s?null:i[e];i[e]=t}else{if(t===s)return this.options[e]===s?null:this.options[e];n[e]=t}return this._setOptions(n),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(r,s,e){var l,c=this;"boolean"!=typeof r&&(e=s,s=r,r=!1),e?(s=l=u(s),this.bindings=this.bindings.add(s)):(e=s,s=this.element,l=this.widget()),u.each(e,function(e,t){function o(){if(r||!0!==c.options.disabled&&!u(this).hasClass("ui-state-disabled"))return("string"==typeof t?c[t]:t).apply(c,arguments)}"string"!=typeof t&&(o.guid=t.guid=t.guid||o.guid||u.guid++);var i=e.match(/^(\w+)\s*(.*)$/),a=i[1]+c.eventNamespace,n=i[2];n?l.delegate(n,a,o):s.bind(a,o)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var o=this;return setTimeout(function(){return("string"==typeof e?o[e]:e).apply(o,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){u(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){u(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){u(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){u(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,o){var i,a,n=this.options[e];if(o=o||{},(t=u.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],a=t.originalEvent)for(i in a)i in t||(t[i]=a[i]);return this.element.trigger(t,o),!(u.isFunction(n)&&!1===n.apply(this.element[0],[t].concat(o))||t.isDefaultPrevented())}},u.each({show:"fadeIn",hide:"fadeOut"},function(n,r){u.Widget.prototype["_"+n]=function(t,e,o){"string"==typeof e&&(e={effect:e});var i,a=e?!0===e||"number"==typeof e?r:e.effect||r:n;"number"==typeof(e=e||{})&&(e={duration:e}),i=!u.isEmptyObject(e),e.complete=o,e.delay&&t.delay(e.delay),i&&u.effects&&u.effects.effect[a]?t[n](e):a!==n&&t[a]?t[a](e.duration,e.easing,o):t.queue(function(e){u(this)[n](),o&&o.call(t[0]),e()})}})}),define("../JQueryUI/position",["jquery"],function(e){!function(C,e){C.ui=C.ui||{};var a,x=Math.max,w=Math.abs,A=Math.round,i=/left|center|right/,n=/top|center|bottom/,r=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,c=C.fn.position;function S(e,t,o){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?o/100:1)]}function D(e,t){return parseInt(C.css(e,t),10)||0}C.position={scrollbarWidth:function(){if(void 0!==a)return a;var e,t,o=C("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),i=o.children()[0];return C("body").append(o),e=i.offsetWidth,o.css("overflow","scroll"),e===(t=i.offsetWidth)&&(t=o[0].clientWidth),o.remove(),a=e-t},getScrollInfo:function(e){var t=e.isWindow?"":e.element.css("overflow-x"),o=e.isWindow?"":e.element.css("overflow-y"),i="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth;return{width:"scroll"===o||"auto"===o&&e.height<e.element[0].scrollHeight?C.position.scrollbarWidth():0,height:i?C.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=C(e||window),o=C.isWindow(t[0]);return{element:t,isWindow:o,offset:t.offset()||{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:o?t.width():t.outerWidth(),height:o?t.height():t.outerHeight()}}},C.fn.position=function(p){if(!p||!p.of)return c.apply(this,arguments);p=C.extend({},p);var d,m,h,f,g,e,t,o,_=C(p.of),v=C.position.getWithinInfo(p.within),y=C.position.getScrollInfo(v),k=(p.collision||"flip").split(" "),b={};return e=9===(o=(t=_)[0]).nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:C.isWindow(o)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:o.preventDefault?{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()},_[0].preventDefault&&(p.at="left top"),m=e.width,h=e.height,f=e.offset,g=C.extend({},f),C.each(["my","at"],function(){var e,t,o=(p[this]||"").split(" ");1===o.length&&(o=i.test(o[0])?o.concat(["center"]):n.test(o[0])?["center"].concat(o):["center","center"]),o[0]=i.test(o[0])?o[0]:"center",o[1]=n.test(o[1])?o[1]:"center",e=r.exec(o[0]),t=r.exec(o[1]),b[this]=[e?e[0]:0,t?t[0]:0],p[this]=[s.exec(o[0])[0],s.exec(o[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===p.at[0]?g.left+=m:"center"===p.at[0]&&(g.left+=m/2),"bottom"===p.at[1]?g.top+=h:"center"===p.at[1]&&(g.top+=h/2),d=S(b.at,m,h),g.left+=d[0],g.top+=d[1],this.each(function(){var o,e,r=C(this),s=r.outerWidth(),l=r.outerHeight(),t=D(this,"marginLeft"),i=D(this,"marginTop"),a=s+t+D(this,"marginRight")+y.width,n=l+i+D(this,"marginBottom")+y.height,c=C.extend({},g),u=S(b.my,r.outerWidth(),r.outerHeight());"right"===p.my[0]?c.left-=s:"center"===p.my[0]&&(c.left-=s/2),"bottom"===p.my[1]?c.top-=l:"center"===p.my[1]&&(c.top-=l/2),c.left+=u[0],c.top+=u[1],C.support.offsetFractions||(c.left=A(c.left),c.top=A(c.top)),o={marginLeft:t,marginTop:i},C.each(["left","top"],function(e,t){C.ui.position[k[e]]&&C.ui.position[k[e]][t](c,{targetWidth:m,targetHeight:h,elemWidth:s,elemHeight:l,collisionPosition:o,collisionWidth:a,collisionHeight:n,offset:[d[0]+u[0],d[1]+u[1]],my:p.my,at:p.at,within:v,elem:r})}),p.using&&(e=function(e){var t=f.left-c.left,o=t+m-s,i=f.top-c.top,a=i+h-l,n={target:{element:_,left:f.left,top:f.top,width:m,height:h},element:{element:r,left:c.left,top:c.top,width:s,height:l},horizontal:o<0?"left":0<t?"right":"center",vertical:a<0?"top":0<i?"bottom":"middle"};m<s&&w(t+o)<m&&(n.horizontal="center"),h<l&&w(i+a)<h&&(n.vertical="middle"),x(w(t),w(o))>x(w(i),w(a))?n.important="horizontal":n.important="vertical",p.using.call(this,e,n)}),r.offset(C.extend(c,{using:e}))})},C.ui.position={fit:{left:function(e,t){var o,i=t.within,a=i.isWindow?i.scrollLeft:i.offset.left,n=i.width,r=e.left-t.collisionPosition.marginLeft,s=a-r,l=r+t.collisionWidth-n-a;t.collisionWidth>n?0<s&&l<=0?(o=e.left+s+t.collisionWidth-n-a,e.left+=s-o):e.left=0<l&&s<=0?a:l<s?a+n-t.collisionWidth:a:0<s?e.left+=s:0<l?e.left-=l:e.left=x(e.left-r,e.left)},top:function(e,t){var o,i=t.within,a=i.isWindow?i.scrollTop:i.offset.top,n=t.within.height,r=e.top-t.collisionPosition.marginTop,s=a-r,l=r+t.collisionHeight-n-a;t.collisionHeight>n?0<s&&l<=0?(o=e.top+s+t.collisionHeight-n-a,e.top+=s-o):e.top=0<l&&s<=0?a:l<s?a+n-t.collisionHeight:a:0<s?e.top+=s:0<l?e.top-=l:e.top=x(e.top-r,e.top)}},flip:{left:function(e,t){var o,i,a=t.within,n=a.offset.left+a.scrollLeft,r=a.width,s=a.isWindow?a.scrollLeft:a.offset.left,l=e.left-t.collisionPosition.marginLeft,c=l-s,u=l+t.collisionWidth-r-s,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,d="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,m=-2*t.offset[0];c<0?((o=e.left+p+d+m+t.collisionWidth-r-n)<0||o<w(c))&&(e.left+=p+d+m):0<u&&(0<(i=e.left-t.collisionPosition.marginLeft+p+d+m-s)||w(i)<u)&&(e.left+=p+d+m)},top:function(e,t){var o,i,a=t.within,n=a.offset.top+a.scrollTop,r=a.height,s=a.isWindow?a.scrollTop:a.offset.top,l=e.top-t.collisionPosition.marginTop,c=l-s,u=l+t.collisionHeight-r-s,p="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,d="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];c<0?(i=e.top+p+d+m+t.collisionHeight-r-n,e.top+p+d+m>c&&(i<0||i<w(c))&&(e.top+=p+d+m)):0<u&&(o=e.top-t.collisionPosition.marginTop+p+d+m-s,e.top+p+d+m>u&&(0<o||w(o)<u)&&(e.top+=p+d+m))}},flipfit:{left:function(){C.ui.position.flip.left.apply(this,arguments),C.ui.position.fit.left.apply(this,arguments)},top:function(){C.ui.position.flip.top.apply(this,arguments),C.ui.position.fit.top.apply(this,arguments)}}},function(){var e,t,o,i,a,n=document.getElementsByTagName("body")[0],r=document.createElement("div");for(a in e=document.createElement(n?"div":"body"),o={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},n&&C.extend(o,{position:"absolute",left:"-1000px",top:"-1000px"}),o)e.style[a]=o[a];e.appendChild(r),(t=n||document.documentElement).insertBefore(e,t.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",i=C(r).offset().left,C.support.offsetFractions=10<i&&i<11,e.innerHTML="",t.removeChild(e)}()}(e)}),define("../JQueryUI/menu",["jquery","./core","./widget","./position"],function(e){var l;(l=e).widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,l.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(e){var t=l(e.target).closest(".ui-menu-item");!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(e),t.has(".ui-menu").length?this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var t=l(e.currentTarget);t.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,t)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var o=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,o)},blur:function(e){this._delay(function(){l.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){l(e.target).closest(".ui-menu").length||this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=l(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var t,o,i,a,n,r=!0;function s(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}switch(e.keyCode){case l.ui.keyCode.PAGE_UP:this.previousPage(e);break;case l.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case l.ui.keyCode.HOME:this._move("first","first",e);break;case l.ui.keyCode.END:this._move("last","last",e);break;case l.ui.keyCode.UP:this.previous(e);break;case l.ui.keyCode.DOWN:this.next(e);break;case l.ui.keyCode.LEFT:this.collapse(e);break;case l.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case l.ui.keyCode.ENTER:case l.ui.keyCode.SPACE:this._activate(e);break;case l.ui.keyCode.ESCAPE:this.collapse(e);break;default:r=!1,o=this.previousFilter||"",i=String.fromCharCode(e.keyCode),a=!1,clearTimeout(this.filterTimer),i===o?a=!0:i=o+i,n=new RegExp("^"+s(i),"i"),t=this.activeMenu.children(".ui-menu-item").filter(function(){return n.test(l(this).children("a").text())}),(t=a&&-1!==t.index(this.active.next())?this.active.nextAll(".ui-menu-item"):t).length||(i=String.fromCharCode(e.keyCode),n=new RegExp("^"+s(i),"i"),t=this.activeMenu.children(".ui-menu-item").filter(function(){return n.test(l(this).children("a").text())})),t.length?(this.focus(e,t),1<t.length?(this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}r&&e.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var e,i=this.options.icons.submenu,t=this.element.find(this.options.menus);t.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=l(this),t=e.prev("a"),o=l("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);t.attr("aria-haspopup","true").prepend(o),e.attr("aria-labelledby",t.attr("id"))}),(e=t.add(this.element)).children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=l(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!l.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var o,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(o=t.children(".ui-menu")).length&&/^mouse/.test(e.type)&&this._startOpening(o),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,o,i,a,n,r;this._hasScroll()&&(t=parseFloat(l.css(this.activeMenu[0],"borderTopWidth"))||0,o=parseFloat(l.css(this.activeMenu[0],"paddingTop"))||0,i=e.offset().top-this.activeMenu.offset().top-t-o,a=this.activeMenu.scrollTop(),n=this.activeMenu.height(),r=e.height(),i<0?this.activeMenu.scrollTop(a+i):n<i+r&&this.activeMenu.scrollTop(a+i-n+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(e){var t=l.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(t,o){clearTimeout(this.timer),this.timer=this._delay(function(){var e=o?this.element:l(t&&t.target).closest(this.element.find(".ui-menu"));e.length||(e=this.element),this._close(e),this.blur(t),this.activeMenu=e},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,o){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(o,i)},nextPage:function(e){var t,o,i;this.active?this.isLastItem()||(this._hasScroll()?(o=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(t=l(this)).offset().top-o-i<0}),this.focus(e,t)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())):this.next(e)},previousPage:function(e){var t,o,i;this.active?this.isFirstItem()||(this._hasScroll()?(o=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(t=l(this)).offset().top-o+i}),this.focus(e,t)):this.focus(e,this.activeMenu.children(".ui-menu-item").first())):this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||l(e.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,t)}})}),define("../JQueryUI/autocomplete",["jquery","./core","./widget","./position","./menu"],function(e){var r,i;i=0,(r=e).widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var o,i,a,e=this.element[0].nodeName.toLowerCase(),t="textarea"===e,n="input"===e;this.isMultiLine=!!t||!n&&this.element.prop("isContentEditable"),this.valueMethod=this.element[t||n?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))i=a=o=!0;else{i=a=o=!1;var t=r.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:o=!0,this._move("previousPage",e);break;case t.PAGE_DOWN:o=!0,this._move("nextPage",e);break;case t.UP:o=!0,this._keyEvent("previous",e);break;case t.DOWN:o=!0,this._keyEvent("next",e);break;case t.ENTER:case t.NUMPAD_ENTER:this.menu.active&&(o=!0,e.preventDefault(),this.menu.select(e));break;case t.TAB:this.menu.active&&this.menu.select(e);break;case t.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:i=!0,this._searchTimeout(e)}}},keypress:function(e){if(o)return o=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||e.preventDefault());if(!i){var t=r.ui.keyCode;switch(e.keyCode){case t.PAGE_UP:this._move("previousPage",e);break;case t.PAGE_DOWN:this._move("nextPage",e);break;case t.UP:this._keyEvent("previous",e);break;case t.DOWN:this._keyEvent("next",e)}}},input:function(e){if(a)return a=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this._change(e))}}),this._initSource(),this.menu=r("<ul>").addClass("ui-autocomplete ui-front ui-PT-autocomplete").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var o=this.menu.element[0];r(e.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(e){e.target===t.element[0]||e.target===o||r.contains(o,e.target)||t.close()})})},menufocus:function(e,t){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){r(e.target).trigger(e.originalEvent)});var o=t.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:o})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(o.value):this.liveRegion.text(o.value)},menuselect:function(e,t){var o=t.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=o})),!1!==this._trigger("select",e,{item:o})&&this._value(o.value),this.term=this._value(),this.close(e),this.selectedItem=o}}),this.liveRegion=r("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?r(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var o,i,a=this;r.isArray(this.options.source)?(o=this.options.source,this.source=function(e,t){t(r.ui.autocomplete.filter(o,e.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,t){a.xhr&&a.xhr.abort(),a.xhr=r.ajax({url:i,data:e,dataType:"json",success:function(e){t(e)},error:function(){t([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=this,o=++i;return function(e){o===i&&t.__response(e),t.pending--,t.pending||t.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:r.map(e,function(e){return"string"==typeof e?{label:e,value:e}:r.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e),this.isNewMenu=!0,this.menu.refresh(),t.show(),this._resizeMenu(),t.position(r.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(o,e){var i=this;r.each(e,function(e,t){i._renderItemData(o,t)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return r("<li>").append(r("<a>").text(t.label)).appendTo(e)},_move:function(e,t){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),r.extend(r.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var o=new RegExp(r.ui.autocomplete.escapeRegex(t),"i");return r.grep(e,function(e){return o.test(e.label||e.value||e)})}}),r.widget("ui.autocomplete",r.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(1<e?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}),define("../Common/autocomplete",["jquery","../JQueryUI/autocomplete"],function(d,e){return function(e){var l=d.extend({},{minLength:3,isNotAsync:!1,autoFocus:!0,dataType:"jsonp",createAltField:!0,mandatory:!1,errors:{},sliceSize:15,selected:!1},e),i=[9,13,27,32],n=function(e){return e.toLowerCase().replace(/á/gi,"a").replace(/é/gi,"e").replace(/í/gi,"i").replace(/ó/gi,"o").replace(/ú/gi,"u")},o=function(e){return null!=l.queryName&&(l.data[l.queryName]=e),d.ajax({url:l.uri+("jsonp"==l.dataType?"?jsoncallback=?":""),dataType:l.dataType,data:l.data})},c=function(e){return null!=l.mapping?(e.altValue="",l.mapping(e)):null},u=function(e,t){1==t&&d(l.selector).val(e.item.label),l.altSelector=l.altSelector||l.selector+"_hidden",d(l.altSelector).val(e.item.altValue).trigger("change"),null!=l.onSelectCallback&&l.onSelectCallback(e,l.selector),l.selected=!0},p=function(a){var e=d(l.selector).autocomplete({source:"function"==typeof a?a:function(e,t){var o=new RegExp(d.ui.autocomplete.escapeRegex(e.term),"i"),i=d.grep(a,function(e){return e=e.label||e.value||e,o.test(e)||o.test(n(e))});t(0<l.sliceSize?i.slice(0,l.sliceSize):i)},minLength:l.minLength,autoFocus:l.autoFocus,select:function(e,t){u(t)},create:function(e,t){d(".ui-PT-autocomplete").each(function(){var e=d(this).attr("id");0==d("#"+e).parent(".pt-customJqueryUi").length&&(0==d(".pt-customJqueryUi").length?d("#"+e).wrap("<div class='pt-customJqueryUi' />"):d(".pt-customJqueryUi").append(d("#"+e)))})}});return 1==l.mandatory&&d(l.selector).on("autocompletechange",function(e,t){null!=t.item&&null!=t.item||d(l.selector).val("")}),e},t=function(){d(l.selector).bind("keyup",function(e){for(var t=!0,o=0;o<i.length;o++)if(e.keyCode===i[o]){t=!1;break}t&&(""!=d(l.altSelector).val()&&1!=l.selected&&(d(l.altSelector).val(""),null!=l.onClear&&l.onClear()),l.selected=!1)})},a=function(){return l.altSelector||l.selector+"_hidden"};return{init:function(){l.altSelector=a(),1==l.createAltField&&0==d(l.altSelector).length&&d("<input/>",{type:"hidden",id:l.altSelector.replace(/(\B)(#|\.)(\w+)\b/g,"$3")}).insertBefore(l.selector),t();var r,s=new d.Deferred;return null!=l.source&&l.source!=[]&&null!=l.source?(l.minLength=0,r=p(l.source),s.resolve(r),s.done(function(t){t.click(function(){var e={minLength:0,source:function(e,t){var o=new RegExp(d.ui.autocomplete.escapeRegex(e.term),"i"),i=d.grep(l.source,function(e){return e=e.label||e.value||e,o.test(e)||o.test(n(e))});t(0<l.sliceSize?i.slice(0,l.sliceSize):i)},search:function(e,t){}};t.autocomplete(e).autocomplete("search","")})})):1==l.isNotAsync?(o("").done(function(e){var t=d.map(e,function(e){return c(e)});if(l.minLength=0,r=p(t),1==t.length){var o={item:t[0]};u(o,!0)}else if(d(l.altSelector).length)for(var i=d(l.altSelector).val(),a=0;a<t.length;a++){var n={item:t[a]};n.item.altValue===i&&u(n,!0)}s.resolve(r)}),s.done(function(e){e.click(function(){e.autocomplete("search","")})})):(r=p(function(e,t){o(e.term).done(function(e){t(d.map(e,function(e){return c(e)}))})}),s.resolve(r)),s.promise()},fill:function(e){var t=d.trim(d(l.selector).val()),o=d.trim(d(l.altSelector).val()),i=new d.Deferred;return e.revalidate=e.revalidate||!0,l.data[l.queryName]=function(){return d(l.selector).val()},1==e.revalidate&&""!=t&&(""==o||"0"==o)||1==e.forceRevalidation?d.ajax({url:e.revalidateUri+("jsonp"==l.dataType?"?jsoncallback=?":""),dataType:l.dataType,data:l.data}).done(function(e){i.resolve(e,l.selector,l.altSelector)}):i.resolve(),i.promise()},validate:function(e){var t=new d.Deferred,o=d.trim(d(l.selector).val()),i=d.trim(d(l.altSelector).val()),a=[],n=!1;return d(l.selector).removeClass(e.errorClass),""==o&&(e.validateEmpty,1)&&(a.push({key:l.selector,value:l.errors.empty}),n=!0),""==i&&(a.push({key:l.selector,value:l.errors.invalid}),n=!0),n&&d(l.selector).addClass(e.errorClass),e.onEndValidationCallback&&e.onEndValidationCallback(l.selector,l.altSelector),t.resolve(a),t.promise()},getAltSelector:a}}}),define("localization",[],function(){return{es:{closeText:"Cerrar",prevText:"&#x3c;Ant",nextText:"Sig&#x3e;",currentText:"Hoy",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],dayNamesShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","S&aacute;"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},"pt-BR":{closeText:"Fechar",prevText:"&#x3C;Anterior",nextText:"Pr&oacute;ximo&#x3E;",currentText:"Hoje",monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""}}}),define("../JQueryUI/datepicker",["jquery","./core"],function(e){!function(x,l){x.extend(x.ui,{datepicker:{version:"1.10.3"}});var a,p="datepicker";function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ptw-ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},x.extend(this._defaults,this.regional[""]),this.dpDiv=o(x("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function o(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){x(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){x.datepicker._isDisabledDatepicker(a.inline?e.parent()[0]:a.input[0])||(x(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),x(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).addClass("ui-datepicker-next-hover"))})}function d(e,t){for(var o in x.extend(e,t),t)null==t[o]&&(e[o]=t[o]);return e}x.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return d(this._defaults,e||{}),this},_attachDatepicker:function(e,t){var o,i,a;i="div"===(o=e.nodeName.toLowerCase())||"span"===o,e.id||(this.uuid+=1,e.id="dp"+this.uuid),(a=this._newInst(x(e),i)).settings=x.extend({},t||{}),"input"===o?this._connectDatepicker(e,a):i&&this._inlineDatepicker(e,a)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?o(x("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,t){var o=x(e);t.append=x([]),t.trigger=x([]),o.hasClass(this.markerClassName)||(this._attachments(o,t),o.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(t),x.data(e,p,t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var o,i,a,n=this._get(t,"appendText"),r=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=x("<span class='"+this._appendClass+"'>"+n+"</span>"),e[r?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),"focus"!==(o=this._get(t,"showOn"))&&"both"!==o||e.focus(this._showDatepicker),"button"!==o&&"both"!==o||(i=this._get(t,"buttonText"),a=this._get(t,"buttonImage"),t.trigger=x(this._get(t,"buttonImageOnly")?x("<img/>").addClass(this._triggerClass).attr({src:a,alt:i,title:i}):x("<button type='button'></button>").addClass(this._triggerClass).html(a?x("<img/>").attr({src:a,alt:i,title:i}):i)),e[r?"before":"after"](t.trigger),t.trigger.click(function(){x.datepicker._datepickerShowing&&x.datepicker._lastInput===e[0]?x.datepicker._hideDatepicker():(x.datepicker._datepickerShowing&&x.datepicker._lastInput!==e[0]&&x.datepicker._hideDatepicker(),x.datepicker._showDatepicker(e[0]))}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,o,i,a,n=new Date(2009,11,20),r=this._get(e,"dateFormat");r.match(/[DM]/)&&(t=function(e){for(a=i=o=0;a<e.length;a++)e[a].length>o&&(o=e[a].length,i=a);return i},n.setMonth(t(this._get(e,r.match(/MM/)?"monthNames":"monthNamesShort"))),n.setDate(t(this._get(e,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-n.getDay())),e.input.attr("size",this._formatDate(e,n).length)}},_inlineDatepicker:function(e,t){var o=x(e);o.hasClass(this.markerClassName)||(o.addClass(this.markerClassName).append(t.dpDiv),x.data(e,p,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,o,i,a){var n,r,s,l,c,u=this._dialogInst;return u||(this.uuid+=1,n="dp"+this.uuid,this._dialogInput=x("<input type='text' id='"+n+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),x("body").append(this._dialogInput),(u=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},x.data(this._dialogInput[0],p,u)),d(u.settings,i||{}),t=t&&t.constructor===Date?this._formatDate(u,t):t,this._dialogInput.val(t),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(r=document.documentElement.clientWidth,s=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[r/2-100+l,s/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),u.settings.onSelect=o,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),x.blockUI&&x.blockUI(this.dpDiv),x.data(this._dialogInput[0],p,u),this},_destroyDatepicker:function(e){var t,o=x(e),i=x.data(e,p);o.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),x.removeData(e,p),"input"===t?(i.append.remove(),i.trigger.remove(),o.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==t&&"span"!==t||o.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var e,o,i=x(t),a=x.data(t,p);i.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==e&&"span"!==e||((o=i.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),o.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=x.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var e,o,i=x(t),a=x.data(t,p);i.hasClass(this.markerClassName)&&("input"===(e=t.nodeName.toLowerCase())?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==e&&"span"!==e||((o=i.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),o.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=x.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(e){try{return x.data(e,p)}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,o){var i,a,n,r,s=this._getInst(e);if(2===arguments.length&&"string"==typeof t)return"defaults"===t?x.extend({},x.datepicker._defaults):s?"all"===t?x.extend({},s.settings):this._get(s,t):null;i=t||{},"string"==typeof t&&((i={})[t]=o),s&&(this._curInst===s&&this._hideDatepicker(),a=this._getDateDatepicker(e,!0),n=this._getMinMaxDate(s,"min"),r=this._getMinMaxDate(s,"max"),d(s.settings,i),null!==n&&i.dateFormat!==l&&i.minDate===l&&(s.settings.minDate=this._formatDate(s,n)),null!==r&&i.dateFormat!==l&&i.maxDate===l&&(s.settings.maxDate=this._formatDate(s,r)),"disabled"in i&&(i.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(x(e),s),this._autoSize(s),this._setDate(s,a),this._updateAlternate(s),this._updateDatepicker(s))},_changeDatepicker:function(e,t,o){this._optionDatepicker(e,t,o)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var o=this._getInst(e);o&&(this._setDate(o,t),this._updateDatepicker(o),this._updateAlternate(o))},_getDateDatepicker:function(e,t){var o=this._getInst(e);return o&&!o.inline&&this._setDateFromField(o,t),o?this._getDate(o):null},_doKeyDown:function(e){var t,o,i,a=x.datepicker._getInst(e.target),n=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,x.datepicker._datepickerShowing)switch(e.keyCode){case 9:x.datepicker._hideDatepicker(),n=!1;break;case 13:return(i=x("td."+x.datepicker._dayOverClass+":not(."+x.datepicker._currentClass+")",a.dpDiv))[0]&&x.datepicker._selectDay(e.target,a.selectedMonth,a.selectedYear,i[0]),(t=x.datepicker._get(a,"onSelect"))?(o=x.datepicker._formatDate(a),t.apply(a.input?a.input[0]:null,[o,a])):x.datepicker._hideDatepicker(),!1;case 27:x.datepicker._hideDatepicker();break;case 33:x.datepicker._adjustDate(e.target,e.ctrlKey?-x.datepicker._get(a,"stepBigMonths"):-x.datepicker._get(a,"stepMonths"),"M");break;case 34:x.datepicker._adjustDate(e.target,e.ctrlKey?+x.datepicker._get(a,"stepBigMonths"):+x.datepicker._get(a,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&x.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&x.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,r?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&x.datepicker._adjustDate(e.target,e.ctrlKey?-x.datepicker._get(a,"stepBigMonths"):-x.datepicker._get(a,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,r?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&x.datepicker._adjustDate(e.target,e.ctrlKey?+x.datepicker._get(a,"stepBigMonths"):+x.datepicker._get(a,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&x.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else 36===e.keyCode&&e.ctrlKey?x.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t,o,i=x.datepicker._getInst(e.target);if(x.datepicker._get(i,"constrainInput"))return t=x.datepicker._possibleChars(x.datepicker._get(i,"dateFormat")),o=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||o<" "||!t||-1<t.indexOf(o)},_doKeyUp:function(e){var t=x.datepicker._getInst(e.target);if(t.input.val()!==t.lastVal)try{x.datepicker.parseDate(x.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,x.datepicker._getFormatConfig(t))&&(x.datepicker._setDateFromField(t),x.datepicker._updateAlternate(t),x.datepicker._updateDatepicker(t))}catch(e){}return!0},_showDatepicker:function(e){var t,o,i,a,n,r,s;("input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=x("input",e.parentNode)[0]),x.datepicker._isDisabledDatepicker(e)||x.datepicker._lastInput===e)||(t=x.datepicker._getInst(e),x.datepicker._curInst&&x.datepicker._curInst!==t&&(x.datepicker._curInst.dpDiv.stop(!0,!0),t&&x.datepicker._datepickerShowing&&x.datepicker._hideDatepicker(x.datepicker._curInst.input[0])),!1!==(i=(o=x.datepicker._get(t,"beforeShow"))?o.apply(e,[e,t]):{})&&(d(t.settings,i),t.lastVal=null,x.datepicker._lastInput=e,x.datepicker._setDateFromField(t),x.datepicker._inDialog&&(e.value=""),x.datepicker._pos||(x.datepicker._pos=x.datepicker._findPos(e),x.datepicker._pos[1]+=e.offsetHeight),a=!1,x(e).parents().each(function(){return!(a|="fixed"===x(this).css("position"))}),n={left:x.datepicker._pos[0],top:x.datepicker._pos[1]},x.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),x.datepicker._updateDatepicker(t),n=x.datepicker._checkOffset(t,n,a),t.dpDiv.css({position:x.datepicker._inDialog&&x.blockUI?"static":a?"fixed":"absolute",display:"none",left:n.left+"px",top:n.top+"px"}),t.inline||(r=x.datepicker._get(t,"showAnim"),s=x.datepicker._get(t,"duration"),t.dpDiv.zIndex(x(e).zIndex()+1),x.datepicker._datepickerShowing=!0,x.effects&&x.effects.effect[r]?t.dpDiv.show(r,x.datepicker._get(t,"showOptions"),s):t.dpDiv[r||"show"](r?s:null),x.datepicker._shouldFocusInput(t)&&t.input.focus(),x.datepicker._curInst=t)))},_updateDatepicker:function(e){this.maxRows=4,(a=e).dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var t,o=this._getNumberOfMonths(e),i=o[1];e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<i&&e.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",17*i+"em"),e.dpDiv[(1!==o[0]||1!==o[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===x.datepicker._curInst&&x.datepicker._datepickerShowing&&x.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(t=e.yearshtml,setTimeout(function(){t===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),t=e.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,o){var i=e.dpDiv.outerWidth(),a=e.dpDiv.outerHeight(),n=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,s=document.documentElement.clientWidth+(o?0:x(document).scrollLeft()),l=document.documentElement.clientHeight+(o?0:x(document).scrollTop());return t.left-=this._get(e,"isRTL")?i-n:0,t.left-=o&&t.left===e.input.offset().left?x(document).scrollLeft():0,t.top-=o&&t.top===e.input.offset().top+r?x(document).scrollTop():0,t.left-=Math.min(t.left,t.left+i>s&&i<s?Math.abs(t.left+i-s):0),t.top-=Math.min(t.top,t.top+a>l&&a<l?Math.abs(a+r):0),t},_findPos:function(e){for(var t,o=this._getInst(e),i=this._get(o,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||x.expr.filters.hidden(e));)e=e[i?"previousSibling":"nextSibling"];return[(t=x(e).offset()).left,t.top]},_hideDatepicker:function(e){var t,o,i,a,n=this._curInst;!n||e&&n!==x.data(e,p)||this._datepickerShowing&&(t=this._get(n,"showAnim"),o=this._get(n,"duration"),i=function(){x.datepicker._tidyDialog(n)},x.effects&&(x.effects.effect[t]||x.effects[t])?n.dpDiv.hide(t,x.datepicker._get(n,"showOptions"),o,i):n.dpDiv["slideDown"===t?"slideUp":"fadeIn"===t?"fadeOut":"hide"](t?o:null,i),t||i(),this._datepickerShowing=!1,(a=this._get(n,"onClose"))&&a.apply(n.input?n.input[0]:null,[n.input?n.input.val():"",n]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),x.blockUI&&(x.unblockUI(),x("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(x.datepicker._curInst){var t=x(e.target),o=x.datepicker._getInst(t[0]);(t[0].id===x.datepicker._mainDivId||0!==t.parents("#"+x.datepicker._mainDivId).length||t.hasClass(x.datepicker.markerClassName)||t.closest("."+x.datepicker._triggerClass).length||!x.datepicker._datepickerShowing||x.datepicker._inDialog&&x.blockUI)&&(!t.hasClass(x.datepicker.markerClassName)||x.datepicker._curInst===o)||x.datepicker._hideDatepicker()}},_adjustDate:function(e,t,o){var i=x(e),a=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(a,t+("M"===o?this._get(a,"showCurrentAtPos"):0),o),this._updateDatepicker(a))},_gotoToday:function(e){var t,o=x(e),i=this._getInst(o[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(t=new Date,i.selectedDay=t.getDate(),i.drawMonth=i.selectedMonth=t.getMonth(),i.drawYear=i.selectedYear=t.getFullYear()),this._notifyChange(i),this._adjustDate(o)},_selectMonthYear:function(e,t,o){var i=x(e),a=this._getInst(i[0]);a["selected"+("M"===o?"Month":"Year")]=a["draw"+("M"===o?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(i)},_selectDay:function(e,t,o,i){var a,n=x(e);x(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(n[0])||((a=this._getInst(n[0])).selectedDay=a.currentDay=x("a",i).html(),a.selectedMonth=a.currentMonth=t,a.selectedYear=a.currentYear=o,this._selectDate(e,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(e){var t=x(e);this._selectDate(t,"")},_selectDate:function(e,t){var o,i=x(e),a=this._getInst(i[0]);t=null!=t?t:this._formatDate(a),a.input&&a.input.val(t),this._updateAlternate(a),(o=this._get(a,"onSelect"))?o.apply(a.input?a.input[0]:null,[t,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t,o,i,a=this._get(e,"altField");a&&(t=this._get(e,"altFormat")||this._get(e,"dateFormat"),o=this._getDate(e),i=this.formatDate(t,o,this._getFormatConfig(e)),x(a).each(function(){x(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[0<t&&t<6,""]},iso8601Week:function(e){var t,o=new Date(e.getTime());return o.setDate(o.getDate()+4-(o.getDay()||7)),t=o.getTime(),o.setMonth(0),o.setDate(1),Math.floor(Math.round((t-o)/864e5)/7)+1},parseDate:function(o,n,e){if(null==o||null==n)throw"Invalid arguments";if(""===(n="object"==typeof n?n.toString():n+""))return null;var i,t,a,r,s=0,l=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),u=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,p=(e?e.dayNames:null)||this._defaults.dayNames,d=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,m=(e?e.monthNames:null)||this._defaults.monthNames,h=-1,f=-1,g=-1,_=-1,v=!1,y=function(e){var t=i+1<o.length&&o.charAt(i+1)===e;return t&&i++,t},k=function(e){var t=y(e),o=new RegExp("^\\d{1,"+("@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2)+"}"),i=n.substring(s).match(o);if(!i)throw"Missing number at position "+s;return s+=i[0].length,parseInt(i[0],10)},b=function(e,t,o){var i=-1,a=x.map(y(e)?o:t,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(x.each(a,function(e,t){var o=t[1];if(n.substr(s,o.length).toLowerCase()===o.toLowerCase())return i=t[0],s+=o.length,!1}),-1!==i)return i+1;throw"Unknown name at position "+s},C=function(){if(n.charAt(s)!==o.charAt(i))throw"Unexpected literal at position "+s;s++};for(i=0;i<o.length;i++)if(v)"'"!==o.charAt(i)||y("'")?C():v=!1;else switch(o.charAt(i)){case"d":g=k("d");break;case"D":b("D",u,p);break;case"o":_=k("o");break;case"m":f=k("m");break;case"M":f=b("M",d,m);break;case"y":h=k("y");break;case"@":h=(r=new Date(k("@"))).getFullYear(),f=r.getMonth()+1,g=r.getDate();break;case"!":h=(r=new Date((k("!")-this._ticksTo1970)/1e4)).getFullYear(),f=r.getMonth()+1,g=r.getDate();break;case"'":y("'")?C():v=!0;break;default:C()}if(s<n.length&&(a=n.substr(s),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===h?h=(new Date).getFullYear():h<100&&(h+=(new Date).getFullYear()-(new Date).getFullYear()%100+(h<=c?0:-100)),-1<_)for(f=1,g=_;;){if(g<=(t=this._getDaysInMonth(h,f-1)))break;f++,g-=t}if((r=this._daylightSavingAdjust(new Date(h,f-1,g))).getFullYear()!==h||r.getMonth()+1!==f||r.getDate()!==g)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(o,e,t){if(!e)return"";var i,a=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,n=(t?t.dayNames:null)||this._defaults.dayNames,r=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,s=(t?t.monthNames:null)||this._defaults.monthNames,l=function(e){var t=i+1<o.length&&o.charAt(i+1)===e;return t&&i++,t},c=function(e,t,o){var i=""+t;if(l(e))for(;i.length<o;)i="0"+i;return i},u=function(e,t,o,i){return l(e)?i[t]:o[t]},p="",d=!1;if(e)for(i=0;i<o.length;i++)if(d)"'"!==o.charAt(i)||l("'")?p+=o.charAt(i):d=!1;else switch(o.charAt(i)){case"d":p+=c("d",e.getDate(),2);break;case"D":p+=u("D",e.getDay(),a,n);break;case"o":p+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":p+=c("m",e.getMonth()+1,2);break;case"M":p+=u("M",e.getMonth(),r,s);break;case"y":p+=l("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":p+=e.getTime();break;case"!":p+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?p+="'":d=!0;break;default:p+=o.charAt(i)}return p},_possibleChars:function(o){var i,e="",t=!1,a=function(e){var t=i+1<o.length&&o.charAt(i+1)===e;return t&&i++,t};for(i=0;i<o.length;i++)if(t)"'"!==o.charAt(i)||a("'")?e+=o.charAt(i):t=!1;else switch(o.charAt(i)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":a("'")?e+="'":t=!0;break;default:e+=o.charAt(i)}return e},_get:function(e,t){return e.settings[t]!==l?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var o=this._get(e,"dateFormat"),i=e.lastVal=e.input?e.input.val():null,a=this._getDefaultDate(e),n=a,r=this._getFormatConfig(e);try{n=this.parseDate(o,i,r)||a}catch(e){i=t?"":i}e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),e.currentDay=i?n.getDate():0,e.currentMonth=i?n.getMonth():0,e.currentYear=i?n.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(s,e,t){var o,i,a=null==e||""===e?t:"string"==typeof e?function(e){try{return x.datepicker.parseDate(x.datepicker._get(s,"dateFormat"),e,x.datepicker._getFormatConfig(s))}catch(e){}for(var t=(e.toLowerCase().match(/^c/)?x.datepicker._getDate(s):null)||new Date,o=t.getFullYear(),i=t.getMonth(),a=t.getDate(),n=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,r=n.exec(e);r;){switch(r[2]||"d"){case"d":case"D":a+=parseInt(r[1],10);break;case"w":case"W":a+=7*parseInt(r[1],10);break;case"m":case"M":i+=parseInt(r[1],10),a=Math.min(a,x.datepicker._getDaysInMonth(o,i));break;case"y":case"Y":o+=parseInt(r[1],10),a=Math.min(a,x.datepicker._getDaysInMonth(o,i))}r=n.exec(e)}return new Date(o,i,a)}(e):"number"==typeof e?isNaN(e)?t:(o=e,(i=new Date).setDate(i.getDate()+o),i):new Date(e.getTime());return(a=a&&"Invalid Date"===a.toString()?t:a)&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(e){return e?(e.setHours(12<e.getHours()?e.getHours()+2:0),e):null},_setDate:function(e,t,o){var i=!t,a=e.selectedMonth,n=e.selectedYear,r=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=r.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=r.getMonth(),e.drawYear=e.selectedYear=e.currentYear=r.getFullYear(),a===e.selectedMonth&&n===e.selectedYear||o||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),o="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){x.datepicker._adjustDate(o,-t,"M")},next:function(){x.datepicker._adjustDate(o,+t,"M")},hide:function(){x.datepicker._hideDatepicker()},today:function(){x.datepicker._gotoToday(o)},selectDay:function(){return x.datepicker._selectDay(o,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return x.datepicker._selectMonthYear(o,this,"M"),!1},selectYear:function(){return x.datepicker._selectMonthYear(o,this,"Y"),!1}};x(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,o,i,a,n,r,s,l,c,u,p,d,m,h,f,g,_,v,y,k,b,C,x,w,A,S,D,T,M,I,P,E,F,N,O,B,U,j,R,q=new Date,H=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),Y=this._get(e,"isRTL"),L=this._get(e,"showButtonPanel"),V=this._get(e,"hideIfNoPrevNext"),W=this._get(e,"navigationAsDateFormat"),z=this._getNumberOfMonths(e),K=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),Q=1!==z[0]||1!==z[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),$=this._getMinMaxDate(e,"min"),Z=this._getMinMaxDate(e,"max"),X=e.drawMonth-K,ee=e.drawYear;if(X<0&&(X+=12,ee--),Z)for(t=this._daylightSavingAdjust(new Date(Z.getFullYear(),Z.getMonth()-z[0]*z[1]+1,Z.getDate())),t=$&&t<$?$:t;this._daylightSavingAdjust(new Date(ee,X,1))>t;)--X<0&&(X=11,ee--);for(e.drawMonth=X,e.drawYear=ee,o=this._get(e,"prevText"),o=W?this.formatDate(o,this._daylightSavingAdjust(new Date(ee,X-J,1)),this._getFormatConfig(e)):o,i=this._canAdjustMonth(e,-1,ee,X)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+o+"</span></a>":V?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+o+"</span></a>",a=this._get(e,"nextText"),a=W?this.formatDate(a,this._daylightSavingAdjust(new Date(ee,X+J,1)),this._getFormatConfig(e)):a,n=this._canAdjustMonth(e,1,ee,X)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+a+"</span></a>":V?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+a+"</span></a>",r=this._get(e,"currentText"),s=this._get(e,"gotoCurrent")&&e.currentDay?G:H,r=W?this.formatDate(r,s,this._getFormatConfig(e)):r,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",c=L?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+r+"</button>":"")+(Y?"":l)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,p=this._get(e,"showWeek"),d=this._get(e,"dayNames"),m=this._get(e,"dayNamesMin"),h=this._get(e,"monthNames"),f=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),_=this._get(e,"showOtherMonths"),v=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),k="",C=0;C<z[0];C++){for(x="",this.maxRows=4,w=0;w<z[1];w++){if(A=this._daylightSavingAdjust(new Date(ee,X,e.selectedDay)),S=" ui-corner-all",D="",Q){if(D+="<div class='ui-datepicker-group",1<z[1])switch(w){case 0:D+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case z[1]-1:D+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:D+=" ui-datepicker-group-middle",S=""}D+="'>"}for(D+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===C?Y?n:i:"")+(/all|right/.test(S)&&0===C?Y?i:n:"")+this._generateMonthYearHeader(e,X,ee,$,Z,0<C||0<w,h,f)+"</div><table class='ui-datepicker-calendar'><thead><tr>",T=p?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",b=0;b<7;b++)T+="<th"+(5<=(b+u+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+d[M=(b+u)%7]+"'>"+m[M]+"</span></th>";for(D+=T+"</tr></thead><tbody>",I=this._getDaysInMonth(ee,X),ee===e.selectedYear&&X===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,I)),P=(this._getFirstDayOfMonth(ee,X)-u+7)%7,E=Math.ceil((P+I)/7),F=Q&&this.maxRows>E?this.maxRows:E,this.maxRows=F,N=this._daylightSavingAdjust(new Date(ee,X,1-P)),O=0;O<F;O++){for(D+="<tr>",B=p?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(N)+"</td>":"",b=0;b<7;b++)U=g?g.apply(e.input?e.input[0]:null,[N]):[!0,""],R=(j=N.getMonth()!==X)&&!v||!U[0]||$&&N<$||Z&&Z<N,B+="<td class='"+(5<=(b+u+6)%7?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(N.getTime()===A.getTime()&&X===e.selectedMonth&&e._keyEvent||y.getTime()===N.getTime()&&y.getTime()===A.getTime()?" "+this._dayOverClass:"")+(R?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!_?"":" "+U[1]+(N.getTime()===G.getTime()?" "+this._currentClass:"")+(N.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(j&&!_||!U[2]?"":" title='"+U[2].replace(/'/g,"&#39;")+"'")+(R?"":" data-handler='selectDay' data-event='click' data-month='"+N.getMonth()+"' data-year='"+N.getFullYear()+"'")+">"+(j&&!_?"&#xa0;":R?"<span class='ui-state-default'>"+N.getDate()+"</span>":"<a class='ui-state-default"+(N.getTime()===H.getTime()?" ui-state-highlight":"")+(N.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+N.getDate()+"</a>")+"</td>",N.setDate(N.getDate()+1),N=this._daylightSavingAdjust(N);D+=B+"</tr>"}11<++X&&(X=0,ee++),x+=D+="</tbody></table>"+(Q?"</div>"+(0<z[0]&&w===z[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}k+=x}return k+=c,e._keyEvent=!1,k},_generateMonthYearHeader:function(e,t,o,i,a,n,r,s){var l,c,u,p,d,m,h,f,g=this._get(e,"changeMonth"),_=this._get(e,"changeYear"),v=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",k="";if(n||!g)k+="<span class='ui-datepicker-month'>"+r[t]+"</span>";else{for(l=i&&i.getFullYear()===o,c=a&&a.getFullYear()===o,k+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;u<12;u++)(!l||u>=i.getMonth())&&(!c||u<=a.getMonth())&&(k+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+s[u]+"</option>");k+="</select>"}if(v||(y+=k+(!n&&g&&_?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",n||!_)y+="<span class='ui-datepicker-year'>"+o+"</span>";else{for(p=this._get(e,"yearRange").split(":"),d=(new Date).getFullYear(),h=(m=function(e){var t=e.match(/c[+\-].*/)?o+parseInt(e.substring(1),10):e.match(/[+\-].*/)?d+parseInt(e,10):parseInt(e,10);return isNaN(t)?d:t})(p[0]),f=Math.max(h,m(p[1]||"")),h=i?Math.max(h,i.getFullYear()):h,f=a?Math.min(f,a.getFullYear()):f,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";h<=f;h++)e.yearshtml+="<option value='"+h+"'"+(h===o?" selected='selected'":"")+">"+h+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),v&&(y+=(!n&&g&&_?"":"&#xa0;")+k),y+="</div>"},_adjustInstDate:function(e,t,o){var i=e.drawYear+("Y"===o?t:0),a=e.drawMonth+("M"===o?t:0),n=Math.min(e.selectedDay,this._getDaysInMonth(i,a))+("D"===o?t:0),r=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,a,n)));e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),"M"!==o&&"Y"!==o||this._notifyChange(e)},_restrictMinMax:function(e,t){var o=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),a=o&&t<o?o:t;return i&&i<a?i:a},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,o,i){var a=this._getNumberOfMonths(e),n=this._daylightSavingAdjust(new Date(o,i+(t<0?t:a[0]*a[1]),1));return t<0&&n.setDate(this._getDaysInMonth(n.getFullYear(),n.getMonth())),this._isInRange(e,n)},_isInRange:function(e,t){var o,i,a=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=null,s=null,l=this._get(e,"yearRange");return l&&(o=l.split(":"),i=(new Date).getFullYear(),r=parseInt(o[0],10),s=parseInt(o[1],10),o[0].match(/[+\-].*/)&&(r+=i),o[1].match(/[+\-].*/)&&(s+=i)),(!a||t.getTime()>=a.getTime())&&(!n||t.getTime()<=n.getTime())&&(!r||t.getFullYear()>=r)&&(!s||t.getFullYear()<=s)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,o,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var a=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,o,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),a,this._getFormatConfig(e))}}),x.fn.datepicker=function(e){if(!this.length)return this;x.datepicker.initialized||(x(document).mousedown(x.datepicker._checkExternalClick),x.datepicker.initialized=!0),0===x("#"+x.datepicker._mainDivId).length&&x("body").append(x.datepicker.dpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this].concat(t)):x.datepicker._attachDatepicker(this,e)}):x.datepicker["_"+e+"Datepicker"].apply(x.datepicker,[this[0]].concat(t))},x.datepicker=new e,x.datepicker.initialized=!1,x.datepicker.uuid=(new Date).getTime(),x.datepicker.version="1.10.3"}(e)}),define("../Common/calendar",["jquery","localization","../JQueryUI/datepicker"],function(g,o,e){return function(e){var a,c=g.extend({},{allowSameDates:!1,numberOfMonths:2,showAnim:"",showButtonPanel:!1,buttonImage:"",buttonImageOnly:!0,showOn:"focus",minDate:null,altFormat:null,listCalendars:!0,calendars:[],highlightSelectedDates:!0,highlightInterDates:!0},e),t=function(a,e){if(null!=a){if(a.index=f(c.calendars)+1,1==e&&c.calendars.push(a),a.altSelector=a.altSelector||a.selector+"_hidden",null!=a.createAltField&&1!=a.createAltField||0==g(a.altSelector).length&&g("<input/>",{type:"hidden",id:a.altSelector.replace(/(\B)(#|\.)(\w+)\b/g,"$3")}).insertBefore(a.selector),null!=a.restrictedDates&&null!=a.restrictedDates)for(var t=0;t<a.restrictedDates.length;t++)a.restrictedDates[t]=a.restrictedDates[t].replace(new RegExp("/","g"),"-");var o;o=a.selector,g(o).datepicker({numberOfMonths:c.numberOfMonths,showAnim:c.showAnim,showButtonPanel:c.showButtonPanel,showOn:c.showOn,minDate:c.minDate,altField:a.altSelector,altFormat:c.altFormat,onSelect:function(e){l(e,a),a.justSelected=!0},onClose:function(e){var t=g(this).datepicker("getDate"),o=g.datepicker.formatDate("yy-mm-dd",t);if(n(e,a,o),1==a.justSelected&&1==c.listCalendars){var i=h(a.index);i&&""!=i.selector&&g(i.selector).is(":visible")&&(g(i.selector).focus(),setTimeout(function(){g(i.selector).focus()},0)),a.justSelected=!1}else 0==a.justSelected&&(r(t,a),s(t,a))},beforeShowDay:function(e){return i(e,o,a.restrictedDates)},beforeShow:function(){u(a)}}),""!=c.buttonImage&&(g(a.selector).datepicker("option","buttonImage",c.buttonImage),g(a.selector).datepicker("option","buttonText",""),g(a.selector).datepicker("option","buttonImageOnly",c.buttonImageOnly),g(a.selector).datepicker("option","showOn","both")),""==g(a.selector).val()&&g(a.selector).val(c.formatDisplay),g(a.selector).attr("autocomplete","off"),""!=g(a.selector).val()&&g(a.selector).val()!=c.formatDisplay&&(g(a.selector).datepicker("setDate",g(a.selector).val()),l(g(a.selector).val(),a),n(g(a.selector).val(),a))}},i=function(e,t,o){var i=e.getFullYear(),a=e.getMonth(),n=e.getDate();if(null!=o&&null!=o){var r=g.datepicker.formatDate("yy-mm-dd",e);if(-1<g.inArray(r,o))return[!1]}for(var s=0;s<c.calendars.length;s++){if(c.calendars[s].selectedDate&&i==c.calendars[s].selectedDate.year&&a==c.calendars[s].selectedDate.month&&n==c.calendars[s].selectedDate.day){var l="";return 1==c.highlightSelectedDates&&(l=1==c.calendars.length?"ptw-only-date ":0==s?"ptw-start-date ":s==c.calendars.length-1?"ptw-end-date ":"ptw-interSelected-date "),[!0,l+"ptw-date-active"]}if(1==c.highlightInterDates&&1<c.calendars.length&&s!=c.calendars.length-1&&c.calendars[s].selectedDate&&c.calendars[s+1].selectedDate&&e>c.calendars[s].selectedDate.date&&e<c.calendars[s+1].selectedDate.date)return[!0,"ptw-date-active"]}return[!0,""]},n=function(e,t,o){if(0==p(e))t.selectedDate=null,g(t.selector).val(c.formatDisplay),g(t.altSelector).val("");else{var i=d(e);t.selectedDate={year:i.getFullYear(),month:i.getMonth(),day:i.getDate()},t.selectedDate.date=i,t.selectedDate.textDate=e}o&&null!=t.restrictedDates&&null!=t.restrictedDates&&-1<g.inArray(o,t.restrictedDates)&&(t.selectedDate=null,g(t.selector).val(c.formatDisplay),g(t.altSelector).val(""))},r=function(e,t){if(null!=e&&""!=e)for(var o=0;o<c.calendars.length;o++)c.calendars[o].index<=t.index||null!=c.calendars[o].selectedDate&&(1==c.allowSameDates&&e>c.calendars[o].selectedDate.date||0==c.allowSameDates&&e>=c.calendars[o].selectedDate.date)&&(c.calendars[o].selectedDate=null,g(c.calendars[o].selector).val(c.formatDisplay),g(c.calendars[o].altSelector).val(""))},s=function(e,t){if(null!=e&&""!=e)for(var o=c.calendars.length-1;0<=o;o--)c.calendars[o].index>=t.index||null!=c.calendars[o].selectedDate&&(1==c.allowSameDates&&e<c.calendars[o].selectedDate.date||0==c.allowSameDates&&e<=c.calendars[o].selectedDate.date)&&(c.calendars[o].selectedDate=null,g(c.calendars[o].selector).val(c.formatDisplay),g(c.calendars[o].altSelector).val(""))},l=function(e,t){var o=d(e);if(null==o)return!1;t.selectedDate={year:o.getFullYear(),month:o.getMonth(),day:o.getDate()},t.selectedDate.date=o,t.selectedDate.textDate=e;var i=t.selectedDate.date;return r(i,t),s(i,t),a&&"function"==typeof a&&a(t.selector,t.selectedDate),!0},u=function(e){if(0<c.calendars.length){var t=m(e.index),o=0<e.index?null!=e.selectedDate?null:t.selectedDate:null;null==o&&(o=t.index<c.calendars.length-1?null!=e.selectedDate?null:e.selectedDate:null),null!=o&&(g(e.selector).val(""),g(e.selector).datepicker("option","defaultDate",new Date(o.date)))}},p=function(e){try{if(""!=e){g.datepicker.parseDate(c.format,e);return!0}return!1}catch(e){return!1}},d=function(e){new Date;return 1==p(e)?g.datepicker.parseDate(c.format,e):null},m=function(e){if(0<c.calendars.length)for(var t=c.calendars[0],o=0;o<c.calendars.length;o++){if(c.calendars[o].index==e)return t;t=c.calendars[o]}return!1},h=function(e){var t=c.calendars.length;if(0<c.calendars.length&&e<t-1)for(var o=c.calendars[t-1],i=t-1;0<=i;i--){if(c.calendars[i].index==e)return o;o=c.calendars[i]}return!1},f=function(e){for(var t=-1,o=0;o<e.length;o++)e[o].index>t&&(t=e[o].index);return t};return{calendars:c.calendars,init:function(){g.datepicker.regional.es=o.es,g.datepicker.regional[c.region]=o[c.region],g.datepicker.setDefaults(g.datepicker.regional[c.region]);for(var e=0;e<c.calendars.length;e++)t(c.calendars[e])},addCalendar:t,validate:function(e){for(var t=new g.Deferred,o=[],i=!0,a=null!=e.optionCode&&""!=e.optionCode,n=0;n<c.calendars.length;n++)c.calendars[n].optionCodes=c.calendars[n].optionCodes||[],(!a||a&&-1!=g.inArray(e.optionCode,c.calendars[n].optionCodes))&&(i=i&&null==c.calendars[n].selectedDate);if(1==e.validateEmpty&&1==i)for(n=0;n<c.calendars.length;n++)(!a||a&&-1!=g.inArray(e.optionCode,c.calendars[n].optionCodes))&&(g(c.calendars[n].selector).addClass(e.errorClass),o.push({key:c.calendars[n].selector,value:c.calendars[n].errors.empty}));else if(0==i)for(n=0;n<c.calendars.length;n++)g(c.calendars[n].selector).removeClass(e.errorClass),(!a||a&&-1!=g.inArray(e.optionCode,c.calendars[n].optionCodes))&&(g(c.calendars[n].selector).removeClass(e.errorClass),null==c.calendars[n].selectedDate&&(g(c.calendars[n].selector).addClass(e.errorClass),o.push({key:c.calendars[n].selector,value:c.calendars[n].errors.empty})));return t.resolve(o),t.promise()},onSelect:function(e){e&&"function"==typeof e&&(a=e)}}}}),define("../Common/getDataValue",["jquery"],function(s){return function(e,t){if(null!=e){var o=s(e).attr("class");if(o){var i=o.split(" ");if(0!=i.length&&(1!=i.length||i[0]))for(var a=0;a<i.length;++a){var n=i[a];if(0===n.indexOf("ap-data_"+t+"-")){var r=n.replace("ap-data_"+t+"-","");return r=r.replace(/{e}/g," ")}}}}}}),define("minors",["jquery","../Common/getDataValue"],function(y,k){return function(e){var p,u,d,t={roomsSelector:"",roomsTemplateSelector:"",roomsContainerSelector:"",roomsTemplateBaseId:"",minorsAgesSelector:"",minorsAgesTemplateSelector:"",minorsAgesContainerBaseSelector:"",minorsAgesTemplateBaseId:"",minorsAgesAltValueBaseSelector:"",minorsAgesContainerBaseId:"",minorsAgesContainerContainerSelector:"",minorsAgesContainerTemplateSelector:"",adultsTemplateBaseId:"",bookerSelector:"",currentMaxRooms:0,loadRooms:!0,loadMinors:!0,manageRoomsClone:void 0,manageMinorsAgesClone:void 0,onUpdatePopover:void 0,errors:{}},m=y.extend({},t,e),h=[],o=function(){1==m.loadRooms&&y(m.roomsSelector).change(function(e){for(var t=parseInt(y(this).val()),o=m.currentMaxRooms>t?m.currentMaxRooms:t,i=0;i<o;i++){var a=g(i);a&&a.RoomIndex<t?a.Status=!0:a&&(a.Status=!1)}m.currentMaxRooms=t,y(m.roomsContainerSelector,m.bookerSelector).hide();for(var n=0;n<t;n++)if(0==y("#"+m.roomsTemplateBaseId+n,m.bookerSelector).length){var r=p.clone();r.find(".ap_collection").each(function(){var e=y(this).attr("name")||"";y(this).attr("name",e.replace("{0}",n))}),null!=m.manageRoomsClone&&m.manageRoomsClone(r,y(m.roomsContainerSelector,m.bookerSelector),n)}y(".ap_roomIndex",m.bookerSelector).attr("style",1<t?"display:":"display:none"),y("."+m.roomsTemplateBaseId,m.bookerSelector).hide(),y("select",y("."+m.roomsTemplateBaseId,m.roomsContainerSelector)).attr("disabled",!0),1==m.loadMinors&&(y("."+m.minorsAgesContainerBaseId,m.bookerSelector).hide(),y("select",y("."+m.minorsAgesTemplateBaseId,m.bookerSelector+" ."+m.minorsAgesContainerBaseId)).attr("disabled",!0));var s=!1,l=!1;for(n=0;n<t;n++){y("#"+m.roomsTemplateBaseId+n,m.bookerSelector).show(),y("select",y("#"+m.roomsTemplateBaseId+n,m.bookerSelector)).attr("disabled",!1);var c=g(n);if(c&&1==c.Status&&0<c.Elements.length){y("#"+m.minorsAgesContainerBaseId+n,m.bookerSelector).show();for(var u=0;u<c.Elements.length;u++)y("select.ap_age",c.Elements[u]).attr("disabled",!1);l=!0}s=!0}1==s&&y(m.roomsContainerSelector,m.bookerSelector).show(),1==l?y(m.minorsAgesContainerContainerSelector,m.bookerSelector).show():y(m.minorsAgesContainerContainerSelector,m.bookerSelector).hide(),v()}).change(),1==m.loadMinors&&(y(m.bookerSelector+" form").delegate(m.minorsAgesSelector,"change",function(e){var t=parseInt(y(this).val()),o=k(this,"room"),i=parseInt(o);if(v(),0==y("#"+m.minorsAgesContainerBaseId+i,m.bookerSelector).length){var a=d.clone();a.find(".ap_index").html(i+1),a.attr("id",m.minorsAgesContainerBaseId+i).addClass(m.minorsAgesContainerBaseId).appendTo(m.minorsAgesContainerContainerSelector)}y("#"+m.minorsAgesContainerBaseId+i,m.bookerSelector).hide();for(var n=0;n<t;n++)if(0==y("#"+m.minorsAgesTemplateBaseId+n+o,m.bookerSelector).length){var r=u.clone();r.find(".ap_collection").each(function(){var e=y(this).attr("name")||"";y(this).attr("name",e.replace("{0}",o).replace("{1}",n))}),null!=m.manageMinorsAgesClone&&m.manageMinorsAgesClone(r,y("#"+m.minorsAgesContainerBaseId+i,m.bookerSelector),o,n)}y("."+m.minorsAgesTemplateBaseId,y(m.minorsAgesContainerBaseSelector+i,m.bookerSelector)).hide(),y("select",y("."+m.minorsAgesTemplateBaseId,m.minorsAgesContainerBaseSelector+i)).attr("disabled",!0);var s=!1,l=[];for(n=0;n<t;n++){var c=y("#"+m.minorsAgesTemplateBaseId+n+o,y(m.minorsAgesContainerBaseSelector+i,m.bookerSelector));c.show(),y("select.ap_age",c).attr("disabled",!1),l.push(c),s=s||i<=m.currentMaxRooms}1==s&&y(m.minorsAgesContainerBaseSelector+i,m.bookerSelector).show(),f(i,s,l),s=!1;for(n=0;n<h.length;n++)if(1==h[n].Status&&0<h[n].Elements.length&&h[n].RoomIndex<=m.currentMaxRooms){s=!0;break}1==s?y(m.minorsAgesContainerContainerSelector,m.bookerSelector).show():y(m.minorsAgesContainerContainerSelector,m.bookerSelector).hide()}),y(m.minorsAgesSelector).trigger("change")),1==m.showMonths&&(y(m.bookerSelector+" form").delegate(m.yearSelector,"change",function(e){var t=parseInt(y(this).val());0==t?(y(this).siblings(".ap_age_month").show(),y(this).siblings(".ap_age_month").children("select").attr("disabled",!1),y(m.monthSelector).trigger("change")):(y(this).siblings(".ap_age_month").hide(),y(this).siblings(".ap_age_month").children("select").attr("disabled",!0)),null!=m.onYearSelect&&m.onYearSelect(this,t)}),y(m.yearSelector).trigger("change"),y(m.bookerSelector+" form").delegate(m.monthSelector,"change",function(e){var t=parseInt(y(this).val());null!=m.onMonthSelect&&m.onMonthSelect(this,t)}),y(m.monthSelector).trigger("change")),y("body").on("change","select."+m.adultsTemplateBaseId,function(e){v()}),y("select."+m.adultsTemplateBaseId).change()},f=function(e,t,o){var i=g(e);null==i?h.push({RoomIndex:e,Status:t,Elements:o}):(i.Status=t,i.Elements=o)},g=function(e){for(var t=0;t<h.length;t++)if(h[t].RoomIndex==e)return h[t];return null},i=function(){for(var e=_(),t=0,o=0,i=[],a=0;a<e.length;a++){NaN!=e[a].adults.value&&(t+=e[a].adults.value),NaN!=e[a].minors.value&&(o+=e[a].minors.value);for(var n=0;n<e[a].minorsAges.length;n++)NaN!=e[a].minorsAges[n].value&&i.push(e[a].minorsAges[n].value)}1==m.calculateTotals&&(y(m.totalAdultsSelector).val(t),y(m.totalMinorsSelector).val(o),y(m.totalMinorsAgesSelector).val(i.join()))},_=function(){for(var e=[],t=1==m.loadRooms?parseInt(y(m.roomsSelector).val()):1,o=1;o<=t&&!(o>m.currentMaxRooms);o++){var i={key:"#"+m.adultsTemplateBaseId+o,value:parseInt(y("#"+m.adultsTemplateBaseId+o,m.bookerSelector).val())},a={};y(m.minorsAgesSelector,m.bookerSelector).each(function(){var e=k(this,"room");parseInt(e)==o&&(a={key:y(this).attr("id"),value:parseInt(y(this).val())})});var n=[];y("."+m.minorsAgesTemplateBaseId,"#"+m.minorsAgesContainerBaseId+o).each(function(e,t){if(e>=a.value)return!1;n.push({key:y(this).attr("id"),value:y("select",t).val()})}),e.push({index:o,adults:i,minors:a,minorsAges:n})}return e},v=function(){if(void 0!==m.onUpdatePopover){var e=parseInt(y(m.roomsSelector).val()),t=0;y(m.roomsContainerSelector+" select."+m.adultsTemplateBaseId).not(":disabled").each(function(){t+=parseInt(y(this).val())}),y(m.roomsContainerSelector+" select"+m.minorsAgesSelector).not(":disabled").each(function(){t+=parseInt(y(this).val())}),m.loadInfants&&y(m.roomsContainerSelector+" select"+m.infantsAgesSelector).not(":disabled").each(function(){t+=parseInt(y(this).val())}),m.onUpdatePopover({numRooms:e,pax:t})}};return{init:function(){p=y(m.roomsTemplateSelector,m.bookerSelector).clone(),u=y(m.minorsAgesTemplateSelector,m.bookerSelector).clone(),d=y(m.minorsAgesContainerTemplateSelector,m.bookerSelector).clone(),o(),i(!1)},validate:function(e){y.extend({maxPassengers:0},m);for(var t=new y.Deferred,o=_(),i=0,a=0,n=[],r=!1,s=[],l=0;l<o.length;l++){NaN!=o[l].adults.value&&(i+=o[l].adults.value),NaN!=o[l].minors.value&&(a+=o[l].minors.value);for(var c=0;c<o[l].minorsAges.length;c++)NaN!=o[l].minorsAges[c].value?n.push(o[l].minorsAges[c].value):r=!0}return r&&s.push({key:"minorAge",value:m.errors.emptyMinorAge}),0<e.maxPassengers&&i+a>e.maxPassengers&&s.push({key:"maxPassengers",value:m.errors.maxPassengers}),t.resolve(s),t.promise()},getSummary:_}}}),define("validation",["jquery"],function(c){return function(){var a=function(e,t){for(var o=0;o<e.length;o++)if(e[o].key==t.key)return o;return-1};return{fill:function(e,t){if(e)for(var o=0;o<e.length;o++)if(1==e[o].createDestinationElement)for(var i=e[o].name,a=c(e[o].origin,t),n=0,r=0;r<a.length;r++)if(0<c(a[r]).closest(e[o].selectorException).length)n++;else{var s=r+(e[o].startIndex||0)-n,l=c('input[name="'+i.replace(/\{0\}/gi,s)+'"]',e[o].destinationContainer);0<l.length?l.val(a[r].value):c("<input>",{type:"hidden",name:i.replace(/\{0\}/gi,s)}).val(a[r].value).appendTo(e[o].destinationContainer)}else c(e[o].destination).val(c(e[o].origin,t).val())},showErrors:function(e,o){var i=[];return c(o).hide().empty(),c.when.apply(c,e).pipe(function(){for(var e=0;e<arguments.length;e++)for(var t=0;t<arguments[e].length;t++)-1==a(i,arguments[e][t])&&(c("<div/>",{html:"*"+arguments[e][t].value}).appendTo(o),i.push(arguments[e][t]));return 0<i.length&&(c(o).show(),c(i[0].key).focus()),0<i.length})}}}}),define("../Common/popover",["jquery"],function(s){return function(e){var n=s.extend({},{ptwTravelersLinkId:"",ptwPopoverCloseId:"",ptwPopoverId:"ptw-fp-popover",attr:"data-id",personText:"persona",peopleText:"personas",roomText:"habitacion",roomsText:"habitaciones",ptwPopoverNumPaxId:"ptw-num-pax",ptwPopoverPaxTextId:"ptw-pax-text",ptwPopoverRoomsId:"ptw-num-rooms",ptwPopoverRoomTextId:"ptw-room-text",useInfantTexts:!1,ptwPopoverInfantTexts:"ptw-infant-text",ptwPopoverInfantContainer:"ptw-infant-text-container",mainPopoverContainerId:"#none",people:0,rooms:0},e),t=(n.people,n.rooms),o=function(){s("html").on("click touchend",function(e){var t=s(e.target);t.closest("#"+n.ptwPopoverId).length||t.closest("#ptw-container-travelers").length||i()}),s("#"+n.ptwTravelersLinkId).bind("click",function(e){r(),e.preventDefault()}),s("#"+n.ptwPopoverCloseId).bind("click",function(){"block"===s("#"+n.ptwPopoverId).css("display")?i():(s("#"+n.ptwPopoverId).css("display","block"),s("#"+n.ptwPopoverCloseId).css("display","block"))})},i=function(){s("#"+n.ptwPopoverId).css("display","none"),s("#"+n.ptwPopoverCloseId).css("display","none")},a=function(){var e=s("#"+n.ptwTravelersLinkId).position().top;s("#"+n.ptwPopoverId).css("display","block");var t=s("#"+n.ptwPopoverId).width(),o=(s("#"+n.ptwPopoverId).height(),s("#"+n.ptwTravelersLinkId).width()),i=s("#"+n.ptwTravelersLinkId).position().left,a=i+o-t;s("#"+n.ptwPopoverId).css("left",a-12),s("#"+n.ptwPopoverId).css("top",e+25),s("#"+n.ptwPopoverCloseId).css("left",i+o-25),s("#"+n.ptwPopoverCloseId).css("top",e+45),s("#"+n.ptwPopoverCloseId).css("display","block")},r=function(){"block"===s("#"+n.ptwPopoverId).css("display")?i():a()};return{init:function(){o()},setOccupaton:function(e){t=e.numRooms,pax=e.pax,t&&(s("#"+n.ptwPopoverRoomsId).html(t),1<t?s("#"+n.ptwPopoverRoomTextId).html(n.roomsText):s("#"+n.ptwPopoverRoomTextId).html(n.roomText)),s("#"+n.ptwPopoverNumPaxId).html(pax),1<pax?s("#"+n.ptwPopoverPaxTextId).html(n.peopleText):s("#"+n.ptwPopoverPaxTextId).html(n.personText)},toggleVisible:a}}}),define("hotelBooker",["jquery","../Common/autocomplete","../Common/calendar","minors","validation","../Common/popover"],function(u,p,d,m,h,f){return function(e){var i,a,o,n=u.extend({},{texts:{},autocomplete:{autocompletes:[]},calendar:{calendars:[]},formMapping:[],prefix:"",maxPassengers:0},e);u(".icon-calendar").click(function(){u(this).siblings(".ui-datepicker-trigger").click()});var r=function(){u(".ap_booker_submit",n.selector).prop("disabled",!1),u("body").delegate(n.selector+" .ap_removeCard","click",function(e){e.preventDefault(),u("#UseSingleHotelQuoteMode").val("False"),u(this).closest(".ap_field").hide(),u(".ptw-field-destination",n.selector).show(),u("#Searchbox_PostUrl",n.selector).val(u("#Searchbox_PostUrl2",n.selector).val()),n.texts.SearchButtonText&&""!=n.texts.SearchButtonText&&u(".ap_booker_submit",n.selector).val(n.texts.SearchButtonText)}),u("body").delegate(".change_destination","change",function(e){e.preventDefault(),u("#UseSingleHotelQuoteMode").val("False"),u("#Searchbox_PostUrl",n.selector).val(u("#Searchbox_PostUrl2",n.selector).val()),n.texts.SearchButtonText&&""!=n.texts.SearchButtonText&&u(".ap_booker_submit",n.selector).val(n.texts.SearchButtonText)})},s=function(e,t,o){e.instance=new p({selector:e.selector,uri:t,createAltField:e.createAltField,isNotAsync:e.isNotAsync,source:o,mapping:function(e){return{label:e.Display,description:"("+e.HotelsCount+" "+(1<e.HotelsCount?n.texts.Hotels:n.texts.Hotel)+")",uri:e.URI,tableName:e.TableName,altValue:e.Id,display:e.Display,country:e.CountryA2}},queryName:"query",data:{compareType:"initial",isNotAsync:e.isNotAsync},errors:e.errors,onSelectCallback:function(e){l(e.item.display,e.item.altValue,e.item.tableName,e.item.uri,e.item.country)}}),e.instance.init().done(function(e){0<e.length&&(e.data("ui-autocomplete")._renderItem=function(e,t){return u("<li>").append('<a><span class="destination">'+t.label+'</span><span class="numHotels">'+t.description+"</span></a>").appendTo(e)})})},l=function(e,t,o,i,a){u("#ap_dest_keywordTable").val(o),u("#ap_dest_uri").val(i)},t=function(){var e=new Array;return e=e.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.fill({revalidateUri:e.revalidateUri,forceRevalidation:0<u("#ap_dest_uri").length&&""==u.trim(u("#ap_dest_uri").val())}).done(function(e,t,o){if(e&&0<e.length){var i=e[0];u(t).val(i.Display),u(o).val(i.Id),u(n.uriComponent).val(i.URI),l(i.Display,i.Id,i.TableName,i.URI,i.CountryA2)}}));return t}(n.autocomplete))},c=function(e){void 0!==o&&o.setOccupaton(e)};return{code:n.code,isActive:n.isActive,init:function(){n.selector="#"+n.prefix+"_"+n.code;for(var e=0;e<n.autocomplete.autocompletes.length;e++)s(n.autocomplete.autocompletes[e],n.autocomplete.uri,n.autocomplete.source);if((i=new d(n.calendar)).init(),n.usePopover){var t=n.servicePrefix;(o=new f({ptwTravelersLinkId:t+"ptw-travelers-link",ptwPopoverCloseId:t+"ptw-popover-close",ptwPopoverId:t+"ptw-fp-popover",attr:"data-id",ptwPopoverRoomsId:t+"ptw-num-rooms",ptwPopoverNumPaxId:t+"ptw-num-pax",ptwPopoverPaxTextId:t+"ptw-pax-text",ptwPopoverRoomTextId:t+"ptw-room-text",personText:n.popoverText.person,peopleText:n.popoverText.people,roomText:n.popoverText.room,roomsText:n.popoverText.rooms})).init()}(a=new m({roomsSelector:"#ap_booker_Hotel_rooms",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_Hotelroom",minorsAgesSelector:".ap_booker_Hotel_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_Hotel_container",minorsAgesTemplateBaseId:"ap_booker_Hotel_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_Hotel_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_Hotel_container",minorsAgesContainerContainerSelector:".ap_booker_Hotel_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_Hotel_adults",totalMinorsAgesSelector:"#ap_booker_hotel_totalMinorsAges",totalMinorsSelector:"#ap_booker_hotel_totalMinors",totalAdultsSelector:"#ap_booker_hotel_totalAdults",calculateTotals:!0,bookerSelector:n.selector,errors:{emptyMinorAge:n.texts.MinorsAgesError},manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_Hotelroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_Hotel_adults").attr("id","ap_booker_Hotel_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_Hotel_minors").attr("id","ap_booker_Hotel_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_Hotel_minorsAges").attr("id","ap_booker_Hotel_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_Hotel_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_HotelRooms_"+o+"__MinorsAges_"+i+"__Years"),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_Hotel_containerTemplate",onUpdatePopover:!0===n.usePopover?c:void 0})).init(),u(n.formMappingForm).attr("action",n.submitUri),r()},fillAndValidate:function(){var e=t();return u.when.apply(u,e).pipe(function(){return 0==n.skipValidation?function(){var t=new h,e=[];(e=e.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t}(n.autocomplete))).push(i.validate({errorClass:"inputError",validateEmpty:!1})),e.push(a.validate({errorClass:"inputError",maxPassengers:n.maxPassengers}));var o=new u.Deferred;return t.showErrors(e,n.errorsSelector).done(function(e){n.formMappingForm&&(t.fill(n.formMapping,n.selector),0==e&&o.resolve()),o.reject()}),o.promise()}():{}})},toggleVisible:0!=n.usePopover?function(){if(null!=o)return o.toggleVisible}:void 0}}}),define("packageBooker",["jquery","../Common/autocomplete","../Common/calendar","minors","validation","../Common/popover"],function(_,v,y,k,b,C){return function(e){var i,a,t,n=_.extend({},{texts:{},autocomplete:{originAutocomplete:[],destinationAutocomplete:[]},calendar:{calendars:[]},keyValueText:[],prefix:"",maxPassengers:0,destinationaAutocompleteSliceSize:15,usePopover:!1,ptwInfantTextsId:"ptw-flight-infant-text",ptwInfantContainerId:"ptw-flight-infant-text-container"},e),r=[];_(".icon-calendar").click(function(){_(this).siblings(".ui-datepicker-trigger").click()});var o=function(e){void 0!==t&&t.setOccupaton(e)},s=function(){_(".ap_booker_submit",n.selector).prop("disabled",!1),_("body").delegate(n.selector+" .ap_removeCard","click",function(e){e.preventDefault(),_("#UseSingleHotelQuoteMode").val("False"),_(this).closest(".ap_field").hide(),_("#Searchbox_PostUrl",n.selector).val(_("#Searchbox_PostUrl2",n.selector).val()),n.texts.SearchButtonText&&""!=n.texts.SearchButtonText&&_(".ap_booker_submit",n.selector).val(n.texts.SearchButtonText)}),_("body").delegate(".change_destination","change",function(e){e.preventDefault(),_("#UseSingleHotelQuoteMode").val("False"),_("#Searchbox_PostUrl",n.selector).val(_("#Searchbox_PostUrl2",n.selector).val()),n.texts.SearchButtonText&&""!=n.texts.SearchButtonText&&_(".ap_booker_submit",n.selector).val(n.texts.SearchButtonText)}),null!=n.hotelCalendar&&g()},l=function(e,t){e.instance=new v({selector:e.selector,uri:t,isNotAsync:e.isNotAsync,mapping:function(e){return{label:e.Name+" ("+e.Code+")",value:e.Name+" ("+e.Code+")",description:e.Description,altValue:e.Code,restrictions:e.Restrictions}},queryName:"query",data:{verifyDestinations:!1,gtOrigin:!0,isNotAsync:e.isNotAsync},errors:e.errors,onSelectCallback:function(e){d(e.item.restrictions)},onClear:function(){if(0<r.length)for(var e=0;e<n.destinationAutocomplete.autocompletes.length;e++)_(n.destinationAutocomplete.autocompletes[e].selector).val(""),_(n.destinationAutocomplete.autocompletes[e].selector).autocomplete("destroy"),_(n.destinationAutocomplete.autocompletes[e].selector).unbind("keyup"),c(n.destinationAutocomplete.autocompletes[e],n.destinationAutocomplete.uri)},sliceSize:null!=e.sliceSize?e.sliceSize:n.destinationaAutocompleteSliceSize}),e.instance.init()},c=function(e,t,o){e.instance=new v({selector:e.selector,uri:t,isNotAsync:e.isNotAsync,source:o,mapping:function(e){return{label:""!=e.Name?e.City:e.Description,description:""!=e.Name?e.Name+" ("+e.Code+")":e.Description,value:e.Description,altValue:e.Code,uri:e.Uri,display:e.City,mappingId:e.MappingId,mappingType:e.MappingType,name:e.Name}},queryName:"query",data:{compareType:"initial",verifyDestinations:!1,restrictions:function(){return r},isNotAsync:e.isNotAsync},errors:e.errors,onSelectCallback:function(e){u(e.item.mappingType,e.item.mappingId,e.item.uri,e.item.display)},sliceSize:null!=e.sliceSize?e.sliceSize:n.destinationaAutocompleteSliceSize}),e.instance.init().done(function(e){0<e.length&&(e.data("ui-autocomplete")._renderItem=function(e,t){return""!=t.name?_("<li>").append("<a><strong>"+t.label+"</strong><br /><span>"+t.description+"</span></a>").appendTo(e):_("<li><a>"+t.description+"</a></li>").appendTo(e)})})},u=function(e,t,o,i){_("#ap_dest_flightPackage_display").val(i),_("#ap_dest_flightPackage_mappingId").val(t),_("#ap_dest_flightPackage_mappingType").val(e),_("#ap_dest_flightPackage_uri").val(o)},p=function(e){var t=[];if(null!=e||null!=e)for(var o=0;o<e.length;o++){var i=e[o],a={label:i.Description,description:i.Description,altValue:i.Code,uri:"",display:i.Description,mappingId:i.MappingId,mappingType:i.MappingType,name:""};t.push(a)}return t},d=function(e){if(null!=e&&null!=e&&0<e.length){r=m(e);for(var t=0;t<n.destinationAutocomplete.autocompletes.length;t++){_(n.destinationAutocomplete.autocompletes[t].selector).autocomplete("destroy"),_(n.destinationAutocomplete.autocompletes[t].selector).unbind("keyup");(function(e,o){_.ajax({url:n.destinationAutocomplete.uri+"?jsoncallback=?",dataType:"jsonp",data:{query:"",compareType:"initial",verifyDestinations:!1,restrictions:function(){return r}},success:function(e){var t=p(e);c(n.destinationAutocomplete.autocompletes[o],n.destinationAutocomplete.uri,t)}})})(0,t)}}},m=function(e){var t=[];if(null!=e||null!=e&&0<e.length)for(var o=0;o<e.length;o++){var i=e[o].AirportCode;-1==_.inArray(i,t)&&t.push(i)}return t},h=function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t},f=function(){var e=new Array;return e=e.concat(function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)!function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];_(i.autocompletes[o].selector).val(t.Name+" ("+t.Code+")"),_(i.autocompletes[o].instance.getAltSelector()).val(t.Code)}}))}(t);return e}(n.originAutocomplete),function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)!function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];_(i.autocompletes[o].selector).val(t.City+" ("+t.Code+")"),_(i.autocompletes[o].instance.getAltSelector()).val(t.Code),u(t.MappingType,t.MappingId,t.Uri,t.City)}}))}(t);return e}(n.destinationAutocomplete))},g=function(){var e=_("#ap_flightPackage_partialStay_hidden"),t=e.val();_("#partialStayCheck").on("click",function(){_("#partialStayContainer").toggleClass("ptw-hide"),t="False"==t?"True":"False",e.val(t)})};return{code:n.code,isActive:n.isActive,init:function(){n.selector="#"+n.prefix+"_"+n.code,n.usePopover&&(t=new C({ptwTravelersLinkId:"ptw-travelers-link",ptwPopoverCloseId:"ptw-popover-close",ptwPopoverId:"ptw-fp-popover",attr:"data-id",ptwPopoverRoomsId:"ptw-num-rooms",personText:n.popoverText.person,peopleText:n.popoverText.people,roomText:n.popoverText.room,roomsText:n.popoverText.rooms,useInfantTexts:!0,ptwPopoverInfantTexts:"ptw-flight-infant-text",ptwPopoverInfantContainer:"ptw-flight-infant-text-container",mainPopoverContainerId:"#"+n.prefix+"_"+n.code})).init(),n.showInfantsText&&_("#ap_booker_FlightPackage ."+n.ptwInfantTextsId).on("click",function(){_("#ap_booker_FlightPackage ."+n.ptwInfantContainerId).toggle()});for(var e=0;e<n.originAutocomplete.autocompletes.length;e++)l(n.originAutocomplete.autocompletes[e],n.originAutocomplete.uri);for(e=0;e<n.destinationAutocomplete.autocompletes.length;e++)c(n.destinationAutocomplete.autocompletes[e],n.destinationAutocomplete.uri);(i=new y(n.calendar)).init(),new y(n.hotelCalendar).init(),(a=new k({roomsSelector:"#ap_booker_FlightPackage_rooms",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_FlightPackageroom",minorsAgesSelector:".ap_booker_FlightPackage_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_FlightPackage_container",minorsAgesTemplateBaseId:"ap_booker_FlightPackage_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_FlightPackage_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_FlightPackage_container",minorsAgesContainerContainerSelector:".ap_booker_FlightPackage_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_FlightPackage_adults",totalMinorsAgesSelector:"#ap_booker_FlightPackage_totalMinorsAges",totalMinorsSelector:"#ap_booker_FlightPackage_totalMinors",totalAdultsSelector:"#ap_booker_FlightPackage_totalAdults",calculateTotals:!0,bookerSelector:n.selector,errors:{maxPassengers:n.texts.MaxPassengers,emptyMinorAge:n.texts.MinorsAgesError},manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_FlightPackageroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_FlightPackage_adults").attr("id","ap_booker_FlightPackage_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_FlightPackage_minors").attr("id","ap_booker_FlightPackage_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_FlightPackage_minorsAges").attr("id","ap_booker_FlightPackage_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find(".Err_Infants").attr("id","Err_HotelRooms_"+o+"__Infants"),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_FlightPackage_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_HotelRooms_"+o+"__MinorsAges_"+i+"__Years"),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_FlightPackage_containerTemplate",onUpdatePopover:!0===n.usePopover?o:void 0})).init(),_(n.formMappingForm).attr("action",n.submitUri),s()},fillAndValidate:function(){var e=f();return _.when.apply(_,e).pipe(function(){var e=_("#Searchbox_IsProductDetail",n.selector);if(0<e.length&&"True"==e.val()){var t=_("#ap_dest_originalReturningAirportCode",n.selector).val(),o=_("#ap_dest_flightPackage_hidden",n.selector).val();void 0!==o&&o!=t&&_("#Searchbox_PostUrl",n.selector).val(_("#Searchbox_PostUrl2",n.selector).val())}return 0==n.skipValidation?function(){var t=b(),e=[];(e=e.concat(h(n.originAutocomplete),h(n.destinationAutocomplete))).push(i.validate({errorClass:"inputError",validateEmpty:!0,optionCode:n.currentTripOptionCode})),e.push(a.validate({errorClass:"inputError",maxPassengers:n.maxPassengers}));var o=new _.Deferred;return t.showErrors(e,n.errorsSelector).done(function(e){n.formMappingForm&&(t.fill(n.formMapping,n.selector),0==e&&o.resolve()),o.reject()}),o.promise()}():{}})},toggleVisible:0!=n.usePopover?function(){if(null!=t)return t.toggleVisible}:void 0}}}),define("flightBooker",["jquery","../Common/autocomplete","../Common/calendar","minors","../Common/getDataValue","validation","../Common/popover"],function(A,S,D,T,M,I,P){return function(e){var n,r,c,u,s,p="MultipleDestinations",d=A.extend({},{departureAutocomplete:{autocompletes:[]},arrivalAutocomplete:{autocompletes:[]},calendar:{calendars:[]},skipValidation:!1,formMapping:[],tripOptions:[],prefix:"",multiDestinationFlightsBase:0,multiDestinationFlights:[],maxPassengers:0,texts:{}},e),l=[];A(".icon-calendar").click(function(){A(this).siblings(".ui-datepicker-trigger").click()});var m=function(e){for(var t=0;t<e.autocompletes.length;t++){h(e.autocompletes[t],e.uri);var o=e.autocompletes[t].flightIndex;if(null!=o){var i=y(d.multiDestinationFlights,o),a=!1;-1==i&&(i={index:o,autocompletes:[],calendars:[]},a=!0),i.autocompletes.push(e.autocompletes[t].instance),1==a&&d.multiDestinationFlights.push(i)}}},h=function(e,t,o){var i=!0;null!=e.isOrigin&&null!=e.isOrigin&&(i=e.isOrigin),e.instance=new S({selector:e.selector,uri:t,isNotAsync:e.isNotAsync,source:o,mapping:function(e){return{label:e.Name+" ("+e.Code+")",value:e.Name+" ("+e.Code+")",altValue:e.Code,country:e.Country,mappingId:e.MappingId,mappingType:e.MappingType,restrictions:e.Restrictions}},data:{query:function(){return A(e.selector).val()},verifyDestinations:!1,restrictions:function(){return l},gtOrigin:i,isNotAsync:e.isNotAsync},errors:e.errors,onSelectCallback:function(e,t){a(t,e.item.country,e.item.mappingId,e.item.mappingType,e.item.restrictions)}}),e.instance.init()},a=function(e,t,o,i,a){if(A(e+"_country").val(t),A(e+"_mappingId").val(o),A(e+"_mappingType").val(i),l=f(a),null!=a&&null!=a&&0<a.length)for(var n=0;n<d.arrivalAutocomplete.autocompletes.length;n++){A(d.arrivalAutocomplete.autocompletes[n].selector).autocomplete("destroy");(function(a){A.ajax({url:d.arrivalAutocomplete.uri+"?jsoncallback=?",dataType:"jsonp",data:{query:"",verifyDestinations:!1,gtOrigin:!0,restrictions:function(){return l}},success:function(e){console.log(e);for(var t=[],o=0;o<e.length;o++){var i={label:e[o].Name+" ("+e[o].Code+")",value:e[o].Name+" ("+e[o].Code+")",altValue:e[o].Code,country:e[o].Country,mappingId:e[o].MappingId,mappingType:e[o].MappingType,restrictions:e[o].Restrictions};t.push(i)}h(d.arrivalAutocomplete.autocompletes[a],d.arrivalAutocomplete.uri,t)}})})(n)}},f=function(e){var t=[];if(null!=e||null!=e&&0<e.length)for(var o=0;o<e.length;o++){var i=e[o].AirportCode;-1==A.inArray(i,t)&&t.push(i)}return t},g=function(e){for(var t=0;t<d.departureAutocomplete.autocompletes.length;t++)if(d.departureAutocomplete.autocompletes[t].selector==e.selector){d.departureAutocomplete.autocompletes.splice(t,1);break}for(t=0;t<d.arrivalAutocomplete.autocompletes.length;t++)if(d.arrivalAutocomplete.autocompletes[t].selector==e.selector){d.arrivalAutocomplete.autocompletes.splice(t,1);break}},_=function(e){for(var t=0;t<c.calendars.length;t++)if(c.calendars[t].selector==e.selector){c.calendars.splice(t,1);break}for(t=0;t<d.calendar.calendars.length;t++)if(d.calendar.calendars[t].selector==e.selector){d.calendar.calendars.splice(t,1);break}},v=function(){A(".ap_flightTitle",d.templateParentSelector).each(function(e){A(this).find("span.ap_fn").html(e+1)})},y=function(e,t){for(var o=0;o<e.length;o++)if(e[o].index==t)return e[o];return-1},k=function(e){e=e&&""!=e?e:d.tripOption[0].code,A(".ap_flightType",d.selector).removeClass("active"),A(".ap-data_tripMode-"+e,d.selector).addClass("active");var t=i(e);d.currentTripOptionCode=t.code,A("."+d.prefix+"_flightType").hide(),A(t.exceptionsSelector,"#"+d.prefix+"_"+t.destinationTypeCode).hide();for(var o=0;o<d.tripOptions.length;o++)d.tripOptions[o].code!=t.code&&A(d.tripOptions[o].exceptionsSelector,"#"+d.prefix+"_"+d.tripOptions[o].destinationTypeCode).show();A("#"+d.prefix+"_"+t.destinationTypeCode).show(),A(d.tripOptionSelector).val(t.code)},i=function(e){for(var t=0;t<d.tripOptions.length;t++)if(d.tripOptions[t].code==e)return d.tripOptions[t];return null},b=function(){A(".ap_booker_submit",d.selector).prop("disabled",!1),A(d.addFlightsButtonSelector,d.selector).click(function(e){e.preventDefault();var o=function(e){for(var t=-1,o=0;o<e.length;o++)e[o].index>t&&(t=e[o].index);return t}(d.multiDestinationFlights)+1,t=u.clone();t.attr("id","ap_booker_multiTemplate"+o),t.find(".ap_flightRemove").attr("class","ap_flightRemove ap-data_flight-"+o),t.find("#ap_flight_index").attr("id","ap_flight_index"+o).val(o),t.find("input.ap_collection").each(function(){var e=A(this).attr("name")||"",t=A(this).attr("id")||"";A(this).attr("name",e.replace("{0}",o)),A(this).attr("id",t.replace("{0}",o))}),t.find(".ptw-errormsg").each(function(){var e=A(this).attr("id")||"";A(this).attr("id",e.replace("{0}",o))}),t.find("label.ap_collection").each(function(){var e=A(this).attr("for")||"";A(this).attr("for",e.replace("{0}",o))}),t.appendTo(d.templateParentSelector);var i=y(d.multiDestinationFlights,o-1),a=[],n=[];a.push({selector:"#ap_origin_multi_flight"+o,optionCodes:[p],errors:i.autocompletes[0].errors}),n.push({selector:"#ap_dest_multi_flight"+o,optionCodes:[p],errors:i.autocompletes[1].errors});var r=[];r.push({selector:"#ap_flight_multi_calendar"+o,optionCodes:[p],errors:i.calendars[0].errors});for(var s={index:o,autocompletes:[],calendars:[]},l=0;l<a.length;l++)h(a[l],d.departureAutocomplete.uri),d.departureAutocomplete.autocompletes.push(a[l]),s.autocompletes.push(a[l]);for(l=0;l<n.length;l++)h(n[l],d.arrivalAutocomplete.uri),d.arrivalAutocomplete.autocompletes.push(n[l]),s.autocompletes.push(n[l]);for(l=0;l<r.length;l++)c.addCalendar(r[l],!0),s.calendars.push(r[l]);d.multiDestinationFlights.push(s),A(".ui-datepicker").each(function(){var e=A(this).attr("id");0==A("#"+e).parent(".pt-customJqueryUi").length&&(0==A(".pt-customJqueryUi").length?A("#"+e).wrap("<div class='pt-customJqueryUi' />"):A(".pt-customJqueryUi").append(A("#"+e)))}),A(".ui-PT-autocomplete").each(function(){var e=A(this).attr("id");0==A("#"+e).parent(".pt-customJqueryUi").length&&(0==A(".pt-customJqueryUi").length?A("#"+e).wrap("<div class='pt-customJqueryUi' />"):A(".pt-customJqueryUi").append(A("#"+e)))}),v()}),A(d.selector).on("click",d.tripOptionsSelector,function(e){var t=M(this,"tripMode");k(t)}),A("#Cabin").val("N"),A("#flight_preferences_toggle").click(function(e){e.preventDefault(),A("#flight_preferences").toggle()}),A(d.selector).on("click",".ap_flightRemove",function(e){e.preventDefault();var t=parseInt(M(this,"flight")),o=y(d.multiDestinationFlights,t);if(-1!=o){for(var i=0;i<o.autocompletes.length;i++)g(o.autocompletes[i]);for(i=0;i<o.calendars.length;i++)_(o.calendars[i]);for(i=0;i<d.multiDestinationFlights.length;i++)d.multiDestinationFlights[i].index==t&&d.multiDestinationFlights.splice(i,1);A("#ap_booker_multiTemplate"+o.index,d.selector).fadeOut(200),A("#ap_booker_multiTemplate"+o.index,d.selector).promise().done(function(){A(this).remove(),v()})}})},t=function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)-1!=A.inArray(d.currentTripOptionCode,i.autocompletes[t].optionCodes)&&function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];A(i.autocompletes[o].selector).val(t.Name+" ("+t.Code+")"),A(i.autocompletes[o].instance.getAltSelector()).val(t.Code)}}))}(t);return e},C=function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)e.autocompletes[o].optionCodes=e.autocompletes[o].optionCodes||[],-1!=A.inArray(d.currentTripOptionCode,e.autocompletes[o].optionCodes)&&t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t},o=function(){var e=new Array;return e=e.concat(t(d.departureAutocomplete),t(d.arrivalAutocomplete))},x=function(){var t=I(),e=[];(e=e.concat(C(d.departureAutocomplete),C(d.arrivalAutocomplete))).push(n.validate({errorClass:"inputError",validateEmpty:!0,optionCode:d.currentTripOptionCode})),d.currentTripOptionCode==p&&e.push(c.validate({errorClass:"inputError",validateEmpty:!0,optionCode:d.currentTripOptionCode})),e.push(r.validate({errorClass:"inputError",maxPassengers:d.maxPassengers}));var o=new A.Deferred;return t.showErrors(e,d.errorsSelector).done(function(e){d.formMappingForm&&(t.fill(d.formMapping,d.selector),0==e&&o.resolve()),o.reject()}),o.promise()},w=function(e){void 0!==s&&s.setOccupaton(e)};return{code:d.code,isActive:d.isActive,init:function(){d.selector="#"+d.prefix+"_"+d.code,u=A(d.templateSelector).clone(),d.currentTripOptionCode=A(d.tripOptionSelector,d.selector).val(),k(d.currentTripOptionCode),m(d.departureAutocomplete),m(d.arrivalAutocomplete),(n=new D(d.calendar)).init(),(c=new D(d.multiDestinationCalendar)).init();for(var e=0;e<c.calendars.length;e++){var t=c.calendars[e].flightIndex;if(null!=t){var o=y(d.multiDestinationFlights,t),i=!1;-1==o&&(o={index:t,autocompletes:[],calendars:[]},i=!0),o.calendars.push(c.calendars[e]),1==i&&d.multiDestinationFlights.push(o)}}if(d.usePopover){var a=d.servicePrefix;(s=new P({ptwTravelersLinkId:a+"ptw-travelers-link",ptwPopoverCloseId:a+"ptw-popover-close",ptwPopoverId:a+"ptw-fp-popover",attr:"data-id",ptwPopoverNumPaxId:a+"ptw-num-pax",ptwPopoverPaxTextId:a+"ptw-pax-text",personText:d.popoverText.person,peopleText:d.popoverText.people,roomText:d.popoverText.room,roomsText:d.popoverText.rooms,useInfantTexts:!0,ptwPopoverInfantTexts:"ptw-flight-infant-text",ptwPopoverInfantContainer:"ptw-flight-infant-text-container",mainPopoverContainerId:"#"+d.prefix+"_"+d.code})).init()}(r=new T({minorsAgesSelector:".ap_booker_flight_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_flight_container",minorsAgesTemplateBaseId:"ap_booker_flight_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_flight_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_flight_container",minorsAgesContainerContainerSelector:".ap_booker_flight_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_flight_adults",bookerSelector:d.selector,currentMaxRooms:1,loadRooms:!1,errors:{maxPassengers:d.texts.MaxPassengers,emptyMinorAge:d.texts.MinorsAgesError},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1);var a=e.find(".ap_age").attr("id");e.find(".ap_age").attr("id",a+o+i),e.find(".Err_MinorsAge").attr("id","Err_MinorsAges_"+i+"__Years"),e.attr("id","ap_booker_flight_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_Flight_containerTemplate",onUpdatePopover:!0===d.usePopover?w:void 0})).init(),b(),A(d.formMappingForm).attr("action",d.submitUri)},getTripOptions:i,fillAndValidate:function(){var e=o();return A.when.apply(A,e).pipe(function(){return 0==d.skipValidation?x():{}})},fill:o,validate:x,toggleVisible:0!=d.usePopover?function(){if(null!=s)return s.toggleVisible}:void 0}}}),define("busPackageBooker",["jquery","../Common/autocomplete","../Common/calendar","minors","validation","../Common/getDataValue","../Common/popover"],function(m,h,f,g,_,v,y){return function(e){var n,r,o,i,l=m.extend({},{texts:{},autocomplete:{autocompletes:[]},calendar:{calendars:[]},text:{},keyValueText:[],prefix:"",maxPassengers:0,originValue:0,destinationValue:0},e);m(".icon-calendar").click(function(){m(this).siblings(".ui-datepicker-trigger").click()});var a=function(){m(".ap_booker_submit",l.selector).prop("disabled",!1),m("body").delegate(l.selector+" .ap_removeCard","click",function(e){e.preventDefault(),m("#UseSingleHotelQuoteMode").val("False"),m(this).closest(".ap_field").hide(),m("#Searchbox_PostUrl",l.selector).val(m("#Searchbox_PostUrl2",l.selector).val()),l.texts.SearchButtonText&&""!=l.texts.SearchButtonText&&m(".ap_booker_submit",l.selector).val(l.texts.SearchButtonText)}),m("body").on("change",".ap_booker_BusPackage_adults",function(){var e=v(this,"room");if(""!=e){var t=parseInt(m(this).val()),o=parseInt(m(".ap_booker_BusPackage_minors.ap-data_room-"+e).val());s(t,o,e)}}),m("body").on("change",".ap_booker_BusPackage_minors",function(){var e=v(this,"room");if(""!=e){var t=parseInt(m(".ap_booker_BusPackage_adults.ap-data_room-"+e).val()),o=parseInt(m(this).val());s(t,o,e)}}),m("#ap_booker_busPackage_rooms").change(function(){o=m(this).val(),m(".ap_discount_BusPackage_container",l.selector+" form").attr("style","display:none"),m("select",m(".ap_discount_BusPackage_container",l.selector+" form")).attr("disabled","disabled");for(var e=0;e<o;e++)m("#ap_discount_BusPackage_container"+e,l.selector+" form").attr("style","display:"),m("select","#ap_discount_BusPackage_container"+e).removeAttr("disabled");m(".ap_booker_BusPackage_adults").trigger("change"),m(".ap_booker_BusPackage_minors").trigger("change")}),m("#ap_booker_busPackage_rooms").trigger("change"),m("body").on("click",".ap_BusPackage_addDiscount",function(e){e.preventDefault(),m(".ap_booker_BusPackage_discountContainer").toggle()})},s=function(e,t,o){if(o=parseInt(o),0==m("#ap_discount_BusPackage_container"+o).length){var i=m("#ap_discount_BusPackage_containerTemplate").clone();i.find(".ap_index").html(o+1),i.attr("id","ap_discount_BusPackage_container"+o),i.appendTo(".ap_booker_BusPackage_discountContainer")}m(".ap_passengerType","#ap_discount_BusPackage_container"+o).attr("style","display:none"),m(".ap_passengerType select","#ap_discount_BusPackage_container"+o).attr("disabled","disabled");for(var a=0;a<e;a++){if(0==m("#ap_passengerType_"+a,"#ap_discount_BusPackage_container"+o).length){var n=m(".ap_passengerType_template",l.selector).clone();n.removeClass("ap_passengerType_template"),n.attr("id","ap_passengerType_"+a),(n=c(n,a,o)).appendTo("#ap_discount_BusPackage_container"+o+" .ap_discount_adults")}m("#ap_passengerType_"+a,"#ap_discount_BusPackage_container"+o).attr("style","display:"),m("#ap_passengerType_"+a+" select","#ap_discount_BusPackage_container"+o).removeAttr("disabled")}for(var r=0;r<t;r++){if(0==m("#ap_passengerTypeMinor_"+r,"#ap_discount_BusPackage_container"+o).length){var s=m(".ap_passengerTypeMinor_template",l.selector).clone();s.removeClass("ap_passengerTypeMinor_template"),s.attr("id","ap_passengerTypeMinor_"+r),(s=c(s,r,o)).appendTo("#ap_discount_BusPackage_container"+o+" .ap_discount_minors")}m("#ap_passengerTypeMinor_"+r,"#ap_discount_BusPackage_container"+o).attr("style","display:"),m("#ap_passengerTypeMinor_"+r+" select","#ap_discount_BusPackage_container"+o).removeAttr("disabled")}},c=function(e,o,i){return e.find(".ap_index").html(o+1),e.find(".ap_collection").each(function(){var e=m(this).attr("name")||"",t=m(this).attr("id")||"";m(this).attr("name",e.replace("{0}",i).replace("{1}",o)),m(this).attr("id",t.replace("_0_",i).replace("_1_",o))}),e},u=function(e,t){e.instance=new h({selector:e.selector,uri:t,mapping:function(e){return{label:e.search,value:e.search,altValue:e.id}},data:{query:function(){return m(e.selector).val()}},errors:e.errors,onSelectCallback:function(e){p(e.item.altValue)}}),e.instance.init()},p=function(e){m.ajax({url:l.destinationDropDownSource+"?jsoncallback=?",dataType:"jsonp",data:{originOfficeId:e}}).done(function(e){m(l.destinationDropDownSelector).empty(),m("<option/>",{value:0,text:l.texts.SelectText}).appendTo(l.destinationDropDownSelector);for(var t=0;t<e.length;t++)m("<option/>",{value:e[t].id,text:e[t].name,selected:e[t].id==l.destinationValue}).appendTo(l.destinationDropDownSelector)})},t=function(){var e=[];return e=e.concat(function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)!function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];m(i.autocompletes[o].selector).val(t.search),m(i.autocompletes[o].instance.getAltSelector()).val(t.id),p(t.id)}}))}(t);return e}(l.autocomplete))},d=function(e){void 0!==i&&i.setOccupaton(e)};return{code:l.code,isActive:l.isActive,init:function(){l.selector="#"+l.prefix+"_"+l.code;for(var e=0;e<l.autocomplete.autocompletes.length;e++)u(l.autocomplete.autocompletes[e],l.autocomplete.uri);if((r=new f(l.calendar)).init(),l.usePopover){var t=l.servicePrefix;(i=new y({ptwTravelersLinkId:t+"ptw-travelers-link",ptwPopoverCloseId:t+"ptw-popover-close",ptwPopoverId:t+"ptw-fp-popover",attr:"data-id",ptwPopoverRoomsId:t+"ptw-num-rooms",ptwPopoverNumPaxId:t+"ptw-num-pax",ptwPopoverPaxTextId:t+"ptw-pax-text",ptwPopoverRoomTextId:t+"ptw-room-text",personText:l.popoverText.person,peopleText:l.popoverText.people,roomText:l.popoverText.room,roomsText:l.popoverText.rooms})).init()}(n=new g({roomsSelector:"#ap_booker_busPackage_rooms",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_BusPackageroom",minorsAgesSelector:".ap_booker_BusPackage_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_BusPackage_container",minorsAgesTemplateBaseId:"ap_booker_BusPackage_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_BusPackage_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_BusPackage_container",minorsAgesContainerContainerSelector:".ap_booker_BusPackage_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_BusPackage_adults",totalMinorsAgesSelector:"#ap_booker_BusPackage_totalMinorsAges",totalMinorsSelector:"#ap_booker_BusPackage_totalMinors",totalAdultsSelector:"#ap_booker_BusPackage_totalAdults",calculateTotals:!0,bookerSelector:l.selector,errors:{emptyMinorAge:l.texts.MinorsAgesError},manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_BusPackageroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_BusPackage_adults").attr("id","ap_booker_BusPackage_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_BusPackage_minors").attr("id","ap_booker_BusPackage_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_BusPackage_minorsAges").attr("id","ap_booker_BusPackage_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_BusPackage_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_HotelRooms_"+o+"__MinorsAges_"+i+"__Years"),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_BusPackage_containerTemplate",onUpdatePopover:!0===l.usePopover?d:void 0})).init(),a(),0!=l.originValue&&p(l.originValue),o=parseInt(m("#ap_booker_busPackage_rooms").val()),m(l.formMappingForm).attr("action",l.submitUri)},fillAndValidate:function(){var e=t();return m.when.apply(m,e).pipe(function(){return 0==l.skipValidation?function(){var e,t,o=_(),i=[];(i=i.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t}(l.autocomplete))).push((e=new m.Deferred,t=[],m(l.destinationDropDownSelector).removeClass("inputError"),0==m(l.destinationDropDownSelector).val()&&(m(l.destinationDropDownSelector).addClass("inputError"),t.push({key:l.destinationDropDownSelector,value:l.texts.DestinationNotSelected})),e.resolve(t),e.promise())),i.push(r.validate({errorClass:"inputError",validateEmpty:!0})),i.push(n.validate({errorClass:"inputError",maxPassengers:l.maxPassengers}));var a=new m.Deferred;return o.showErrors(i,l.errorsSelector).done(function(e){l.formMappingForm&&(o.fill(l.formMapping,l.selector),0==e&&a.resolve()),a.reject()}),a.promise()}():{}})},toggleVisible:0!=l.usePopover?function(){if(null!=i)return i.toggleVisible}:void 0}}}),define("busBooker",["jquery","../Common/calendar","../Common/autocomplete","minors","../Common/getDataValue","validation","../Common/popover"],function(m,h,f,g,_,v,y){return function(e){var n,o,r=m.extend({},{autocomplete:{autocompletes:[]},calendar:{calendars:[]},texts:{},prefix:"",maxPassengers:0,originValue:0,destinationValue:0},e);m(".icon-calendar").click(function(){m(this).siblings(".ui-datepicker-trigger").click()});var i=function(){m(".ap_booker_submit",r.selector).prop("disabled",!1),m("body").on("click",r.tripOptionsSelector,function(e){var t=_(this,"tripMode");a(t)}),m(".ap_booker_Bus_adults").change(function(){var e=parseInt(m(this).val()),t=parseInt(m(".ap_booker_Bus_minors").val());s(e,t)}),m(".ap_booker_Bus_adults").trigger("change"),m(".ap_booker_Bus_minors").change(function(){var e=parseInt(m(".ap_booker_Bus_adults").val()),t=parseInt(m(this).val());s(e,t)}),m(".ap_booker_Bus_minors").trigger("change"),m("body").on("click",".ap_Bus_addDiscount",function(e){e.preventDefault(),m(".ap_booker_Bus_discountContainer").toggle()})},a=function(e){e==e&&""!=e||r.tripOption[0].code,m(".ap_busType",r.selector).removeClass("active"),m(".ap-data_tripMode-"+e,r.selector).addClass("active");var t=c(e);r.currentTripOptionCode=t.code,m("."+r.prefix+"_busType").hide(),m(t.exceptionsSelector,"#"+r.prefix+"_"+t.destinationTypeCode).hide();for(var o=0;o<r.tripOptions.length;o++)r.tripOptions[o].code!=t.code&&m(r.tripOptions[o].exceptionsSelector,"#"+r.prefix+"_"+r.tripOptions[o].destinationTypeCode).show();m("#"+r.prefix+"_"+t.destinationTypeCode).show(),m(r.tripOptionSelector).val(t.code)},s=function(e,t){m(".ap_passengerType",r.selector).attr("style","display:none"),m(".ap_passengerType select",r.selector).attr("disabled","disabled");for(var o=0;o<e;o++){if(0==m("#ap_passengerType_"+o,r.selector).length){var i=m(".ap_passengerType_template",r.selector).clone();i.removeClass("ap_passengerType_template"),i.attr("id","ap_passengerType_"+o),(i=l(i,o)).appendTo(".ap_booker_Bus_discountContainer .ap_discount_adults")}m("#ap_passengerType_"+o,r.selector).attr("style","display:"),m("#ap_passengerType_"+o+" select",r.selector).removeAttr("disabled")}for(var a=0;a<t;a++){if(0==m("#ap_passengerTypeMinor_"+a,r.selector).length){var n=m(".ap_passengerTypeMinor_template",r.selector).clone();n.removeClass("ap_passengerTypeMinor_template"),n.attr("id","ap_passengerTypeMinor_"+a),(n=l(n,a)).appendTo(".ap_booker_Bus_discountContainer .ap_discount_minors")}m("#ap_passengerTypeMinor_"+a,r.selector).attr("style","display:"),m("#ap_passengerTypeMinor_"+a+" select",r.selector).removeAttr("disabled")}},l=function(e,o){return e.find(".ap_index").html(o+1),e.find(".ap_collection").each(function(){var e=m(this).attr("name")||"",t=m(this).attr("id")||"";m(this).attr("name",e.replace("{0}",o)),m(this).attr("id",t.replace("_0_",o))}),e},c=function(e){for(var t=0;t<r.tripOptions.length;t++)if(r.tripOptions[t].code==e)return r.tripOptions[t];return null},u=function(e,t){e.instance=new f({selector:e.selector,uri:t,mapping:function(e){return{label:e.search,value:e.search,altValue:e.id}},data:{query:function(){return m(e.selector).val()}},errors:e.errors,onSelectCallback:function(e){p(e.item.altValue)}}),e.instance.init()},p=function(e){m.ajax({url:r.destinationDropDownSource+"?jsoncallback=?",dataType:"jsonp",data:{originOfficeId:e}}).done(function(e){m(r.destinationDropDownSelector).empty(),m("<option/>",{value:0,text:r.texts.SelectText}).appendTo(r.destinationDropDownSelector);for(var t=0;t<e.length;t++)m("<option/>",{value:e[t].id,text:e[t].name,selected:e[t].id==r.destinationValue}).appendTo(r.destinationDropDownSelector)})},t=function(){var e=[];return e=e.concat(function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)!function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];m(i.autocompletes[o].selector).val(t.search),m(i.autocompletes[o].instance.getAltSelector()).val(t.id),p(t.id)}}))}(t);return e}(r.autocomplete))},d=function(e){void 0!==o&&o.setOccupaton(e)};return{code:r.code,isActive:r.isActive,init:function(){r.selector="#"+r.prefix+"_"+r.code;for(var e=0;e<r.autocomplete.autocompletes.length;e++)u(r.autocomplete.autocompletes[e],r.autocomplete.uri);if(new h(r.calendar).init(),r.usePopover){var t=r.servicePrefix;(o=new y({ptwTravelersLinkId:t+"ptw-travelers-link",ptwPopoverCloseId:t+"ptw-popover-close",ptwPopoverId:t+"ptw-fp-popover",attr:"data-id",ptwPopoverNumPaxId:t+"ptw-num-pax",ptwPopoverPaxTextId:t+"ptw-pax-text",personText:r.popoverText.person,peopleText:r.popoverText.people,roomText:r.popoverText.room,roomsText:r.popoverText.rooms})).init()}(n=new g({minorsAgesSelector:".ap_booker_Bus_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_Bus_container",minorsAgesTemplateBaseId:"ap_booker_Bus_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_Bus_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_Bus_container",minorsAgesContainerContainerSelector:".ap_booker_Bus_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_Bus_adults",bookerSelector:r.selector,currentMaxRooms:1,loadRooms:!1,errors:{emptyMinorAge:r.texts.MinorsAgesError},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.find(".Err_MinorsAge").attr("id","Err_MinorsAges_"+i+"__Years"),e.attr("id","ap_booker_Bus_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_Bus_containerTemplate",onUpdatePopover:!0===r.usePopover?d:void 0})).init(),i(),a(r.currentTripOptionCode),0!=r.originValue&&p(r.originValue),m(r.formMappingForm).attr("action",r.submitUri)},fillAndValidate:function(){var e=t();return m.when.apply(m,e).pipe(function(){return 0==r.skipValidation?function(){var e,t,o=v(),i=[];(i=i.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t}(r.autocomplete))).push((e=new m.Deferred,t=[],m(r.destinationDropDownSelector).removeClass("inputError"),0==m(r.destinationDropDownSelector).val()&&(m(r.destinationDropDownSelector).addClass("inputError"),t.push({key:r.destinationDropDownSelector,value:r.texts.DestinationNotSelected})),e.resolve(t),e.promise())),i.push(calendars.validate({errorClass:"inputError",validateEmpty:!0})),i.push(n.validate({errorClass:"inputError",maxPassengers:r.maxPassengers}));var a=new m.Deferred;return o.showErrors(i,r.errorsSelector).done(function(e){r.formMappingForm&&(o.fill(r.formMapping,r.selector),0==e&&a.resolve()),a.reject()}),a.promise()}():{}})},toggleVisible:0!=r.usePopover?function(){if(null!=o)return o.toggleVisible}:void 0}}}),define("carBooker",["jquery","../Common/autocomplete","../Common/calendar","validation"],function(u,p,d,m){return function(e){var n,r=u.extend({},{calendar:{calendars:[]},autocomplete:{autocompletes:[]},startOfficeProvId:0,startOfficeType:0,isAffiliateBooker:!1},e);u(".icon-calendar").click(function(){u(this).siblings(".ui-datepicker-trigger").click()});var i=function(t,o){t.altSelector=t.selector+"_hidden",u.ajax({url:o+"?jsoncallback=?",dataType:"jsonp",data:{query:"",matchQuery:!0},success:function(e){e.length<16?(u(t.selector).autocomplete("destroy"),a(t,o,!0,void 0)):(u(t.selector).autocomplete("destroy"),a(t,o,!1,void 0))}})},t=function(e){r.currentTripOptionCode=e;for(var t=0;t<r.tripOptions.length;t++)r.tripOptions[t].code!=e&&u(r.tripOptions[t].exceptionsSelector,"#"+r.prefix+"_"+r.tripOptions[t].destinationTypeCode).hide();for(t=0;t<r.tripOptions.length;t++)r.tripOptions[t].code==e&&u(r.tripOptions[t].exceptionsSelector,"#"+r.prefix+"_"+r.tripOptions[t].destinationTypeCode).show()},o=function(){u(".ap_booker_submit",r.selector).prop("disabled",!1),u("body").on("change",r.tripOptionsSelector,function(){"True"==this.value?t("1"):t("2")})},a=function(e,t,o,i){var a,n;n={query:function(){return u(e.selector).val()}},"#ap_carEnd_office"==(a=e).selector&&(n.provId=function(){return r.startOfficeProvId},n.type=function(){return r.startOfficeType}),e.instance=new p({selector:e.selector,uri:t,isNotAsync:o,source:i,mapping:function(e){return{label:e.name,value:e.name,altValue:e.id,ExternalId:e.provId,type:e.type}},data:n,errors:e.errors,onSelectCallback:function(e){s(a,e.item.ExternalId,e.item.type)}}),e.instance.init()},s=function(e,t,o){"#ap_carStart_office"==e.selector&&(r.startOfficeProvId=t,r.startOfficeType=o,u(r.autocomplete.autocompletes[1].selector).val(""),r.isAffiliateBooker&&i(r.autocomplete.autocompletes[1],r.autocomplete.uri)),u(e.selectorEId).val(t),u(e.selectorType).val(o)},l=function(){var e=[];return e=e.concat(function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)-1!=u.inArray(r.currentTripOptionCode,i.autocompletes[t].optionCodes)&&function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];u(i.autocompletes[o].selector).val(t.name),u(i.autocompletes[o].instance.getAltSelector()).val(t.id),s(i.autocompletes[o],t.provId,t.type)}}))}(t);return e}(r.autocomplete))},c=function(){var e,t,o=m(),i=[];(i=i.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)-1!=u.inArray(r.currentTripOptionCode,e.autocompletes[o].optionCodes)&&t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t}(r.autocomplete))).push(n.validate({errorClass:"inputError",validateEmpty:!0})),i.push((e=new u.Deferred,t=[],u(r.pickUpTimeSelector).removeClass("inputError"),u(r.dropOffTimeSelector).removeClass("inputError"),""==u(r.pickUpTimeSelector).val()&&(u(r.pickUpTimeSelector).addClass("inputError"),t.push({key:r.pickUpTimeSelector,value:r.texts.PickUpTimeNotSelected})),""==u(r.dropOffTimeSelector).val()&&(u(r.dropOffTimeSelector).addClass("inputError"),t.push({key:r.dropOffTimeSelector,value:r.texts.DropOffTimeNotSelected})),e.resolve(t),e.promise()));var a=new u.Deferred;return o.showErrors(i,r.errorsSelector).done(function(e){r.formMappingForm&&0==e&&a.resolve(),a.reject()}),a.promise()};return{code:r.code,isActive:r.isActive,init:function(){r.selector="#"+r.prefix+"_"+r.code;for(var e=0;e<r.autocomplete.autocompletes.length;e++)r.autocomplete.autocompletes[e].altSelector=r.autocomplete.autocompletes[e].selector+"_hidden",a(r.autocomplete.autocompletes[e],r.autocomplete.uri);r.isAffiliateBooker&&i(r.autocomplete.autocompletes[0],r.autocomplete.uri),(n=new d(r.calendar)).init(),o(),t(r.currentTripOptionCode),u(r.formMappingForm).attr("action",r.submitUri)},fillAndValidate:function(){var e=l();return u.when.apply(u,e).pipe(function(){return 0==r.skipValidation?c():{}})}}}}),define("transferBooker",["jquery","../Common/autocomplete","../Common/calendar","validation"],function(s,l,c,u){return function(e){var n,r=s.extend({},{calendar:{calendars:[]},autocomplete:{autocompletes:[]},formMapping:[],prefix:"",texts:{}},e);s(".icon-calendar").click(function(){s(this).siblings(".ui-datepicker-trigger").click()});var t=function(){s(".ap_booker_submit",r.selector).prop("disabled",!1),s(r.tripOptionsSelector).change(function(){!function(e){r.currentTripOptionCode=e;for(var t=0;t<r.tripOptions.length;t++)r.tripOptions[t].code!=e&&s(r.tripOptions[t].exceptionsSelector,"#"+r.prefix+"_"+r.tripOptions[t].destinationTypeCode).hide();for(t=0;t<r.tripOptions.length;t++)r.tripOptions[t].code==e&&s(r.tripOptions[t].exceptionsSelector,"#"+r.prefix+"_"+r.tripOptions[t].destinationTypeCode).show()}(s(this).val())}).change(),s(r.airportIdSelector).change(function(){if(s(r.airportKeywordSelector).val(s(r.airportIdSelector+" option:selected").text()),s(r.airportCode).val(s(r.airportIdSelector).find(":selected").attr("data-airportcode")),r.isAffiliateTransfer)e=s(r.airportIdSelector).val(),s.ajax({url:r.autocomplete.uri+"?jsoncallback=?",dataType:"jsonp",data:{query:"",airportId:e},success:function(e){if(e.length<11)for(var t=0;t<r.autocomplete.autocompletes.length;t++)s(r.autocomplete.autocompletes[t].selector).autocomplete("destroy"),r.autocomplete.autocompletes[t].altSelector=r.autocomplete.autocompletes[t].selector+"_hidden",i(r.autocomplete.autocompletes[t],r.autocomplete.uri,void 0);else for(t=0;t<r.autocomplete.autocompletes.length;t++)s(r.autocomplete.autocompletes[t].selector).autocomplete("destroy"),r.autocomplete.autocompletes[t].altSelector=r.autocomplete.autocompletes[t].selector+"_hidden",o(r.autocomplete.autocompletes[t],r.autocomplete.uri)}});for(var e,t=0;t<r.autocomplete.autocompletes.length;t++)s(r.autocomplete.autocompletes[t].selector).val(""),s(r.autocomplete.autocompletes[t].altSelector).val("")})},o=function(e,t){e.instance=new l({selector:e.selector,altSelector:e.altselector,uri:t,mapping:function(e){return{label:e.display,value:e.display,altValue:e.id}},data:{query:function(){return s(e.selector).val()},type:r.placeTypeId,airportId:function(){return s(r.airportIdSelector).val()},airportCode:function(){return s(r.airportCode).val()}},errors:e.errors}),e.instance.init()},i=function(e,t,o){e.instance=new l({selector:e.selector,altSelector:e.altselector,uri:t,isNotAsync:!0,source:o,mapping:function(e){return{label:e.display,value:e.display,altValue:e.id}},data:{query:function(){return s(e.selector).val()},type:r.placeTypeId,airportId:function(){return s(r.airportIdSelector).val()},airportCode:function(){return s(r.airportCode).val()}},errors:e.errors}),e.instance.init()},a=function(){var e=[];return e=e.concat(function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)-1!=s.inArray(r.currentTripOptionCode,i.autocompletes[t].optionCodes)&&function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];s(i.autocompletes[o].selector).val(t.display),s(i.autocompletes[o].instance.getAltSelector()).val(t.id)}}))}(t);return e}(r.autocomplete))};return{code:r.code,init:function(){r.selector="#"+r.prefix+"_"+r.code;for(var e=0;e<r.autocomplete.autocompletes.length;e++)r.autocomplete.autocompletes[e].altSelector=r.autocomplete.autocompletes[e].selector+"_hidden",o(r.autocomplete.autocompletes[e],r.autocomplete.uri);(n=new c(r.calendar)).init(),t(),s(r.formMappingForm).attr("action",r.submitUri)},isActive:r.isActive,fillAndValidate:function(){var e=a();return s.when.apply(s,e).pipe(function(){return 0==r.skipValidation?function(){var e,t,o=new u,i=[];(i=i.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t}(r.autocomplete))).push((e=new s.Deferred,t=[],s(r.airportIdSelector).removeClass("inputError"),0==s(r.airportIdSelector).val()&&(s(r.airportIdSelector).addClass("inputError"),t.push({key:r.airportIdSelector,value:r.texts.DestinationNotSelected})),e.resolve(t),e.promise())),i.push(n.validate({errorClass:"inputError",validateEmpty:!0,optionCode:r.currentTripOptionCode}));var a=new s.Deferred;return o.showErrors(i,r.errorsSelector).done(function(e){r.formMappingForm&&0==e&&a.resolve(),a.reject()}),a.promise()}():{}})}}}}),define("tourBooker",["jquery","../Common/autocomplete","validation"],function(r,s,l){return function(e){var i=r.extend({},{autocomplete:{autocompletes:[]}},e),t=function(e,t){e.instance=new s({selector:e.selector,uri:t,mapping:function(e){return{label:e.displayName,value:e.displayName,altValue:e.keywordDestinationId,uri:n(null!=e.Keyword?e.Keyword:e.displayName),tourId:e.tourId,display:e.DisplayNameHtml,placeItemDescription:e.PlaceTypeString,description:""}},isNotAsync:e.isNotAsync,queryName:"query",data:{compareType:"initial"},errors:{},onSelectCallback:function(e){a(e.item.uri,e.item.tourId)}}),e.instance.init().done(function(e){0<e.length&&(e.data("ui-autocomplete")._renderMenu=function(o,e){var i=this;r(o).addClass("ptw-resultPrediction"),r.each(e,function(e,t){i._renderItemData(o,t)})},e.data("ui-autocomplete")._renderItem=function(e,t){var o=t.placeItemDescription.charAt(0).toLowerCase()+t.placeItemDescription.slice(1);return r("<li>").append('<a><span class="name">'+t.display.replace(/ /g,"&nbsp;")+'</span><span class="places-itemCount">'+t.description.replace(/ /g,"&nbsp;")+"</span></a>").addClass("first ptw-icon-places-"+o).appendTo(e)})}),e.instance.init(),r(i.formMappingForm).attr("action",i.submitUri)},a=function(e,t){r(i.uriComponent).val(e),null!=t&&r(i.tourIdComponent).val(t)},o=function(){var e=new Array;return e=e.concat(function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)!function(o){e.push(i.autocompletes[t].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];r(i.autocompletes[o].selector).val(t.displayName),r(i.autocompletes[o].instance.getAltSelector()).val(t.keywordDestinationId),a(n(null!=t.Keyword?t.Keyword:t.displayName))}}))}(t);return e}(i.autocomplete))},n=function(e){return e.replace(/ñ/gi,"n").replace(/Ñ/gi,"N").replace(/ \/ /gi,"-").replace(/ & /gi,"-").replace(",","").replace(/á/gi,"a").replace(/é/gi,"e").replace(/í/gi,"i").replace(/ó/gi,"o").replace(/ú/gi,"u").replace(/Á/gi,"A").replace(/É/gi,"E").replace(/Í/gi,"I").replace(/Ó/gi,"O").replace(/Ú/gi,"U").toLowerCase().replace(/-/gi,"_").replace(/ /gi,"-").replace(/_/gi,"-").replace(/\(/gi,"").replace(/\)/gi,"")};return{code:i.code,isActive:i.isActive,fillAndValidate:function(){var e=o();return r.when.apply(r,e).pipe(function(){return 0==i.skipValidation?function(){var t=l(),e=[];e=e.concat(function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t}(i.autocomplete));var o=new r.Deferred;return t.showErrors(e,i.errorsSelector).done(function(e){i.formMappingForm&&(t.fill(i.formMapping,i.selector),0==e&&o.resolve()),o.reject()}),o.promise()}():{}})},init:function(){for(var e=0;e<i.autocomplete.autocompletes.length;e++)t(i.autocomplete.autocompletes[e],i.autocomplete.uri)}}}}),define("../Common/overlay",["jquery"],function(c){return function(l){c(l.context).each(function(){var t=c(this),o=c(l.toggledSelector,t),i=c(o[0]).is("visible");function a(){c.isFunction(l.onClosing)&&!1===l.onClosing()||(o.hide(),c("body").unbind("click",n),i=!1,c.isFunction(l.onClose)&&l.onClose({context:t}))}function n(e){r?r=!1:a()}var r=!1;function s(e){i=!0,c.isFunction(l.onOpen)&&l.onOpen({context:t,item:e}),setTimeout(function(){c("body").click(n)},0)}o.click(function(){i&&(r=!0)}),o.delegate(l.closerSelector,"click",function(){if(c.isFunction(l.onCloserClicking)&&!1===l.onCloserClicking.call(this,{context:t,eventArgs:arguments}))return;r=!1,a()}),c(t).delegate(l.togglerSelector,"click",function(e){e.preventDefault(),c(o[0]).is(":visible")||(o.show(),s(this))}),i&&s()})}}),define("../Common/monthCalendar",["jquery","../Common/getDataValue","../Common/overlay"],function(k,m,t){return function(f){var e=f.contextSelector;function s(e){return parseInt(k(".ap_calYear_UI",e).val())}function i(e){return parseInt(k(".ap_calMonth",e).val())}function a(e){return parseInt(k(".ap_calYear",e).val())}function g(e){return"true"==k(".ap_calIsSet",e).val().toLowerCase()}function l(e,t){k(".ap_calIsSet",e).val(t)}function _(e){var t=a(e),o=i(e);return new Date(t,o-1,1)}function o(e){return _(e).getTime()}function n(e,t){k(".ap_calSelDisplay",e).html(t)}function c(e){d(e,s(e))}function r(e){return{selectedYear:a(e),selectedMonth:i(e),selectedDate:_(e),selectedTime:o(e)}}function u(e){if(k.isFunction(f.onSelecting)){var t=r(e);f.onSelecting(t)}}function p(e,t,o){if(n(e,f.monthNames[o]+" "+t),k.isFunction(f.onSelect)){var i=r(e);f.onSelect(i)}}var v=[];this.months=v;var y=[];function d(e,t){k(".ap_calYear_UI",e).val(t),k(".ap_calYearDisplay",e).html(t);var o,i,a=_(e);k(".ap_calSel",e).removeClass("previous ap_calSelActive today selected");for(var n=0;n<12;++n){var r=new Date(t,n,1),s=[],l=(void 0,o=f.todayYear,i=f.todayMonth,new Date(o,i-1,1)),c=r.getTime()<l.getTime();s.push(c?"previous":"ap_calSelActive"),r.getTime()==l.getTime()&&s.push("today");for(var u=!1,p=k.inArray(e[0],y),d=v[p]._auxiliarMonths,m=0;m<d.length;++m)if(d[m].getTime()==r.getTime()){u=!0;break}var h=g(e);(u||h&&r.getTime()==a.getTime())&&s.push("selected"),s=s.join(" "),k(".ap-data_m-"+(n+1),e).addClass(s)}}k(e).each(function(){y.push(this);var t=k(this);v.push({getSelectedYear:function(){return a(t)},getSelectedMonth:function(){return i(t)},getSelectedDate:function(){return _(t)},getSelectedTime:function(){return o(t)},getSelectedIsSet:function(){return g(t)},reset:function(){return k(".ap_calSel",e=t).removeClass("selected"),l(e,!1),void n(e,f.resetText);var e},resetUi:function(){return c(t)},setUiYear:function(e){d(t,e)},_auxiliarMonths:[],addAuxiliarMonth:function(e){this._auxiliarMonths.push(e)},removeAuxiliarMonth:function(e){for(var t=[],o=0;o<this._auxiliarMonths.length;++o)this._auxiliarMonths[o].getTime()!=e.getTime()&&t.push(this._auxiliarMonths[o]);this._auxiliarMonths=t}})}),t({context:e,togglerSelector:".ap_calToggler",toggledSelector:".ap_calToggled",closerSelector:".ap_calSel",onCloserClicking:function(e){var t=k(this);if(!t.hasClass("ap_calSelActive"))return!1;var o=parseInt(m(t,"m")),i=e.context;u(i);var a,n,r=s(i);l(i,!0),a=o,k(".ap_calMonth",i).val(a),n=r,k(".ap_calYear",i).val(n),p(i,r,o),c(i)},onOpen:function(e){var t=e.context,o=k(".ap_calToggler",t),i=o.attr("title");i&&(o.attr("title",""),o.attr("data-htitle",i))},onClose:function(e){var t=e.context,o=k(".ap_calToggler",t),i=o.attr("data-htitle");i&&(o.attr("data-htitle",""),o.attr("title",i))}}),k(e).each(function(){var t=k(this);if(k(".ap_calNext",t).click(function(){var e=s(t);d(t,++e)}),k(".ap_calPrev",t).click(function(){var e=s(t);d(t,--e)}),g(t)){u(t);var e=a(t),o=i(t);p(t,e,o)}})}}),define("cruiseBooker",["jquery","../Common/monthCalendar","minors","../Common/popover"],function(l,c,u,p){return function(e){var i,a=e,n=function(e,t){l.each(t.months,function(){this.removeAuxiliarMonth(e.selectedDate)})},r=function(t,o,e,i){var a,n;l.each(e.months,function(){if(this.setUiYear(o.months[0].getSelectedYear()),this.getSelectedIsSet()&&i(t.selectedTime,this.getSelectedTime())){for(var e=0;e<o.months.length;++e){o.months[e].removeAuxiliarMonth(this.getSelectedDate())}this.reset()}}),a=e,n=t.selectedDate,l.each(a.months,function(){this.addAuxiliarMonth(n),this.resetUi()})},s=function(e){void 0!==i&&i.setOccupaton(e)};return{code:a.code,isActive:a.isActive,init:function(){var t;a.selector="#"+a.prefix+"_"+a.code;var o=new c({todayYear:a.todayYear,todayMonth:a.todayMonth,monthNames:a.monthNames,resetText:a.monthResetText,contextSelector:l(".ap_monthCalendarStart",a.selector),onSelecting:function(e){t&&n(e,t)},onSelect:function(e){t&&r(e,o,t,function(e,t){return t<e})}});if(t=new c({todayYear:a.todayYear,todayMonth:a.todayMonth,monthNames:a.monthNames,resetText:a.monthResetText,contextSelector:l(".ap_monthCalendarEnd",a.selector),onSelecting:function(e){t&&n(e,o)},onSelect:function(e){t&&r(e,t,o,function(e,t){return e<t})}}),a.usePopover){var e=a.servicePrefix;(i=new p({ptwTravelersLinkId:e+"ptw-travelers-link",ptwPopoverCloseId:e+"ptw-popover-close",ptwPopoverId:e+"ptw-fp-popover",attr:"data-id",ptwPopoverRoomsId:e+"ptw-num-rooms",ptwPopoverNumPaxId:e+"ptw-num-pax",ptwPopoverPaxTextId:e+"ptw-pax-text",ptwPopoverRoomTextId:e+"ptw-room-text",personText:a.popoverText.person,peopleText:a.popoverText.people,roomText:a.popoverText.room,roomsText:a.popoverText.rooms})).init()}new u({roomsSelector:"#ap_booker_Cruise_cabins",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_Cruiseroom",minorsAgesSelector:".ap_booker_Cruise_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_Cruise_container",minorsAgesTemplateBaseId:"ap_booker_Cruise_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_Cruise_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_Cruise_container",minorsAgesContainerContainerSelector:".ap_booker_Cruise_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_Cruise_adults",yearSelector:".ap_Cruise_year",monthSelector:".ap_Cruise_month",bookerSelector:a.selector,showMonths:!0,manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_Cruiseroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_Cruise_adults").attr("id","ap_booker_Cruise_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_Cruise_minors").attr("id","ap_booker_Cruise_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_Cruise_minorsAges").attr("id","ap_booker_Cruise_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_Cruise_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_Cabins_"+o+"__MinorsAges_"+i+"__Years"),e.find(".Err_MinorsAgeMonths").attr("id","Err_Cabins_"+o+"__MinorsAges_"+i+"__Months"),e.appendTo(t)},onMonthSelect:function(e,t){0<=t?t<a.minMonthValue?(l(e).parent().siblings(a.minAgeErrorSelector).show(),l(e).parent().siblings(a.minAgeWarningSelector).hide()):(l(e).parent().siblings(a.minAgeWarningSelector).show(),l(e).parent().siblings(a.minAgeErrorSelector).hide()):(l(e).parent().siblings(a.minAgeErrorSelector).hide(),l(e).parent().siblings(a.minAgeWarningSelector).hide())},onYearSelect:function(e,t){0<t&&(l(e).siblings(a.minAgeWarningSelector).hide(),l(e).siblings(a.minAgeErrorSelector).hide())},minorsAgesContainerTemplateSelector:"#ap_minorsAges_Cruise_containerTemplate",onUpdatePopover:!0===a.usePopover?s:void 0}).init(),l(a.formMappingForm).attr("action",a.submitUri),l(".ap_booker_submit",a.selector).prop("disabled",!1)},fillAndValidate:function(){if(0==a.skipValidation)return validate();var e=new l.Deferred;return e.resolve(),e.promise()},toggleVisible:0!=a.usePopover?function(){if(null!=i)return i.toggleVisible}:void 0}}}),define("circuitBooker",["jquery","../Common/monthCalendar","minors","../Common/popover"],function(l,c,u,p){return function(e){var i,a=e,n=function(e){void 0!==i&&i.setOccupaton(e)},r=function(e,t){l.each(t.months,function(){this.removeAuxiliarMonth(e.selectedDate)})},s=function(t,o,e,i){var a,n;l.each(e.months,function(){if(this.setUiYear(o.months[0].getSelectedYear()),this.getSelectedIsSet()&&i(t.selectedTime,this.getSelectedTime())){for(var e=0;e<o.months.length;++e){o.months[e].removeAuxiliarMonth(this.getSelectedDate())}this.reset()}}),a=e,n=t.selectedDate,l.each(a.months,function(){this.addAuxiliarMonth(n),this.resetUi()})};n=function(e){void 0!==i&&i.setOccupaton(e)};return{code:a.code,isActive:a.isActive,init:function(){var t;a.selector="#"+a.prefix+"_"+a.code;var o=new c({todayYear:a.todayYear,todayMonth:a.todayMonth,monthNames:a.monthNames,resetText:a.monthResetText,contextSelector:l(".ap_monthCalendarStart",a.selector),onSelecting:function(e){t&&r(e,t)},onSelect:function(e){t&&s(e,o,t,function(e,t){return t<e})}});if(t=new c({todayYear:a.todayYear,todayMonth:a.todayMonth,monthNames:a.monthNames,resetText:a.monthResetText,contextSelector:l(".ap_monthCalendarEnd",a.selector),onSelecting:function(e){t&&r(e,o)},onSelect:function(e){t&&s(e,t,o,function(e,t){return e<t})}}),a.usePopover){var e=a.servicePrefix;(i=new p({ptwTravelersLinkId:e+"ptw-travelers-link",ptwPopoverCloseId:e+"ptw-popover-close",ptwPopoverId:e+"ptw-fp-popover",attr:"data-id",ptwPopoverRoomsId:e+"ptw-num-rooms",ptwPopoverNumPaxId:e+"ptw-num-pax",ptwPopoverPaxTextId:e+"ptw-pax-text",ptwPopoverRoomTextId:e+"ptw-room-text",personText:a.popoverText.person,peopleText:a.popoverText.people,roomText:a.popoverText.room,roomsText:a.popoverText.rooms})).init()}new u({roomsSelector:"#ap_booker_Circuit_rooms",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_Circuitroom",minorsAgesSelector:".ap_booker_Circuit_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_Circuit_container",minorsAgesTemplateBaseId:"ap_booker_Circuit_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_Circuit_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_Circuit_container",minorsAgesContainerContainerSelector:".ap_booker_Circuit_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_Circuit_adults",yearSelector:".ap_Circuit_year",monthSelector:".ap_Circuit_month",bookerSelector:a.selector,manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_Circuitroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_Circuit_adults").attr("id","ap_booker_Circuit_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_Circuit_minors").attr("id","ap_booker_Circuit_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_Circuit_minorsAges").attr("id","ap_booker_Circuit_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_Circuit_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_Rooms_"+o+"__MinorsAges_"+i+"__Years"),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_Circuit_containerTemplate",onUpdatePopover:!0===a.usePopover?n:void 0}).init(),l(a.formMappingForm).attr("action",a.submitUri),l(".ap_booker_submit",a.selector).prop("disabled",!1)},fillAndValidate:function(){if(0==a.skipValidation)return validate();var e=new l.Deferred;return e.resolve(),e.promise()},toggleVisible:0!=a.usePopover?function(){if(null!=i)return i.toggleVisible}:void 0}}}),define("../Common/toDictionary",["jquery"],function(e){!function(r){!1===r.isFunction(String.prototype.format)&&(String.prototype.format=function(){for(var e=this,t=arguments.length;t--;)e=e.replace(new RegExp("\\{"+t+"\\}","gim"),arguments[t]);return e}),!1===r.isFunction(Date.prototype.toISOString)&&(Date.prototype.toISOString=function(){var e=function(e,t){for(var o=(e=e.toString()).length;o<t;o++)e="0"+e;return e},t=this;return"{0}-{1}-{2}T{3}:{4}:{5}.{6}Z".format(t.getUTCFullYear(),e(t.getUTCMonth()+1,2),e(t.getUTCDate(),2),e(t.getUTCHours(),2),e(t.getUTCMinutes(),2),e(t.getUTCSeconds(),2),e(t.getUTCMilliseconds(),3))});var s=function(e,o,i,t){if(r.isPlainObject(e))for(var a in e)(!0===t||void 0!==e[a]&&null!==e[a])&&s(e[a],o,0<i.length?i+"."+a:a,t);else{if(r.isArray(e))return void r.each(e,function(e,t){s(t,o,"{0}[{1}]".format(i,e))});if(!r.isFunction(e))if(e instanceof Date)o.push({name:i,value:e.toISOString()});else{var n=typeof e;switch(n){case"boolean":case"number":n=e;break;case"object":if(!0!==t)return;default:n=e||""}o.push({name:i,value:n})}}};r.extend({toDictionary:function(e,t,o){e=r.isFunction(e)?e.call():e,2===arguments.length&&"boolean"==typeof t&&(o=t,t="");var i=[];return s(e,i,t||"",o="boolean"==typeof o&&o),i}})}(e)}),define("DynamicPackage",["jquery","../Common/autocomplete","../Common/calendar","minors","../Common/getDataValue","validation"],function(R,q,H,Y,L,V){return function(e){var s,i,d,l,m="MultipleDestinations",h=R.extend({},{departureAutocomplete:{autocompletes:[]},arrivalAutocomplete:{autocompletes:[]},calendar:{calendars:[]},autocomplete:{autocompletes:[]},skipValidation:!1,formMapping:[],tripOptions:[],multiDestinationFlightsBase:0,multiDestinationFlights:[],multiDestinationHotels:[],maxPassengers:0,multiFlightContainer:"ap_booker_dynamic_package_multiFlightContainer",multiHotelContainer:"ap_booker_dynamic_package_multiHotelContainer",texts:{},tripOtionprefix:"ap_booker_dynamic_package",maxMultidestinationHotels:2,showInfantTexts:!1,ptwInfantTextsId:"ptw-flight-infant-text",ptwInfantContainerId:"ptw-flight-infant-text-container"},e),t=new H(h.RoundTripCalendar),f=new H(h.MultiDestinationCalendar),g=[],c=function(e,t){e.instance=new q({selector:e.selector,uri:t,createAltField:e.createAltField,isNotAsync:e.isNotAsync,mapping:function(e){return{label:e.Display,description:"("+e.HotelsCount+" "+(1<e.HotelsCount?h.texts.Hotels:h.texts.Hotel)+")",uri:e.URI,tableName:e.TableName,altValue:e.Id,display:e.Display,country:e.CountryA2}},queryName:"query",data:{compareType:"initial",isNotAsync:e.isNotAsync},errors:e.errors,onSelectCallback:function(e,t){var o={baseSelector:t,display:e.item.display,keywordId:e.item.altValue,keywordTable:e.item.tableName,uri:e.item.uri,country:e.item.country};a(o)}}),e.instance.init().done(function(e){0<e.length&&(e.data("ui-autocomplete")._renderItem=function(e,t){return R("<li>").append('<a><span class="destination">'+t.label+'</span><span class="numHotels">'+t.description+"</span></a>").appendTo(e)})})},a=function(e){R(e.baseSelector+"_keywordTable").val(e.keywordTable),R(e.baseSelector+"_uri").val(e.uri)},o=function(e){for(var t=0;t<e.autocompletes.length;t++){c(e.autocompletes[t],e.uri);var o=e.autocompletes[t].hotelIndex;if(void 0!==o){var i=v(h.multiDestinationHotels,o),a=!1;-1===i&&(i={index:o,autocompletes:[],calendars:[]},a=!0),i.autocompletes.push(e.autocompletes[t].instance),!0===a&&h.multiDestinationHotels.push(i)}}},n=function(e){for(var t=e.autocompletes,o=0;o<e.autocompletes.length;o++){t[o]=R.extend({},t[o],e.baseAutocomplete),_(t[o],e.uri);var i=t[o].flightIndex;if(null!=i){var a=v(h.multiDestinationFlights,i),n=!1;-1===a&&(a={index:i,autocompletes:[],calendars:[]},n=!0),a.autocompletes.push(t[o].instance),1==n&&h.multiDestinationFlights.push(a)}}},_=function(i,e,t){var o=!0;null!=i.isOrigin&&null!=i.isOrigin&&(o=i.isOrigin),i.instance=new q({selector:i.selector,uri:e,isNotAsync:i.isNotAsync,sliceSize:i.sliceSize,source:t,mapping:function(e){return{label:e.Name+" ("+e.Code+")",value:e.Name+" ("+e.Code+")",altValue:e.Code,country:e.Country,mappingId:e.MappingId,mappingType:e.MappingType,restrictions:e.Restrictions}},data:{query:function(){return R(i.selector).val()},verifyDestinations:!1,restrictions:function(){return g},gtOrigin:o,isNotAsync:i.isNotAsync,onlyCountry:i.onlyCountry},errors:i.errors,onSelectCallback:function(e,t){!0===i.setRestictions&&(e.item.restrictions=p(e.item.restrictions,i.restrictions));var o={baseSelector:t,country:e.item.country,mappingId:e.item.mappingId,mappingType:e.item.mappingType,altValue:e.item.altValue,bans:e.item.restrictions};r(o)}}),i.instance.init()},r=function(e){if(R(e.baseSelector+"_country").val(e.country),R(e.baseSelector+"_mappingId").val(e.mappingId),R(e.baseSelector+"_mappingType").val(e.mappingType),R(e.baseSelector+"_hidden").val(e.altValue),g=u(e.bans),null!=e.bans&&null!=e.bans&&0<e.bans.length)for(var t=0;t<h.arrivalAutocomplete.autocompletes.length;t++)if(e.baseSelector==h.departureAutocomplete.autocompletes[t].selector){R(h.arrivalAutocomplete.autocompletes[t].selector).autocomplete("destroy");(function(a){R.ajax({url:h.arrivalAutocomplete.uri+"?jsoncallback=?",dataType:"jsonp",data:{query:"",verifyDestinations:!1,gtOrigin:!1,restrictions:function(){return g}},success:function(e){for(var t=[],o=0;o<e.length;o++){var i={label:e[o].Name+" ("+e[o].Code+")",value:e[o].Name+" ("+e[o].Code+")",altValue:e[o].Code,country:e[o].Country,mappingId:e[o].MappingId,mappingType:e[o].MappingType,restrictions:e[o].Restrictions};t.push(i)}_(h.arrivalAutocomplete.autocompletes[a],h.arrivalAutocomplete.uri,t)}})})(t)}},u=function(e){var t=[];if(null!=e||null!=e&&0<e.length)for(var o=0;o<e.length;o++){var i=e[o].AirportCode;-1==R.inArray(i,t)&&t.push(i)}return t},p=function(e,t){for(var o=[],i=t.split(","),a=0;a<i.length;a++){var n=R.grep(e,function(e){return e.AirportCode===i[a]});0<n.length&&o.push(n[0])}return o},v=function(e,t){for(var o=0;o<e.length;o++)if(e[o].index===t)return e[o];return-1},y=function(e){for(var t=-1,o=0;o<e.length;o++)e[o].index>t&&(t=e[o].index);return t},k=function(e,t){R(e,t).each(function(e){R(this).find("span.ap_fn").html(e+1)})},b=function(e){for(var t=0;t<e.calendars.length;t++){var o=e.calendars[t].flightIndex;if(null!=o){var i=v(h.multiDestinationFlights,o),a=!1;-1==i&&(i={index:o,autocompletes:[],calendars:[]},a=!0),i.calendars.push(e.calendars[t]),1==a&&h.multiDestinationFlights.push(i)}}},C=function(e){for(var t=0;t<e.calendars.length;t++){var o=e.calendars[t].hotelIndex;if(void 0!==o){var i=v(h.multiDestinationHotels,o),a=!1;-1==i&&(i={index:o,autocompletes:[],calendars:[]},a=!0),i.calendars.push(e.calendars[t]),1==a&&h.multiDestinationHotels.push(i)}}},x=function(){var e=y(h.multiDestinationFlights),o=e+1,t=d.clone();t.attr("id","ap_booker_dynamic_package_multiTemplate"+o),t.find(".ap_dynamic_package_flight_remove").attr("class","ap_dynamic_package_flight_remove ap-data_flight-"+o),t.find("#ap_flight_index").attr("id","ap_flight_index"+o).val(o),t.find("input.ap_collection").each(function(){var e=R(this).attr("name")||"",t=R(this).attr("id")||"";R(this).attr("name",e.replace("{0}",o)),R(this).attr("id",t.replace("{0}",o))}),t.find(".ptw-errormsg").each(function(){var e=R(this).attr("id")||"";R(this).attr("id",e.replace("{0}",o))}),t.find("label.ap_collection").each(function(){var e=R(this).attr("for")||"";R(this).attr("for",e.replace("{0}",o))}),t.appendTo(h.templateParentSelector);var i=v(h.multiDestinationFlights,o-1),a=[],n=[],r=h.arrivalAutocomplete.autocompletes[e],s=null!=h.departureAutocompleteClone?R.extend({},R.parseJSON(h.departureAutocompleteClone),h.departureAutocomplete.baseAutocomplete,{restrictions:h.restrictions}):h.departureAutocomplete.autocompletes[e],l={selector:"#ap_origin_dynamic_package_multi_flight"+o};a.push(R.extend({},s,l)),n.push({selector:"#ap_dest_dynamic_package_multi_flight"+o,optionCodes:[m],errors:i.autocompletes[1].errors,isNotAsync:r.isNotAsync,sliceSize:r.sliceSize});var c=[];c.push({selector:"#ap_dynamic_package_flight_multi_calendar"+o,optionCodes:[m],errors:i.calendars[0].errors});for(var u={index:o,autocompletes:[],calendars:[]},p=0;p<a.length;p++)g=null==h.restrictions?[]:h.restrictions,_(a[p],h.departureAutocomplete.uri),h.departureAutocomplete.autocompletes.push(a[p]),u.autocompletes.push(a[p]);for(p=0;p<n.length;p++)_(n[p],h.arrivalAutocomplete.uri),h.arrivalAutocomplete.autocompletes.push(n[p]),u.autocompletes.push(n[p]);for(p=0;p<c.length;p++)f.addCalendar(c[p],!0),u.calendars.push(c[p]);return h.multiDestinationFlights.push(u),k(".ap_flightTitle",h.templateParentSelector),!1},w=function(){var o=y(h.multiDestinationHotels)+1,e=l.clone();e.attr("id","ap_booker_dynamic_package_multiHotelTemplate"+o),e.find(".ap_dynamic_package_hotel_remove").attr("class","ap_dynamic_package_hotel_remove ap-data_hotel-"+o),e.find("#ap_hotel_index").attr("id","ap_hotel_index"+o).val(o),e.find("input.ap_collection").each(function(){var e=R(this).attr("name")||"",t=R(this).attr("id")||"";R(this).attr("name",e.replace("{0}",o)),R(this).attr("id",t.replace("{0}",o))}),e.find(".ptw-errormsg").each(function(){var e=R(this).attr("id")||"";R(this).attr("id",e.replace("{0}",o))}),e.find("label.ap_collection").each(function(){var e=R(this).attr("for")||"";R(this).attr("for",e.replace("{0}",o))}),e.appendTo(h.hotelTemplateParentSelector);var t=v(h.multiDestinationHotels,o-1),i=[];i.push({selector:"#ap_dynamic_package_dest_hotel"+o,hotelIndex:o,errors:t.autocompletes[0].errors});var a=[];a.push({selector:"#ap_dynamic_package_dest_start"+o,hotelIndex:o,errors:t.calendars[0].errors});a.push({selector:"#ap_dynamic_package_dest_end"+o,hotelIndex:o,errors:t.calendars[0].errors});for(var n={index:o,autocompletes:[],calendars:[]},r=0;r<i.length;r++)c(i[r],h.autocomplete.uri),h.autocomplete.autocompletes.push(i[r]),n.autocompletes.push(i[r]);for(r=0;r<a.length;r++)s.addCalendar(a[r],!0),n.calendars.push(a[r]);return h.multiDestinationHotels.push(n),k(".ap_hotelTitle",h.hotelTemplateParentSelector),!1},A=function(e){var t=parseInt(L(e,"flight")),o=v(h.multiDestinationFlights,t);if(-1!=o){for(var i=0;i<o.autocompletes.length;i++)M(o.autocompletes[i]);for(i=0;i<o.calendars.length;i++)I(o.calendars[i]);for(i=0;i<h.multiDestinationFlights.length;i++)h.multiDestinationFlights[i].index==t&&h.multiDestinationFlights.splice(i,1);R("#ap_booker_dynamic_package_multiTemplate"+o.index,h.selector).fadeOut(200),R("#ap_booker_dynamic_package_multiTemplate"+o.index,h.selector).promise().done(function(){R(this).remove(),k(".ap_flightTitle",h.templateParentSelector)})}},S=function(e){var t=parseInt(L(e,"hotel"));if(-1!=v(h.multiDestinationHotels,t)){for(var o=0;o<h.multiDestinationHotels.length;o++)h.multiDestinationHotels[o].index===t&&h.multiDestinationHotels.splice(o,1);R("#ap_booker_dynamic_package_multiHotelTemplate"+t,h.selector).fadeOut(200),R("#ap_booker_dynamic_package_multiHotelTemplate"+t,h.selector).promise().done(function(){R(this).remove(),k(".ap_hotelTitle",h.hotelTemplateParentSelector)})}},D=function(e){var t=R("."+e.data.container+"> div").length;return t>=e.data.limit?(R(e.data.linkSelector).hide(),!1):(e.data.callback(),(t+=1)>=e.data.limit?R(e.data.linkSelector).hide():R(e.data.linkSelector).show(),!1)},T=function(e){return e.data.callback(this),R(e.data.linkSelector).show(),!1},M=function(e){for(var t=0;t<h.departureAutocomplete.autocompletes.length;t++)if(h.departureAutocomplete.autocompletes[t].selector==e.selector){h.departureAutocomplete.autocompletes.splice(t,1);break}for(t=0;t<h.arrivalAutocomplete.autocompletes.length;t++)if(h.arrivalAutocomplete.autocompletes[t].selector==e.selector){h.arrivalAutocomplete.autocompletes.splice(t,1);break}},I=function(e){for(var t=0;t<f.calendars.length;t++)if(f.calendars[t].selector==e.selector){f.calendars.splice(t,1);break}for(t=0;t<h.calendar.calendars.length;t++)if(h.calendar.calendars[t].selector==e.selector){h.calendar.calendars.splice(t,1);break}},P=function(e){e=e&&""!=e?e:h.tripOption[0].code,R(".dynamic_package_tripMode-"+e,h.selector).addClass("active");var t=F(e);h.currentTripOptionCode=t.code;for(var o=0;o<h.tripOptions.length;o++)h.tripOptions[o].code!=t.code&&R("#"+h.tripOtionprefix+"_"+h.tripOptions[o].destinationTypeCode).hide();R("#"+h.tripOtionprefix+"_"+t.destinationTypeCode).show(),R(h.tripOptionSelector).val(t.code)},E=function(e){var t=F(e),o="#"+h.tripOtionprefix+"_"+t.destinationTypeCode;R("."+h.tripOtionprefix+"_flightType input").removeAttr("disabled"),R("."+h.tripOtionprefix+"_flightType:not("+o+") input").attr("disabled","disabled")},F=function(e){for(var t=0;t<h.tripOptions.length;t++)if(h.tripOptions[t].code==e)return h.tripOptions[t];return null},N=function(i){for(var e=[],t=0;t<i.autocompletes.length;t++)-1!=R.inArray(h.currentTripOptionCode,i.autocompletes[t].optionCodes)&&function(o){e.push(i.autocompletes[o].instance.fill({revalidateUri:i.revalidateUri}).done(function(e){if(e&&0<e.length){var t=e[0];R(i.autocompletes[o].selector).val(t.Name+" ("+t.Code+")"),R(i.autocompletes[o].instance.getAltSelector()).val(t.Code)}}))}(t);return e},O=function(e){for(var t=[],o=0;o<e.autocompletes.length;o++)e.autocompletes[o].optionCodes=e.autocompletes[o].optionCodes||[],-1!=R.inArray(h.currentTripOptionCode,e.autocompletes[o].optionCodes)&&t.push(e.autocompletes[o].instance.validate({errorClass:"inputError"}));return t},B=function(){var e=new Array;return e=e.concat(N(h.departureAutocomplete),N(h.arrivalAutocomplete))},U=function(){var t=V(),e=[];(e=e.concat(O(h.departureAutocomplete),O(h.arrivalAutocomplete))).push(calendar.validate({errorClass:"inputError",validateEmpty:!0,optionCode:h.currentTripOptionCode})),h.currentTripOptionCode==m&&e.push(f.validate({errorClass:"inputError",validateEmpty:!0,optionCode:h.currentTripOptionCode})),e.push(i.validate({errorClass:"inputError",maxPassengers:h.maxPassengers}));var o=new R.Deferred;return t.showErrors(e,h.errorsSelector).done(function(e){h.formMappingForm&&(t.fill(h.formMapping,h.selector),0==e&&o.resolve()),o.reject()}),o.promise()},j=function(){var e=R("input[name=FlightTripMode]:checked").val();if(void 0!==e){var t=F(e);h.currentTripOptionCode===t.code&&(P(e),E(e))}R(h.selector).on("click","#ap_booker_dynamic_package_addFlight",{container:h.multiFlightContainer,limit:h.maxMultidestinationFlights,callback:x,linkSelector:".ptw-add-flight"},D),R(h.selector).on("click",".ap_dynamic_package_flight_remove",{container:h.multiFlightContainer,callback:A,linkSelector:".ptw-add-flight"},T),R(h.selector).on("click","#ap_booker_dynamic_package_addHotel",{container:h.multiHotelContainer,limit:h.maxMultidestinationHotels,departureCalendar:s,arrivalCalendar:void 0,linkSelector:".ptw-add-hotel",callback:w},D),R(h.selector).on("click",".ap_dynamic_package_hotel_remove",{container:h.multiHotelContainer,callback:S,linkSelector:".ptw-add-hotel"},T),R(h.selector).on("click",h.tripOptionsSelector,function(e){var t=L(this,"dynamic_package_tripMode");P(t),E(t)}),R(h.formMappingForm).attr("action",h.submitUri)};return{code:h.code,isActive:h.isActive,init:function(){h.selector="#"+h.prefix+"_"+h.code,h.showInfantsText&&R("#ap_booker_DynamicPackage ."+h.ptwInfantTextsId).on("click",function(){R("#ap_booker_DynamicPackage ."+h.ptwInfantContainerId).toggle()}),(i=new Y({roomsSelector:"#ap_booker_DynamicPackage_rooms",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_DynamicPackageroom",minorsAgesSelector:".ap_booker_DynamicPackage_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_DynamicPackage_container",minorsAgesTemplateBaseId:"ap_booker_DynamicPackage_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_DynamicPackage_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_DynamicPackage_container",minorsAgesContainerContainerSelector:".ap_booker_DynamicPackage_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_DynamicPackage_adults",totalMinorsAgesSelector:"#ap_booker_DynamicPackage_totalMinorsAges",totalMinorsSelector:"#ap_booker_DynamicPackage_totalMinors",totalAdultsSelector:"#ap_booker_DynamicPackage_totalAdults",calculateTotals:!0,bookerSelector:h.selector,errors:{emptyMinorAge:h.texts.MinorsAgesError},manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_DynamicPackageroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_DynamicPackage_adults").attr("id","ap_booker_DynamicPackage_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_DynamicPackage_minors").attr("id","ap_booker_DynamicPackage_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_DynamicPackage_minorsAges").attr("id","ap_booker_DynamicPackage_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_DynamicPackage_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_HotelRooms_"+o+"__MinorsAges_"+i+"__Years"),e.appendTo(t)},minorsAgesContainerTemplateSelector:"#ap_minorsAges_DynamicPackage_containerTemplate"})).init(),l=R(h.hotelTemplateSelector).clone(),(s=new H(h.departureHotelCalendar)).init(),C(s),o(h.autocomplete),d=R(h.templateSelector).clone(),h.currentTripOptionCode=R(h.tripOptionSelector,h.selector).val(),t.init(),f.init(),b(f),h.departureAutocomplete.autocompletes=R.parseJSON(h.departureAutocomplete.autocompletes),h.arrivalAutocomplete.autocompletes=R.parseJSON(h.arrivalAutocomplete.autocompletes),n(h.departureAutocomplete),n(h.arrivalAutocomplete),j()},fillAndValidate:function(){var e=B();return R.when.apply(R,e).pipe(function(){return 0==h.skipValidation?U():{}})},fill:B,validate:U}}}),define("CruiseFlightBooker",["jquery","../Common/autocomplete","../Common/monthCalendar","minors","../Common/popover"],function(p,i,d,m,h){return function(e){var a,n=p.extend({},{departureAutocomplete:{autocompletes:[]}},e),o=[],r=function(e,t){e.instance=new i({selector:e.selector,uri:t,isNotAsync:e.isNotAsync,mapping:function(e){return{label:e.Name+" ("+e.Code+")",value:e.Name+" ("+e.Code+")",description:e.Description,altValue:e.Code,restrictions:e.Restrictions}},queryName:"query",data:{verifyDestinations:!1,gtOrigin:!0,isNotAsync:e.isNotAsync},errors:e.errors,onClear:function(){if(0<o.length)for(var e=0;e<n.destinationAutocomplete.autocompletes.length;e++)p(n.destinationAutocomplete.autocompletes[e].selector).val(""),p(n.destinationAutocomplete.autocompletes[e].selector).autocomplete("destroy"),p(n.destinationAutocomplete.autocompletes[e].selector).unbind("keyup")},sliceSize:e.sliceSize}),e.instance.init()},s=function(e,t){p.each(t.months,function(){this.removeAuxiliarMonth(e.selectedDate)})},l=function(t,o,e,i){var a,n;p.each(e.months,function(){if(this.setUiYear(o.months[0].getSelectedYear()),this.getSelectedIsSet()&&i(t.selectedTime,this.getSelectedTime())){for(var e=0;e<o.months.length;++e){o.months[e].removeAuxiliarMonth(this.getSelectedDate())}this.reset()}}),a=e,n=t.selectedDate,p.each(a.months,function(){this.addAuxiliarMonth(n),this.resetUi()})},t=function(e){var t=p(".item-accordion").parent().find(e.data.linkSelector);t.is(":visible")?t.css("display","none"):t.css("display","block")},c=function(){p(n.selector).on("click",".extendTrip-CruiseFlight",{linkSelector:".content-accordion"},t)},u=function(e){void 0!==a&&a.setOccupaton(e)};return{code:n.code,isActive:n.isActive,init:function(){var t;n.selector="#"+n.prefix+"_"+n.code;var o=new d({todayYear:n.todayYear,todayMonth:n.todayMonth,monthNames:n.monthNames,resetText:n.monthResetText,contextSelector:p(".ap_monthCalendarStart",n.selector),onSelecting:function(e){t&&s(e,t)},onSelect:function(e){t&&l(e,o,t,function(e,t){return t<e})}});if(t=new d({todayYear:n.todayYear,todayMonth:n.todayMonth,monthNames:n.monthNames,resetText:n.monthResetText,contextSelector:p(".ap_monthCalendarEnd",n.selector),onSelecting:function(e){t&&s(e,o)},onSelect:function(e){t&&l(e,t,o,function(e,t){return e<t})}}),n.usePopover){var e=n.servicePrefix;(a=new h({ptwTravelersLinkId:e+"ptw-travelers-link",ptwPopoverCloseId:e+"ptw-popover-close",ptwPopoverId:e+"ptw-fp-popover",attr:"data-id",ptwPopoverRoomsId:e+"ptw-num-rooms",ptwPopoverNumPaxId:e+"ptw-num-pax",ptwPopoverPaxTextId:e+"ptw-pax-text",ptwPopoverRoomTextId:e+"ptw-room-text",personText:n.popoverText.person,peopleText:n.popoverText.people,roomText:n.popoverText.room,roomsText:n.popoverText.rooms})).init()}new m({roomsSelector:"#ap_booker_CruiseFlight_cabins",roomsTemplateSelector:".ap_roomOccupancy_template",roomsContainerSelector:".ap_roomOccupancy_container",roomsTemplateBaseId:"ap_booker_CruiseFlightroom",minorsAgesSelector:".ap_booker_CruiseFlight_minors",minorsAgesTemplateSelector:".ap_minorAge_template",minorsAgesContainerBaseSelector:"#ap_minorsAges_CruiseFlight_container",minorsAgesTemplateBaseId:"ap_booker_CruiseFlight_minorAge",minorsAgesAltValueBaseSelector:"#ap_booker_CruiseFlight_minorsAges",minorsAgesContainerBaseId:"ap_minorsAges_CruiseFlight_container",minorsAgesContainerContainerSelector:".ap_booker_CruiseFlight_minorsAgesContainer",adultsTemplateBaseId:"ap_booker_CruiseFlight_adults",yearSelector:".ap_CruiseFlight_year",monthSelector:".ap_CruiseFlight_month",bookerSelector:n.selector,showMonths:!0,manageRoomsClone:function(e,t,o){e.find(".ap_index").html(o+1),e.attr("id","ap_booker_CruiseFlightroom"+o).removeClass("ap_roomOccupancy_template"),e.find("#ap_booker_CruiseFlight_adults").attr("id","ap_booker_CruiseFlight_adults"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_CruiseFlight_minors").attr("id","ap_booker_CruiseFlight_minors"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.find("#ap_booker_CruiseFlight_minorsAges").attr("id","ap_booker_CruiseFlight_minorsAges"+o).removeClass("ap-data_room-").addClass("ap-data_room-"+o),e.appendTo(t)},manageMinorsAgesClone:function(e,t,o,i){e.find(".ap_index").html(i+1),e.attr("id","ap_booker_CruiseFlight_minorAge"+i+o).removeClass("ap_minorAge_template").removeClass("ap-data_room-").addClass("ap-data_room-"+i),e.find(".Err_MinorsAge").attr("id","Err_CruiseUserSelections_Cabins_"+o+"__MinorsAges_"+i+"__Years"),e.find(".Err_MinorsAgeMonths").attr("id","Err_CruiseUserSelections_Cabins_"+o+"__MinorsAges_"+i+"__Months"),e.appendTo(t)},onMonthSelect:function(e,t){0<=t?t<n.minMonthValue?(p(e).parent().siblings(n.minAgeErrorSelector).show(),p(e).parent().siblings(n.minAgeWarningSelector).hide()):(p(e).parent().siblings(n.minAgeWarningSelector).show(),p(e).parent().siblings(n.minAgeErrorSelector).hide()):(p(e).parent().siblings(n.minAgeErrorSelector).hide(),p(e).parent().siblings(n.minAgeWarningSelector).hide())},onYearSelect:function(e,t){0<t&&(p(e).siblings(n.minAgeWarningSelector).hide(),p(e).siblings(n.minAgeErrorSelector).hide())},minorsAgesContainerTemplateSelector:"#ap_minorsAges_CruiseFlight_containerTemplate",onUpdatePopover:!0===n.usePopover?u:void 0}).init();for(var i=0;i<n.originAutocomplete.autocompletes.length;i++)r(n.originAutocomplete.autocompletes[i],n.originAutocomplete.uri);p(n.formMappingForm).attr("action",n.submitUri),p(".ap_booker_submit",n.selector).prop("disabled",!1),c()},fillAndValidate:function(){if(0==n.skipValidation)return validate();var e=new p.Deferred;return e.resolve(),e.promise()},toggleVisible:0!=n.usePopover?function(){if(null!=a)return a.toggleVisible}:void 0}}}),define("dataLayerEvents",[],function(){return function(){var t;return{init:function(){t=window.dataLayer||[]},buildEventLabel:function(){if(0<arguments.length){var e="";for(var t in arguments)null!=arguments[t]&&(e+=arguments[t]+(t<arguments.length-1?" | ":""));return e}return""},createEvent:function(e,t,o,i){return{event:e,event_action:t,event_category:o,event_label:i}},pushEvent:function(e){t.push(e)}}}}),define("generalInfo",[],function(){return{getGeneralInfo:function(){return(window.appConfiguration||{}).generalConfig||{affiliateSiteId:0,channelId:0,agencyId:0,AgentId:0}}}}),define("widgetDataLayerEvents",["dataLayerEvents","generalInfo"],function(e,t){return function(){var c=new e;c.init();return{packageEvents:function(e){for(var t=0,o=0,i=0;i<e.Rooms;i++)t+=e["room"+i+".Adults"],o+=e["room"+i+".Kids"];var a=e.hdnAirportTo?e.hdnAirportTo:"No Airport";if(0<e.idHotel)var n=document.querySelector('[value="'+e.idHotel+'"]'),r=n&&""!=n.innerText?n.innerText:"No Hotel";else r="No Hotel";var s=c.buildEventLabel(e.hdnAirportFrom,a,r,e.CheckIn,e.CheckOut,e.Rooms,t,o),l=c.createEvent("Hotel+Flight Search","Search","Package",s);c.pushEvent(l)},hotelEvents:function(e){for(var t=0,o=0,i=0;i<e.Rooms;i++)t+=e["room"+i+".Adults"],o+=e["room"+i+".Kids"];var a=c.buildEventLabel(e.placeTypeName,e.pDisplay,e.CheckIn,e.CheckOut,e.Rooms,t,o),n=c.createEvent("Hotel Search","Search","Hotel",a);c.pushEvent(n)}}}}),define("widgetMain",["jquery","hotelBooker","packageBooker","flightBooker","busPackageBooker","busBooker","carBooker","transferBooker","tourBooker","cruiseBooker","circuitBooker","../Common/getDataValue","../Common/toDictionary","DynamicPackage","CruiseFlightBooker","widgetDataLayerEvents"],function(k,u,p,d,m,h,f,g,b,C,x,w,e,A,S,D){return function(){var _={Prefix:"ap_booker",Sections:[],Engines:[],Container:"",FocusOnChange:!1,IsNotFirstFocus:!1,CurrentEngineCode:"",CurrentSectionCode:"",CustomTarget:void 0};var s=function(e,t){switch(e.Code){case"Hotel":e.engine=u(t);break;case"FlightPackage":e.engine=p(t);break;case"Flight":e.engine=d(t);break;case"BusPackage":e.engine=m(t);break;case"Transfer":e.engine=g(t);break;case"Tour":e.engine=b(t);break;case"Car":e.engine=f(t);break;case"Bus":e.engine=h(t);break;case"Cruise":e.engine=C(t);break;case"Circuit":e.engine=x(t);break;case"DynamicPackage":e.engine=A(t);break;case"CruiseFlight":e.engine=S(t)}e.engine.init(),e.IsActive=!0,e.IsLoading=!1,c(e.Code),"function"==typeof window.ptw_external_onEngineLoad&&window.ptw_external_onEngineLoad(e.Code),k(".ui-datepicker").each(function(){var e=k(this).attr("id");0==k("#"+e).parent(".pt-customJqueryUi").length&&(0==k(".pt-customJqueryUi").length?k("#"+e).wrap("<div class='pt-customJqueryUi' />"):k(".pt-customJqueryUi").append(k("#"+e)))})},t=function(){k("."+_.Prefix+"_tab").click(function(e){e.preventDefault(),k("li","#ap_ptw_hiddenTabs").removeClass("ptw-active"),k("li",".ap_ptw_tabs").removeClass("ptw-active"),k(this).closest("li").addClass("ptw-active");var t=w(this,"section");n(t),_.ShowTitleTabs&&1==_.ShowTitleTabs&&(k(".titleTabHidden").hide(),k(".titleTab"+t).show())}),k("."+_.Prefix+"_variant").click(function(e){var t=w(this,"engine");r(t)}),k("#"+_.Container).on("click","."+_.Prefix+"_submenu input",function(){k(this).closest("li").siblings().removeClass("ptw-active"),k(this).closest("li").addClass("ptw-active")}),k("body").on("submit","."+_.Prefix+"_form",function(e){e.preventDefault(),k("input[type=submit]").attr("disabled","disabled"),k(".img-submit").show(),k(".ptw-errormsg").html(""),i(this)})},o=function(){var e=document.createElement("center"),t=document.createElement("div");t.setAttribute("id","splash"),t.setAttribute("class","defaultSplash"),t.setAttribute("style","display:none;");var o=document.createElement("img");o.setAttribute("src",_.SplashImage);var i=document.createElement("h1");i.innerHTML=_.SplashText;var a=document.createElement("div");a.setAttribute("class","spinner"),t.appendChild(o),t.appendChild(a),t.appendChild(i),e.appendChild(t),document.body.appendChild(e)},v=function(e){e.show();var t=k(e).parent().clone();document.body.innerHTML="",t.appendTo(document.body)},i=function(d,m){var h,e=w(d,"engine"),t=l(e),f=a();if(null!=t){var g=t.engine;g.fillAndValidate&&(h=g.code,g.fillAndValidate().done(function(){if("Tour"==h){var e=k('input[name="Searchbox.PostUrl"]',".ap-data_engine-"+h).val().replace("}/","}").replace("}","}/");k('input[name="Searchbox.PostUrl"]',".ap-data_engine-"+h).val(e)}k.ajax({url:k(d).attr("action")+"?jsoncallback=?",data:k(d).serialize(),dataType:"jsonp"}).done(function(e){if(0==e.Errors.length){!function(){try{var e=k("#splash");0===e.length||e.hasClass("defaultSplash")?0!==e.length&&v(e):"undefined"!=typeof showSplash&&jQuery.isFunction(showSplash)?showSplash():(k("#splash").show(),k(".homeContent").hide())}catch(e){k("#splash").hide(),k(".homeContent").show()}}(),f.isValid&&(e.Url+="?campaignToken="+f.token);var t,o=!1,i=new D;switch(h){case"FlightPackage":i.packageEvents(e.FormData);break;case"Hotel":i.hotelEvents(e.FormData)}if(0==e.Method){for(var a in(t=document.createElement("form")).action=k.trim(e.Url),t.method="GET",e.FormData)(l=document.createElement("input")).setAttribute("type","hidden"),l.setAttribute("name",a),l.setAttribute("value",e.FormData[a]),t.appendChild(l);if(e.IsCc){var n=document.location.href;try{for(var r=n.split("?")[1].split("&"),s=0;s<r.length;s++)(l=document.createElement("input")).setAttribute("type","hidden"),l.setAttribute("name",r[s].split("=")[0]),l.setAttribute("value",r[s].split("=")[1]),t.appendChild(l)}catch(e){}}o=!0}else if(1==e.Method){for(var a in(t=document.createElement("form")).action=k.trim(e.Url),t.method="POST",e.FormData){var l;(l=document.createElement("input")).setAttribute("type","hidden"),l.setAttribute("name",a),l.setAttribute("value",e.FormData[a]),t.appendChild(l)}o=!0}if(window.ptw_external_onSubmitForm){var c=null;if("function"==typeof window.ptw_external_onSubmitForm?c=window.ptw_external_onSubmitForm:window.ptw_external_onSubmitForm instanceof Array&&(1<window.ptw_external_onSubmitForm.length?(m=parseInt(m,10)||0,c=y(m)):c=window.ptw_external_onSubmitForm[0]),"function"==typeof c){e.Engine=h;var u=c(e,t,d);o=null==u||u}}1==o&&void 0!==t&&(document.body.appendChild(t),void 0!==_.CustomTarget&&""!==_.CustomTarget&&t.setAttribute("target",_.CustomTarget),t.submit())}else k("input[type=submit]").removeAttr("disabled"),k(".img-submit").hide();var p=null!=g.toggleVisible?g.toggleVisible():void 0;k.each(e.Errors,function(e,t){null!=t&&(-1==t.AttemptedValue&&null!=p&&p(),k("#Err_"+t.PropertyName.replace(/\./g,"_").replace(/\[/g,"_").replace(/\]/g,"_"),"#"+_.Prefix+"_"+h).html(t.ErrorMessage),console.log("#Err_"+t.PropertyName.replace(/\./g,"_").replace(/\[/g,"_").replace(/\]/g,"_"),"#"+_.Prefix+"_"+h))})})}))}},a=function(){var e=sessionStorage.getItem("campaignToken");return{token:e,isValid:null!==e&&"null"!==e}},l=function(e){for(var t=_.Engines.length-1;0<=t;t--)if(_.Engines[t]&&_.Engines[t].Code==e)return _.Engines[t]},n=function(e,t){var o=new k.Deferred,i=function(e){for(var t=0;t<_.Sections.length;t++)if(_.Sections[t].Code==e)return _.Sections[t];return null}(e);if(null!=i){var a=w("#"+_.Prefix+"_variant_"+e+' input[type="radio"]:checked',"engine");a=null!=a&&""!=a?a:i.DefaultEngineCode,1!=t&&(k("."+_.Prefix+"_engine").hide(),k("."+_.Prefix+"_variantGroup").hide(),k("#"+_.Prefix+"_variant_"+e).show()),k.when(r(a,t)).done(function(){o.resolve()}),_.CurrentSectionCode=e}else o.reject();return o.promise()},r=function(e,t){var o,i,a,n=new k.Deferred,r=l(e);return null!=r?(1!=t&&(k("."+_.Prefix+"_engine").hide(),_.CurrentEngineCode=r.Code),1!=r.IsLoading&&(r.IsLoading=!0,0==k("#"+_.Prefix+"_"+r.Code).length&&k("<div/>",{id:_.Prefix+"_"+r.Code,class:_.Prefix+"_engine",style:"display:none"}).appendTo("#ptw-engines"),0==r.IsActive?k.when((o=r,i=t,a=new k.Deferred,1==o.IsLoaded&&o.Options&&null!=o.Options?(s(o,o.Options),a.resolve(),a.promise()):k.ajax({url:o.Url+"?jsoncallback=?",data:k.toDictionary(o.Data),dataType:"jsonp"}).done(function(e){k("#"+_.Prefix+"_"+o.Code).html(e.html),1==i&&_.CurrentEngineCode!=o.Code?(o.IsLoaded=!0,o.Options=e.options,o.IsLoading=!1):s(o,e.options)}))).done(function(){k("input[type=submit]","#ap_booker_"+r.Code).removeAttr("disabled"),n.resolve()}):(1!=t&&c(r.Code),r.IsLoading=!1,n.resolve()),k("input[type=submit]","#ap_booker_"+r.Code).removeAttr("disabled"))):n.reject(),n.promise()},c=function(e){if(_.CurrentEngineCode==e)if(k("."+_.Prefix+"_engine").hide(),k("#"+_.Prefix+"_"+e).show(),1==_.FocusOnChange&&_.IsNotFirstFocus&&"Transfer"!=e){var t=k("#ap_booker_"+e).find('input[type="text"]').first(),o=t.val();t.focus().val("").val(o)}else _.IsNotFirstFocus||(_.IsNotFirstFocus=!0)},y=function(e){for(var t=0;t<window.ptw_external_onSubmitForm.length;t++)if(window.ptw_external_onSubmitForm[t].index==e)return window.ptw_external_onSubmitForm[t].callback;return null};return window.ptw_external_widgetMain_submitFunction=i,window.ptw_external_widgetMain_addOnSubmitCallback=function(e){var t=-1;if("function"==typeof window.ptw_external_onSubmitForm){var o=window.ptw_external_onSubmitForm;window.ptw_external_onSubmitForm=[],t=0,window.ptw_external_onSubmitForm.push({index:t,callback:o})}return window.ptw_external_onSubmitForm instanceof Array&&(t=window.ptw_external_onSubmitForm.length,window.ptw_external_onSubmitForm.push({index:t,callback:e})),t},window.ptw_external_widgetMain_removeOnSubmitCallback=function(e){if(e<0)return!1;if("function"==typeof window.ptw_external_onSubmitForm&&0==e)window.ptw_external_onSubmitForm=null;else if(window.ptw_external_onSubmitForm instanceof Array){for(var t=window.ptw_external_onSubmitForm.length,o=0;o<t;o++)window.ptw_external_onSubmitForm[o].index!=e&&window.ptw_external_onSubmitForm.push(window.ptw_external_onSubmitForm[o]);window.ptw_external_onSubmitForm.splice(0,t)}return!0},{init:function(e){k.extend(_,e),o(),t(),n(_.CurrentSectionCode,_.Silent)},initOptionsOnly:function(e){k.extend(_,e),t()},switchEngine:r,showCompleteSection:n}}}),define("noconflict",["jquery"],function(e){return e.noConflict(!0)});
//# sourceMappingURL=booker-2.1-min.js.map